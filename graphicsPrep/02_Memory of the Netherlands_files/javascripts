var bkt={};var stacktrace=console.trace;bkt.events={beforeMultiActionApiRequest:new signals.Signal(),beforeMultiActionCallbacks:new signals.Signal(),afterMultiActionCallback:new signals.Signal(),afterMultiActionCallbacks:new signals.Signal(),afterAdvancedsearchAction:new signals.Signal()};bkt.deparam=function(u){if(u.match(/\?/)){u=u.replace(/.*\?/,"");}
var p=$.deparam(u);for(var k in p){if(k.match(/^\//)){delete p[k];}}
function stripTags(p){for(var k in p){if(typeof p[k]==='string'){p[k]=p[k].replace(/(<([^>]+)>)/ig,"");}else{p[k]=stripTags(p[k]);}}
return p;}
return stripTags(p);};bkt.parseParams=function(u){var url=u||location.href;var raw="";var p={};if(url.match(/\?/)){raw=url.replace(/.*\?/,"").replace(/#.*/,"");}
p=bkt.deparam(raw);return p;};bkt.isTouchDevice=function(){return'ontouchstart'in window||(navigator.maxTouchPoints>0);};bkt.getLanguage=function(){if(location.href.match(/^http:\/\/[^\/]+\/([a-z]{2})\/?.*$/)){return location.href.replace(/^http:\/\/[^\/]+\/([a-z]{2})\/?.*$/,'$1');}else{return"nl";}};bkt.getSkin=function(){return location.href.replace(/^.+\/[a-z]{2}\/([^\/\?]+).*$/,'$1');};bkt.getCollForSkin=function(skin){switch(skin){case"kranten":return"ddd";case"tijdschriften":return"dts";case"boeken":return"boeken";case"boeken1":return"boeken1";case"radiobulletins":return"anp";case"regio":return"regio";}
return"platform";};bkt.getController=function(){return location.href.replace(/^.+\/[a-z]{2}\/[^\/]+\/([^\/\?]+).*$/,'$1');};bkt.getAction=function(){return location.href.replace(/^.+\/[a-z]{2}\/[^\/]+\/[^\/]+\/([^\/\?]+).*$/,'$1');};bkt.deleteSetting=function(name){delete(localStorage[name]);};bkt.loadSetting=function(name){return JSON.parse(localStorage[name]||"{}");};bkt.storeSetting=function(name,value){try{localStorage[name]=JSON.stringify(value);}catch(e){console.log("in case we could log read this out in safari on an ipad this we would");}};bkt.storable={};bkt.storable.store=function(coll,data,ns){if(coll==='dddtitel'){coll='ddd';}
var list=bkt.loadSetting(ns);list[coll]=data;bkt.storeSetting(ns,list);};bkt.storable.fetch=function(coll,ns){if(coll==='dddtitel'){coll='ddd';}
var list=bkt.loadSetting(ns);if(list[coll]){return list[coll];}
return{};};bkt.storable.isStored=function(coll,identifier,ns){if(coll==='dddtitel'){coll='ddd';}
var list=bkt.storable.fetch(coll,ns);for(var id in list){if(id===identifier){return true;}}
return false;};bkt.storable.count=function(coll,ns){if(coll==='dddtitel'){coll='ddd';}
var list=bkt.storable.fetch(coll,ns);var count=0;for(var x in list){count++;}
return count;};bkt.storable.add=function(coll,id,metadata,ns,dateAdded){if(coll==='dddtitel'){coll='ddd';}
var list=bkt.storable.fetch(coll,ns);list[id]=metadata;list[id].dateAdded=dateAdded||new Date().getTime();bkt.storable.store(coll,list,ns);return bkt.storable.count(coll,ns);};bkt.storable.remove=function(coll,id,ns){if(coll==='dddtitel'){coll='ddd';}
var list=bkt.storable.fetch(coll,ns);delete(list[id]);bkt.storable.store(coll,list,ns);return bkt.storable.count(coll,ns);};bkt.storable.popStored=function(coll,ns){if(coll==='dddtitel'){coll='ddd';}
var list=bkt.storable.fetch(coll,ns);var smallest=new Date().getTime();var id=false;for(var k in list){if(list[k].dateAdded<smallest){smallest=list[k].dateAdded;id=k;}}
if(id){delete(list[id]);}
bkt.storable.store(coll,list,ns);return bkt.storable.count(coll,ns);};bkt.favourites={};bkt.favourites.fetch=function(coll){return bkt.storable.fetch(coll,"favourites");};bkt.favourites.isFavourite=function(coll,identifier){return bkt.storable.isStored(coll,identifier,"favourites");};bkt.favourites.count=function(coll){return bkt.storable.count(coll,"favourites");};bkt.favourites.countAll=function(){var count=0;var colls=["boeken","boeken1","ddd","anp","dts","regio","ngvn"];for(var i in colls){count+=bkt.favourites.count(colls[i]);}
return count;};bkt.favourites.add=function(coll,id,metadata,options){var opts=options||{};var count=bkt.storable.add(coll,id,metadata,"favourites",opts.dateAdded||false);if(!opts.suppressNotice){bkt.favourites.showNotice(coll,metadata);}
return count;};bkt.favourites.remove=function(coll,id){return bkt.storable.remove(coll,id,"favourites");};bkt.favourites.overNotice=false;bkt.favourites.noticeDelay=5;bkt.favourites.monitoringNotice=false;bkt.favourites.closeNotice=function(){$(".storables-notice").fadeOut({complete:function(){$(".layout-top-block .options .storables-context-menu-link").parent("span").removeClass("opened");}});};bkt.favourites.monitorNotice=function(){bkt.favourites.monitoringNotice=true;if(!bkt.favourites.overNotice){bkt.favourites.noticeDelay--;}
if(bkt.favourites.noticeDelay<=0){bkt.favourites.closeNotice();bkt.favourites.monitoringNotice=false;}else{setTimeout(function(){bkt.favourites.monitorNotice(bkt.favourites.noticeDelay);},1000);}};bkt.getMenuIconRight=function(icon){var borderComp=2;return $(window).width()-(icon.offset().left+icon.width()+
parseInt(icon.css("padding-left"))+
parseInt(icon.css("padding-right"))+borderComp);};bkt.favourites.showNotice=function(coll,metadata){var title=metadata.title||metadata.alternative||bkt.i18n.lookup("nullfield",{controller:"storable",coll:coll==='dddtitel'?'ddd':coll});$(".storables-notice .title").html(title);$(".storables-notice span.text").html(bkt.i18n.lookup("added_to_favourites"));$(".storables-notice .link").html(bkt.i18n.lookup("show_your_favourites")+" ("+bkt.favourites.countAll()+")");$(".storables-notice").removeClass("with-close-link").fadeIn().off("mouseover").off("mouseout").on("mouseover",function(){$(this).addClass("with-close-link");bkt.favourites.overNotice=true;}).on("mouseout",function(){bkt.favourites.overNotice=false;});$(".menu-icon.opened").removeClass("opened");$(".context-menu").hide();$(".layout-top-block .options .storables-context-menu-link").parent("span").addClass("opened");bkt.favourites.noticeDelay=5;if(!bkt.favourites.monitoringNotice){bkt.favourites.monitorNotice();}};bkt.visited={};bkt.visited.fetch=function(coll){return bkt.storable.fetch(coll,"visited");};bkt.visited.isFavourite=function(coll,identifier){return bkt.storable.isStored(coll,identifier,"visited");};bkt.visited.count=function(coll){return bkt.storable.count(coll,"visited");};bkt.visited.add=function(coll,id,metadata){if(bkt.visited.count(coll,id)>999){bkt.storable.popStored(coll,"visited");}
return bkt.storable.add(coll,id,metadata,"visited");};bkt.visited.remove=function(coll,id){return bkt.storable.remove(coll,id,"visited");};bkt.string={};bkt.string.replaceAll=function(find,repl,str){function escapeRegex(s){return s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");}
return str.replace(new RegExp(escapeRegex(find),'g'),repl);};bkt.string.pad=function(num,size){var s=num+"";while(s.length<size)
s="0"+s;return s;};bkt.ResultCache=function(options){var opts=options||{};var _max=opts.cacheMax||1024*5;var _expire=opts.expire||5*60*1000;var _data=JSON.parse(localStorage.cachedResults||"[]");this.getSize=function(){if(typeof localStorage.cachedResults==='undefined'){return _max+1;}
return Math.ceil((JSON.stringify(localStorage.cachedResults).length*2)/ 1024);};this.getExpireTime=function(unit){return _expire /(unit||1);};this.lookup=function(key){for(var i in _data){if(_data[i].key===key){_data[i].time=new Date().getTime();return _data[i];}}
return false;};this.save=function(key,value){if(!key||this.lookup(key)||this.getSize()>=_max){return;}
var record={key:key,value:value,time:new Date().getTime()};_data.push(record);try{localStorage.cachedResults=JSON.stringify(_data);}catch(domException){console.log("Exceeded localStorage quota of browser");}};this.getList=function(){return _data;};for(var i in _data){if(_data[i].time<new Date().getTime()-_expire){_data.splice(i,1);}}
try{localStorage.cachedResults=JSON.stringify(_data);}catch(e){console.log("Exceeded localStorage quota of browser");}};bkt.fetch=function(url,opts){if(opts.data){url+="?"+$.param(opts.data);delete(opts.data);}
var cached=new bkt.ResultCache().lookup(url);var multiCached=false;if(!cached&&url.match(/\/multi\?/)){var p=bkt.parseParams(url);var actions=p.actions;var newParams=bkt.deparam(url.replace(/.*\?/,""));var settings=bkt.loadSetting('settings');if(newParams.pres===undefined){if(settings.presentationLevel!==undefined){newParams.pres={};newParams.pres.presentationLevel=settings.presentationLevel;}}
if(newParams.maxperpage===undefined){if(settings.resultsPerPage!==undefined){newParams.maxperpage=settings.resultsPerPage;if(newParams.coll==='boeken1'&&newParams.maxperpage>40){newParams.maxperpage=40;}}}
delete(p.actions);for(var i in actions){var path=url.replace(/\?.*$/,"").replace("/multi","/"+actions[i]);var key=path+"?"+$.param(p);var data=new bkt.ResultCache().lookup(key);if(data&&data.value){if(!multiCached){multiCached={value:{}};}
newParams.actions.splice(newParams.actions.indexOf(actions[i]),1);multiCached.value[actions[i]+"Action"]=data.value;}}
opts.success(multiCached.value);if(newParams.actions.length===0){return;}
url=url.replace(/\?.*/,"?")+$.param(newParams);}
function multiSave(data){for(var x in data){var p=bkt.parseParams(url);var action=x.replace(/Action$/,"");var path=url.replace(/\?.*$/,"").replace("/multi","/"+action);delete(p.actions);var key=path+"?"+$.param(p);new bkt.ResultCache().save(key,data[x]);}}
if(cached&&opts.success){opts.success(cached.value);}else if(opts.success){var callback=opts.success;var errback=opts.error||function(){};delete(opts.success);$.ajax(url,$.extend(opts,{success:function(data){if(url.match(/\/multi\?/)){multiSave(data);}else{new bkt.ResultCache().save(url,data);}
callback(data);},error:function(data){errback(data);}}));}};bkt.ImageQueue=function(options){var opts=options||{};var concurrency=opts.maxConcurrency||1;var imageQueue=[];var loadingImage=[];var currentQueue=0;var preloadedImages={};for(var i=0;i<concurrency;i++){imageQueue[i]=[];loadingImage[i]=false;}
this.queueImage=function(tag,src,opts){if(preloadedImages[src]){tag.attr("src",src);if(opts.callback){opts.callback(tag);}
return;}
imageQueue[currentQueue].push({tag:tag,src:src,opts:opts});if(!loadingImage[currentQueue]){dequeueImage(currentQueue);}
if(++currentQueue>=concurrency){currentQueue=0;}};function dequeueImage(queueIndex){var current=imageQueue[queueIndex].shift();if(!current){loadingImage[queueIndex]=false;return;}
loadingImage[queueIndex]=true;current.tag.attr("src",current.src);if(current.opts&&current.opts.fade){current.tag.hide().load(function(){$(this).fadeIn('slow');});}
if(current.opts&&current.opts.callback){current.opts.callback(current.tag);}
current.tag.load(function(){onqueuedImageLoad(this,queueIndex);});}
function onqueuedImageLoad(img,queueIndex){if(img.complete){dequeueImage(queueIndex);preloadedImages[img.src]=img;}else{setTimeout(function(){onqueuedImageLoad(img,queueIndex);},25);}}};bkt.imageQueue=new bkt.ImageQueue({maxConcurrency:3});bkt.i18n={};bkt.i18n.lookup=function(key,options){var opts=options||{};var callback=opts.callback||function(){};var lang=opts.lang||bkt.getLanguage();var coll=opts.coll||"all";var controller=opts.controller||"default";var sgpl=opts.sgpl||"sg";var lookup="%i18n-"+coll+"-"+controller+"-"+key+"%";var data=i18n.table;if(data[coll]&&data[coll][controller]&&data[coll][controller][key]&&data[coll][controller][key][lang]&&data[coll][controller][key][lang][sgpl]){lookup=data[coll][controller][key][lang][sgpl];for(var k in opts){if(k.match(/^\$/)){lookup=bkt.string.replaceAll(k,opts[k],lookup);}}}
return lookup;};$.fn.getTranslation=function(key,options){var opts=options||{};var text=bkt.i18n.lookup(key,opts);if(opts.attr){this.attr(opts.attr,text);}else{this.html(text);}
return this;};bkt.showSearchHints=function(el){var opts={title:bkt.i18n.lookup("search_hints"),top:$(".query-placeholder").offset().top+$(".query-placeholder").height()+6,left:$(".query-placeholder").offset().left+4,width:$(".query-placeholder:visible").width(),useOverlay:false};bkt.dialogs.informationBox(bkt.i18n.lookup("search_hint_text",{controller:"layout",coll:bkt.getCollForSkin(bkt.getSkin())}),opts);};bkt.showRelevanceSortInfo=function(el){bkt.dialogs.informationBox(''+bkt.i18n.lookup("relevance_sort_info"),{title:bkt.i18n.lookup("relevance_sort_title"),near:el});};bkt.cssProp=function(prop,fromClass){var inspector=$("<div>").css('display','none').addClass(fromClass);$("body").append(inspector);try{return inspector.css(prop);}finally{inspector.remove();}};bkt.setHistoryState=function(urlparams,doReplace){if(typeof history.state!=="undefined"&&history.state!==null&&typeof history.state.facets!=="undefined"&&typeof history.state.sortfield==="undefined"&&typeof urlparams.sortfield!=="undefined"&&typeof urlparams.facets==="undefined")
{urlparams.facets=history.state.facets;if(typeof history.state.maxperpage!=="undefined")
{urlparams.maxperpage=history.state.maxperpage;}}
var re=/MSIE 9.0/;if(navigator.userAgent.match(re))
{return;}
var historyObject={};var filters=["query","facets","page","maxperpage","sortfield","cql","coll"];for(var i in filters){if(typeof urlparams[filters[i]]!=="undefined"){historyObject[filters[i]]=urlparams[filters[i]];}}
var currentUrl=false;if(typeof history.state!=="undefined"&&history.state!==null)
{currentUrl="http://"+location.hostname+location.pathname+"?"+$.param(history.state);}
var newUrl="http://"+location.hostname+location.pathname+"?"+$.param(historyObject);if(newUrl!==currentUrl){if(doReplace){history.replaceState(historyObject,"hist",newUrl);}else{if(history.state&&history.state.coll==="ngvn"){if(history.state.page){newUrl=newUrl.replace(/&recordoffset=\d+/,"");}}
history.pushState(historyObject,"hist",newUrl);}}};bkt.inFilterBox=false;bkt.checkForPageReload=function(prevUrlParams,currUrlParams){var filters=["facets","maxperpage","sortfield"];for(var i in filters)
{if(typeof prevUrlParams[i]!=="undefined"&&typeof currUrlParams[i]==="undefined")
{window.location.reload();}
if(typeof prevUrlParams==="object")
{for(var j in prevUrlParams)
{if(typeof currUrlParams[i]==="undefined"||typeof currUrlParams[i][j]==="undefined"||typeof prevUrlParams[i][j]==="undefined"||currUrlParams[i][j]!==prevUrlParams[i][j])
{if(!bkt.inFilterBox)
{window.location.reload();}else
{console.log("INFILTERBOX");}}}}}};bkt.onBackButton=function(urlparams){$(window).on('popstate',function(e){var target=bkt.parseParams(e.target.location.href);if(typeof target.page==="undefined")
{target.page=1;bkt.checkForPageReload(urlparams,target);}
if(e.originalEvent.state){bkt.checkForPageReload(urlparams,target);}
bkt.mvc.recordHistory=0;bkt.mvc.renderView(['paginate','facets','results','resultsCount'],{page:target.page});});};bkt.logStackTrace=function(fnCaller,oldselector){var stack;try{throw new Error('');}catch(error){stack=error.stack||'';}
stack=stack.split('\n').map(function(line){return line.trim();});var arr=stack[2].split("@");var fnName=arr[0]===""?"anonymous function":arr[0];var file=arr[1];console.info(fnCaller,fnName);console.log(file);file=file+"^^^"+oldselector;if(bkt.stackTrace.indexOf(file)===-1){bkt.stackTrace.push(file);}};bkt.showStackTrace=function(){console.log("num unique stackTraces: ",bkt.stackTrace.length);var output='';for(var i=0,l=bkt.stackTrace.length,arrParts,ruleNum,path,selector;i<l;i++){arrParts=bkt.stackTrace[i].split('^^^');selector=arrParts[1];arrParts=arrParts[0].split('/js/');arrParts=arrParts[1].split(':');ruleNum=arrParts[1];path=arrParts[0];output=output+'R '+ruleNum+'\t'+'/js/'+path+'\t\t'+selector+'\n';}
console.log(output);};bkt.stackTrace=[];function onButtonClick(id,button){if($(button).hasClass('active'))
{$(id).hide();$(button).removeClass("active");return;}
$(button).addClass('active');$(id).show();}
var imageviewerClientGlobals={boundingBox:{x:0,y:0,w:0,h:0}};var imageviewerClientInitialScaleFactor=1.0;var imageviewerClientCurrentScaleFactor=1.0;(function($){$.fn.imageViewerClient=function(serviceUrl,opts){var _self=this,popup=null,previewImage=null,canvasImage=null,spinner=null,storedWidth=0,slider=opts.slider,minimap=opts.minimap,minimapOptions=opts.minimapOptions,words=opts.params.words||null,coords=opts.params.coords||null,userCallback=opts.userCallback||null,previewScale=opts.previewScale||0.2,maxScale=opts.maxScale||4.0,minScale=opts.minScale||0.01,fullImageDims=null,sliding=false,initialZoom=opts.initialZoom||"scaleToFullWidth",canvas2DContext=_self.get(0).getContext('2d'),previewParams=$.extend({},opts.params),params=$.extend({},opts.params),storedCenter=null,_overlaysDrawn=[],$canvas=$(_self);$canvas.attr("width",_self.width());$canvas.attr("height",_self.height());canvas2DContext.width=_self.width();canvas2DContext.height=_self.height();if(opts.legacy){$.extend(previewParams,{zoom:previewScale});if(opts.params.format&&opts.params.format==="SGD"){$.extend(previewParams,{s:2.083});}}else{$.extend(previewParams,{s:previewScale});}
$.extend(params,{r:0,s:1.0,x:0,y:0,w:_self.width(),h:_self.height()});if(opts.spinner){spinner=$("<img>").attr("src",opts.spinner).addClass("spinner");_self.before(spinner);}
function normalize(orig){var p=$.extend(true,{},orig);if(opts.legacy){p.zoom=p.s;delete(p.s);if(p.x){p.x /=p.zoom;}
if(p.y){p.y /=p.zoom;}
if(p.w){p.w /=p.zoom;}
if(p.h){p.h /=p.zoom;}
if(p.format&&p.format==="SGD"){p.s=2.083;}}
if(p.x){p.x=parseInt(p.x,10);}
if(p.y){p.y=parseInt(p.y,10);}
if(p.w){p.w=parseInt(p.w,10);}
if(p.h){p.h=parseInt(p.h,10);}
return p;}
function repositionMinimap(){if(minimap){minimap.trigger("repositionViewerZone",{x:params.x / params.s,y:params.y / params.s,w:params.w / params.s,h:params.h / params.s});}}
function initMinimap(){if(minimap&&minimapOptions){var minimapScale=minimap.width()/ fullImageDims.w,p={r:params.r,s:minimapScale,id:params.id,useresolver:params.useresolver==="false"?false:true},img=serviceUrl+"?"+new Date().getTime()+"&"+$.param(normalize(p));minimap.html("");if(typeof bkt.mvc.urlparams.coll!=='undefined'&&bkt.mvc.urlparams.coll!=='ngvn')
{$.extend(minimapOptions,{image:img});minimap.minimap(minimapScale,fullImageDims.h*minimapScale,minimapOptions);setTimeout(repositionMinimap,200);}
else
{if(!minimapOptions.image){minimapOptions=$.extend(minimapOptions,{image:img});}
minimap.minimap(minimapScale,fullImageDims.h*minimapScale,minimapOptions);setTimeout(repositionMinimap,200);}}}
function onImageError(){if(spinner){spinner.hide();}
$(".progress").hide();if(opts.onImageError){opts.onImageError();return;}
var errorMessage=$("<div class='ErrorMessage'>"),tryAgain=$("<a>").attr("href",window.location.href.replace(/#.*$/,'')).html(opts.tryAgainMessage||"Opnieuw proberen");if($.browser.msie){tryAgain.click(function(){history.go(0);});}
errorMessage.html(opts.errorMessage||"Er is iets fout gegaan bij het ophalen van de afbeelding. ");errorMessage.append(tryAgain);if(_self.prop("tagName").toLowerCase()==='canvas'){$(_self.parents()[0]).prepend(errorMessage);}else{_self.append(errorMessage);}}
function onCanvasImageLoad(image){canvas2DContext.clearRect(0,0,canvas2DContext.width,canvas2DContext.height);var x=0,y=0;if(image.width<canvas2DContext.width){x+=Math.floor((canvas2DContext.width-image.width)/ 2);}
if(opts.allowYCentering){y+=Math.floor((canvas2DContext.height-image.height)/ 2);}
storedWidth=image.width;canvas2DContext.drawImage(image,x,y);$(".progress").hide();if(imageviewerClientCurrentScaleFactor===imageviewerClientInitialScaleFactor&&!$("body").hasClass("is-fullscreen")){$("button.object-view__button-icon-favourites").show();}else{$("button.object-view__button-icon-favourites").hide();}}
function onPreviewImageLoad(image,callback){if(!fullImageDims){fullImageDims={w:image.width / previewScale,h:image.height / previewScale};var trans=image.width / _self.width();if(spinner){spinner.hide();}
canvas2DContext.clearRect(0,0,canvas2DContext.width,canvas2DContext.height);if(minimap){initMinimap();}
if(slider){slider.slider("enable");}
if(callback){callback(true);}
if(userCallback){userCallback();}else{canvas2DContext.drawImage(image,0,0,_self.width(),parseInt(image.height / trans,10));}
$(image).off("load");}
recalculateMinScale();if(slider){slider.slider({min:Math.floor(minScale*100)});}}
function recalculateMinScale(){if(fullImageDims){if($("#canvas").width()>$("#canvas").height()&&params.r===0||params.r===180){minScale=opts.minScale||_self.height()/ fullImageDims.h;}else{minScale=opts.minScale||_self.width()/ fullImageDims.w / 1.17;}}}
function loadPreviewImage(callback){if(spinner){spinner.show();}
var src=serviceUrl+"?"+new Date().getTime()+"&"+$.param(previewParams);previewImage=$("<img>").error(onImageError).on("load",function(){onPreviewImageLoad(this,callback);if(!bkt.isTouchDevice()){bkt.mvc.viewer.monitorViewButtons();}}).attr("src",src);}
function loadCanvas(){if(canvasImage){canvasImage.remove();}
canvasImage=$("<img>").error(onImageError).on("load",function(){onCanvasImageLoad(this);});canvasImage[0].src=serviceUrl+"?"+
new Date().getTime()+"&"+$.param(normalize(params));if(opts.onpaint){opts.onpaint(normalize(params));}}
function setRealCanvasPosition(x,y){if(fullImageDims){params.x=x+_self.width()>(fullImageDims.w*params.s)?(fullImageDims.w*params.s)-_self.width():x;params.y=y+_self.height()>(fullImageDims.h*params.s)?(fullImageDims.h*params.s)-_self.height():y;}
params.x=params.x<0?0:params.x;params.y=params.y<0?0:params.y;repositionMinimap();}
function getCenteredX(){var x=0;if(storedWidth<canvas2DContext.width){x+=Math.floor((canvas2DContext.width-storedWidth)/ 2);}
return x;}
function centerParams(orig){var p=$.extend(true,{},orig),diff;if(fullImageDims.w*orig.s<_self.width()-1){diff=_self.width()-fullImageDims.w*orig.s;p.x-=parseInt(diff / 2,10);}
if(opts.allowYCentering&&fullImageDims.h*orig.s<_self.height()-1){diff=_self.height()-fullImageDims.h*orig.s;p.y-=parseInt(diff / 2,10);}
return p;}
function scaleCanvas(commit){$("button.object-view__button-icon-favourites").hide();if(fullImageDims){setRealCanvasPosition(params.x,params.y);if(previewImage){canvas2DContext.clearRect(0,0,canvas2DContext.width,canvas2DContext.height);var p=centerParams(params);var w=parseInt(fullImageDims.w*params.s,10);var h=parseInt(fullImageDims.h*params.s,10);$("button.object-view__button-icon-favourites").css({top:-p.y+h-40,left:-p.x});canvas2DContext.drawImage(previewImage.get(0),-p.x,-p.y,w,h);imageviewerClientGlobals.boundingBox={x:-p.x,y:-p.y,w:parseInt(fullImageDims.w*params.s,10),h:parseInt(fullImageDims.h*params.s,10)};$canvas.attr("swipable",$canvas.attr("width")>=imageviewerClientGlobals.boundingBox.w);}
if(slider){slider.slider("value",Math.ceil(params.s*100));}
if(commit){loadCanvas();}
if(opts.onzoom){opts.onzoom(params.s);}}}
function rotateCanvas(){fullImageDims=null;previewParams.r=params.r;loadPreviewImage(scaleCanvas);}
function storeCanvasCenter(center){var top=_self.offset().top-$(window).scrollTop(),left=_self.offset().left,x=center&&center.x?center.x:_self.width()/ 2+left,y=center&&center.y?center.y:_self.height()/ 2+top;storedCenter={x:(params.x+(x||_self.width()/ 2)-left)/ params.s,y:(params.y+(y||_self.height()/ 2)-top)/ params.s};}
function moveToStoredCenter(commit){if(storedCenter&&storedCenter.x&&storedCenter.y){var x=(storedCenter.x*params.s)-(_self.width()/ 2),y=(storedCenter.y*params.s)-(_self.height()/ 2);setRealCanvasPosition(x,y);scaleCanvas(commit);}}
function setHighlights(set){if(set&&params.words){return;}
if(!set&&!params.words){return;}
if(set&&words&&coords){params.words=words;params.coords=coords;previewParams.words=words;previewParams.coords=coords;}else{delete(params.words);delete(params.coords);delete(previewParams.words);delete(previewParams.coords);}
if(previewImage){previewImage.attr("src",serviceUrl+"?"+new Date().getTime()+"&"+$.param(previewParams));loadCanvas();}}
this.bind("setHighlights",function(e,set){setHighlights(set);});this.bind("recalibrate",function(e){params.w=$(this).width();params.h=$(this).height();canvas2DContext.height=params.h;canvas2DContext.width=params.w;recalculateMinScale();scaleCanvas(true);});this.bind("moveTo",function(e,dims,commit,rescale){if(rescale){dims.x*=params.s;dims.y*=params.s;}
var x=dims.x,y=dims.y;setRealCanvasPosition(x,y);scaleCanvas(commit);});this.bind("moveBy",function(e,dims,commit,rescale){if(rescale){dims.x*=params.s;dims.y*=params.s;}
var x=params.x-dims.x,y=params.y-dims.y;setRealCanvasPosition(x,y);scaleCanvas(commit);});this.bind("scaleBy",function(e,factor,commit,center,scalingTo,options){var opts=options||{};storeCanvasCenter(center);if(scalingTo){params.s=factor;}else{params.s*=factor;}
if(params.s>maxScale){params.s=maxScale;}
if(params.s<minScale){params.s=minScale;}
moveToStoredCenter(commit);if(opts.callback){opts.callback(params.s);}
imageviewerClientCurrentScaleFactor=params.s;});this.bind("rotateBy",function(e,factor){params.r+=factor;if(params.r<0){params.r=270;}else if(params.r>270){params.r=0;}
rotateCanvas();});this.bind("scaleToFullWidth",function(e){if(fullImageDims&&fullImageDims.w){params.x=0;params.s=(_self.width())/ fullImageDims.w;scaleCanvas(true);}});this.bind("paint",function(e){scaleCanvas(true);});this.bind("scaleToFullHeight",function(e){if(fullImageDims&&fullImageDims.h){params.y=0;params.s=_self.height()/ fullImageDims.h;scaleCanvas(true);}});this.bind("scaleToFullHeightOr1s",function(e){if(fullImageDims&&fullImageDims.h){params.y=0;params.s=_self.height()/ fullImageDims.h;if(params.s>1.0){params.s=1.0;}
scaleCanvas(true);}});this.bind("scaleToFullPage",function(e,canvasMaximumHeight,canvasMaximumWidth){if(!fullImageDims){return;}
if(typeof canvasMaximumHeight==='undefined'){canvasMaximumHeight=opts.params.canvasMaximumHeight;canvasMaximumWidth=opts.params.canvasMaximumWidth;}
if(canvasMaximumWidth / canvasMaximumHeight<fullImageDims.w / fullImageDims.h){params.s=parseFloat(canvasMaximumWidth / fullImageDims.w);}else{params.s=parseFloat(canvasMaximumHeight / fullImageDims.h);}
imageviewerClientInitialScaleFactor=params.s;imageviewerClientCurrentScaleFactor=params.s;scaleCanvas(true);});this.bind("redraw",function(e){if(canvasImage.length>0&&canvasImage.get(0).complete){canvas2DContext.drawImage(canvasImage.get(0),getCenteredX(),0);}else if(previewImage.length>0&&previewImage.get(0).complete){canvas2DContext.drawImage(previewImage.get(0),-params.x,-params.y,parseInt(fullImageDims.w*params.s,10),parseInt(fullImageDims.h*params.s,10));}});this.bind("drawRect",function(e,c1,c2){_self.trigger("redraw");canvas2DContext.beginPath();if(getCenteredX()>c1.x){c1.x=getCenteredX()+1;}
if(getCenteredX()>c2.x){c2.x=getCenteredX()+1;}
if(canvasImage[0].height<c1.y){c1.y=canvasImage[0].height;}
if(canvasImage[0].height<c2.y){c2.y=canvasImage[0].height;}
if(getCenteredX()+canvasImage[0].width<c1.x){c1.x=getCenteredX()+canvasImage[0].width;}
if(getCenteredX()+canvasImage[0].width<c2.x){c2.x=getCenteredX()+canvasImage[0].width;}
canvas2DContext.rect(c1.x,c1.y,c2.x-c1.x,c2.y-c1.y);canvas2DContext.lineWidth=opts.boxWidth||1;canvas2DContext.strokeStyle=opts.boxStroke||"red";canvas2DContext.fillStyle=opts.boxFill||"rgba(128,128,255,0.1)";canvas2DContext.fill();canvas2DContext.stroke();canvas2DContext.closePath();});this.bind("addOverlays",function(e,data){if(!data.zones||data.zones.length===0||$.inArray(data.id,_overlaysDrawn)>-1){return;}
var i;canvas2DContext.beginPath();canvas2DContext.fillStyle=opts.overlayFill||"rgba(255,255,0,0.1)";for(i=0;i<data.zones.length;i++){if(!data.zones[i].x){break;}
canvas2DContext.rect(parseInt(data.zones[i].x*parseFloat(params.s),10)-params.x+getCenteredX(),parseInt(data.zones[i].y*parseFloat(params.s),10)-params.y,parseInt(data.zones[i].w*parseFloat(params.s),10),parseInt(data.zones[i].h*parseFloat(params.s),10));}
canvas2DContext.fill();canvas2DContext.closePath();_overlaysDrawn.push(data.id);});this.bind("dropOverlays",function(e,data){if(!canvasImage||!canvasImage.get(0)){return;}
if(canvasImage.get(0).complete){_self.trigger("redraw");}else{canvasImage.on("load",function(){_self.trigger("redraw");});}
_overlaysDrawn.splice(_overlaysDrawn.indexOf(data.id),1);});this.bind("save",function(e,scriptPath,fullImage){var p=$.extend(true,{},params);if(fullImage){delete(p.w);delete(p.h);delete(p.x);delete(p.y);}
if(popup){popup.close();}
popup=window.open(scriptPath+"?"+new Date().getTime()+"&"+$.param(normalize(p)));return false;});this.bind("clip",function(e,cc1,cc2){if(opts.onClip){var p=$.extend(true,{},params);p.x=((cc1.x<cc2.x?cc1.x:cc2.x))+p.x-getCenteredX();p.y=((cc1.y<cc2.y?cc1.y:cc2.y))+p.y;p.w=((cc1.x<cc2.x?cc2.x-cc1.x:cc1.x-cc2.x));p.h=((cc1.y<cc2.y?cc2.y-cc1.y:cc1.y-cc2.y));opts.onClip(serviceUrl+"?"+$.param(normalize(p)),normalize(p));}});function _init(){loadPreviewImage(function(){_self.trigger(initialZoom);});}
if(slider){slider.slider({max:Math.ceil(maxScale*100),min:Math.ceil(minScale*100),slide:function(e,x){var newScale=x.value / 100.0;_self.trigger("scaleBy",[newScale,false,null,true]);scaleCanvas(false);sliding=true;$(this).attr("title",x.value+"%");},change:function(e,x){if(sliding){loadCanvas();sliding=false;}
$(this).attr("title",x.value+"%");},orientation:"vertical"});}
if(opts.highlightsOff){setHighlights(false);}
_init();return this;};}(jQuery));(function($){$.fn.imageViewerHandlers=function(opts){var lastCursorPos={x:0,y:0},storedPos={x:0,y:0},dragging=false,clipping=false,deferDelay=null,deferring=false,_self=this,_availableStates=["default","clipping"],_state="default",_scrollLock=false;function getBox(){return{y0:$(_self).offset().top-$(window).scrollTop(),x0:$(_self).offset().left,y1:$(_self).offset().top+$(this).height()-$(window).scrollTop(),x1:$(_self).offset().left+$(this).width()};}
function deferCommit(){var diff=deferDelay-new Date().getTime();if(new Date().getTime()<deferDelay){setTimeout(deferCommit,1);}else{deferring=false;_self.trigger('paint');}}
if(opts&&opts.mousewheel){this.mousewheel(function(e,which){if(opts.zoomWithinBounds&&(e.clientX-$(this).position().left<imageviewerClientGlobals.boundingBox.x||e.clientX-$(this).position().left>imageviewerClientGlobals.boundingBox.x+imageviewerClientGlobals.boundingBox.w||e.clientY-$(this).position().top<imageviewerClientGlobals.boundingBox.y||e.clientY-$(this).position().top>imageviewerClientGlobals.boundingBox.y+imageviewerClientGlobals.boundingBox.h)){return true;}
e.preventDefault();if(_scrollLock){if(which<0){$(this).trigger('moveBy',[{x:0,y:-30},false]);}else if(which>0){$(this).trigger('moveBy',[{x:0,y:30},false]);}}else{if(which<0){if(typeof opts.initialScaleFactor!=="undefined"){if(imageviewerClientCurrentScaleFactor*0.9>imageviewerClientInitialScaleFactor){$(this).trigger('scaleBy',[0.9,false]);}else{$(this).trigger('scaleBy',[imageviewerClientInitialScaleFactor,false,null,true]);}}else{$(this).trigger('scaleBy',[0.9,false]);}}else if(which>0){$(this).trigger('scaleBy',[1.1,false]);}}
deferDelay=new Date().getTime()+800;if(!deferring){deferring=true;deferCommit();}
return false;});}
this.on("setScrollLock",function(e,lock){_scrollLock=lock;});this.on("setState",function(e,state){if($.inArray(state,_availableStates)>-1){_state=state;if(_state==='clipping'){$(this).css({cursor:"crosshair"});}else{$(this).attr("style","");}}else{_state="default";}});this.on("mousedown",function(e){if($(this).hasClass("touchactive")){e.preventDefault();e.stopPropagation();return false;}
e.preventDefault();lastCursorPos={x:e.clientX,y:e.clientY};if(_state==="default"){$(this).addClass("dragging-cursor");dragging=true;}else if(_state==="clipping"){clipping=true;var box=getBox();storedPos={x:e.clientX-box.x0,y:e.clientY-box.y0};}}).on("mousemove",function(e){if($(this).hasClass("touchactive")){e.preventDefault();e.stopPropagation();return false;}
var movement={x:e.clientX-lastCursorPos.x,y:e.clientY-lastCursorPos.y},box;if(dragging){e.preventDefault();$(this).trigger('moveBy',[movement,false]);}else if(clipping&&(movement.x!==0||movement.y!==0)){box=getBox();$(this).trigger('drawRect',[storedPos,{x:e.clientX-box.x0,y:e.clientY-box.y0}]);}
lastCursorPos={x:e.clientX,y:e.clientY};}).on("mouseup",function(e){if($(this).hasClass("touchactive")){e.preventDefault();e.stopPropagation();return false;}
var movement,box;if(dragging){e.preventDefault();movement={x:e.clientX-lastCursorPos.x,y:e.clientY-lastCursorPos.y};$(this).trigger('moveBy',[movement,true]);}else if(clipping){box=getBox();$(this).trigger('clip',[storedPos,{x:e.clientX-box.x0,y:e.clientY-box.y0}]);}
$(this).removeClass("dragging-cursor");clipping=false;dragging=false;}).on("mouseout",function(e){if($(this).hasClass("touchactive")){e.preventDefault();e.stopPropagation();return false;}
var box=getBox(),movement;if(e.clientX<box.x0||e.clientX>box.x1||e.clientY<box.y0||e.clientY>box.y1){e.preventDefault();if(dragging){movement={x:e.clientX-lastCursorPos.x,y:e.clientY-lastCursorPos.y};$(this).trigger('moveBy',[movement,true]);dragging=false;$(this).removeClass("dragging-cursor");}}}).on("click",function(e){if($(this).hasClass("touchactive")){e.preventDefault();e.stopPropagation();return false;}}).on();return this;};}(jQuery));(function($){var canvasDrawingAreaControl;$.fn.imageviewerTouchHandlers=function(opts){var _self=this,_availableStates=["default","clipping"],_state="default",lastPos=false,touchmap={startPos:false,positions:[],tapStart:0,lastTap:0,pinchDelta:0,pinchDistance:0};function getBox(){return{y0:$(_self).offset().top-$(window).scrollTop(),x0:$(_self).offset().left,y1:$(_self).offset().top+$(this).height()-$(window).scrollTop(),x1:$(_self).offset().left+$(this).width()};}
this.on("setState",function(e,state){if($.inArray(state,_availableStates)>-1){_state=state;}else{_state="default";}});$(this).on("touchstart",function(e){$("body").trigger("click");var touches=e.originalEvent.touches,box;if(touches.length===1){touchmap.tapStart=new Date().getTime();box=getBox();touchmap.startPos={x:touches[0].pageX-box.x0,y:touches[0].pageY-box.y0};if(imageviewerClientGlobals.boundingBox.x<touchmap.startPos.x&&touchmap.startPos.x<imageviewerClientGlobals.boundingBox.x+imageviewerClientGlobals.boundingBox.w&&imageviewerClientGlobals.boundingBox.y<touchmap.startPos.y&&touchmap.startPos.y<imageviewerClientGlobals.boundingBox.y+imageviewerClientGlobals.boundingBox.h){canvasDrawingAreaControl=true;}else{canvasDrawingAreaControl=false;return true;}}
$(this).addClass("touchactive");e.preventDefault();e.stopPropagation();return false;});$(this).on("touchend",function(e){var touches=e.originalEvent.touches,box,touchendX,deltaX;$(this).trigger('moveBy',[{x:0,y:0},true]);lastPos=false;var timeDifference=new Date().getTime()-touchmap.tapStart;if(timeDifference<400&&typeof touchmap.positions[0]==="undefined"){if(typeof opts.ontap==="function"){opts.ontap();}}else if(timeDifference<1000){if(typeof opts.onswipeleft==="function"&&typeof opts.onswiperight==="function"){box=getBox();touchendX=touchmap.positions[0].x-box.x0;deltaX=touchmap.startPos.x-touchendX;if(deltaX>150){opts.onswipeleft();}else if(deltaX<-150){opts.onswiperight();}}}
if(new Date().getTime()-touchmap.lastTap<400){if(opts.ondoubletap){opts.ondoubletap();}
touchmap.lastTap=0;}else if(new Date().getTime()-touchmap.tapStart<200){touchmap.lastTap=new Date().getTime();touchmap.tapStart=0;}
if(touches.length===0){$(this).removeClass("touchactive");}
if(_state==='clipping'&&touchmap.startPos){box=getBox();$(this).trigger('clip',[touchmap.startPos,{x:touchmap.positions[0].x-box.x0,y:touchmap.positions[0].y-box.y0}]);}
touchmap.startPos=false;e.preventDefault();e.stopPropagation();return false;});$(this).on("touchmove",function(e){var touches=e.originalEvent.touches,i,cur,oldD,sHeur,movement,box;for(i=0;i<touches.length;i++){cur={x:touches[i].pageX,y:touches[i].pageY};touchmap.positions[i]=cur;}
if(_state==='default'){if(touches.length===2){oldD=touchmap.pinchDistance;touchmap.pinchDistance=parseInt(Math.sqrt(((touchmap.positions[0].x-touchmap.positions[1].x)*(touchmap.positions[0].x-touchmap.positions[1].x))+((touchmap.positions[0].y-touchmap.positions[1].y)*(touchmap.positions[0].y-touchmap.positions[1].y))),10);touchmap.pinchDelta=oldD-touchmap.pinchDistance;if(touchmap.pinchDelta<20&&touchmap.pinchDelta>-20){sHeur=1.0-(touchmap.pinchDelta*0.01);if(typeof opts.initialScaleFactor!=="undefined"){if(imageviewerClientCurrentScaleFactor*sHeur>imageviewerClientInitialScaleFactor){$(this).trigger("scaleBy",[sHeur,false]);}else{$(this).trigger("scaleBy",[imageviewerClientInitialScaleFactor,false,null,true]);}}else{$(this).trigger('scaleBy',[sHeur,false]);}}}else if(touches.length===1){if(canvasDrawingAreaControl){if(lastPos!==false){movement={x:touchmap.positions[0].x-lastPos.x,y:touchmap.positions[0].y-lastPos.y};$(this).trigger('moveBy',[movement,false]);}
lastPos={x:touchmap.positions[0].x,y:touchmap.positions[0].y};}else{return true;}}}else if(_state==='clipping'&&touchmap.startPos){box=getBox();$(this).trigger('drawRect',[touchmap.startPos,{x:touchmap.positions[0].x-box.x0,y:touchmap.positions[0].y-box.y0}]);}
e.preventDefault();e.stopPropagation();return false;});if(typeof MSGesture==="function"){var canvas=document.getElementById("image");var gesture=new MSGesture();gesture.target=canvas;canvas.addEventListener("pointerdown",function(event){gesture.addPointer(event.pointerId);});if(typeof opts.ontap==="function"){canvas.addEventListener("MSGestureTap",function(event){opts.ontap();});}
canvas.addEventListener("MSGestureChange",function(event){if(event.detail===event.MSGESTURE_FLAG_NONE&&event.scale!==1){if(typeof opts.initialScaleFactor!=="undefined"){if(imageviewerClientCurrentScaleFactor*event.scale>imageviewerClientInitialScaleFactor){$(this).trigger("scaleBy",[event.scale,false]);}else{$(this).trigger("scaleBy",[imageviewerClientInitialScaleFactor,false,null,true]);}}else{$(this).trigger("scaleBy",[event.scale,false]);}}else if(event.detail===event.MSGESTURE_FLAG_NONE&&event.translationY!==0&&!(imageviewerClientGlobals.boundingBox.x<event.offsetX&&event.offsetX<imageviewerClientGlobals.boundingBox.x+imageviewerClientGlobals.boundingBox.w&&imageviewerClientGlobals.boundingBox.y<event.offsetY&&event.offsetY<imageviewerClientGlobals.boundingBox.y+imageviewerClientGlobals.boundingBox.h)){document.documentElement.scrollTop=document.documentElement.scrollTop-event.translationY;}});if(typeof opts.onswipeleft==="function"||typeof opts.onswiperight==="function"){var translation;canvas.addEventListener("MSGestureStart",function(event){translation=event.translationX;});canvas.addEventListener("MSGestureEnd",function(event){if(translation>3){gesture.stop();opts.onswiperight();}else if(translation<-3){gesture.stop();opts.onswipeleft();}});}}
return this;};}(jQuery));(function($){$.fn.minimap=function(scale,height,options){var opts=options||{},_self=this,viewerLayer=$("<canvas>").attr("width",$(this).width()).attr("height",height),dragging,pos;_self.css({height:height});if(opts.onload){opts.onload($(this).height());}
if(opts.image){_self.css({backgroundImage:"url("+opts.image.replace("(","%28").replace(")","%29")+")"});}
this.append(viewerLayer);this.bind("repositionViewerZone",function(e,box){var y=box.y*scale,x=box.x*scale,w=box.w*scale-
(box.x*scale+box.w*scale>_self.width()?box.x*scale+box.w*scale-_self.width():0),h=box.h*scale-
(box.y*scale+box.h*scale>_self.height()?box.y*scale+box.h*scale-_self.height():0),ctx=viewerLayer[0].getContext('2d');ctx.clearRect(0,0,viewerLayer[0].width,viewerLayer[0].height);ctx.beginPath();ctx.strokeStyle=(opts.color||"black");ctx.rect(x,y,w,h);ctx.stroke();});function moveBy(movement){return{x:-movement.x / scale,y:-movement.y / scale};}
if(opts.interactive&&opts.canvas){dragging=false;pos={x:0,y:0};viewerLayer.on("mousedown",function(e){e.preventDefault();dragging=true;pos={x:e.pageX,y:e.pageY};if(opts.ondown){opts.ondown({x:(pos.x-$(this).offset().left-5)/ scale,y:(pos.y-$(this).offset().top-5)/ scale});}});viewerLayer.on("mouseup",function(e){dragging=false;var movement={x:e.pageX-pos.x,y:e.pageY-pos.y},canvasMovement=moveBy(movement);if(opts.onup){opts.onup(canvasMovement);}});viewerLayer.on("mouseout",function(e){if(dragging){dragging=false;var movement={x:e.pageX-pos.x,y:e.pageY-pos.y},canvasMovement=moveBy(movement);if(opts.onup){opts.onup(canvasMovement);}}});viewerLayer.on("mousemove",function(e){if(dragging){var movement={x:e.pageX-pos.x,y:e.pageY-pos.y},canvasMovement=moveBy(movement);pos={x:e.pageX,y:e.pageY};if(opts.onmove){opts.onmove(canvasMovement);}}});}
return this;};}(jQuery));
var anticlick={list:[]};(function($){$.fn.onAntiClick=function(callback,options){var opts=options||{};var excludedElements=opts.excludedElements||[];excludedElements.push(this);anticlick.list.push({elements:excludedElements,callback:callback});return this;};$.fn.removeAntiClick=function(){for(var x in anticlick.list){for(var y in anticlick.list[x].elements){if($(anticlick.list[x].elements[y]).get(0)===this.get(0)){anticlick.list.splice(x,1);return this;}}}
return this;};})(jQuery);$(document).ready(function(){$(document).on("touchstart click",function(e){for(var x in anticlick.list){var isGo=true;for(var y in anticlick.list[x].elements){var b=$(anticlick.list[x].elements[y]);var st=$(document).scrollTop();var mpsum={x:parseInt(b.css("paddingLeft"))+parseInt(b.css("marginLeft"))+
parseInt(b.css("paddingRight"))+parseInt(b.css("marginRight")),y:parseInt(b.css("paddingTop"))+parseInt(b.css("marginTop"))+
parseInt(b.css("paddingBottom"))+parseInt(b.css("paddingBottom"))};var box={x0:b.offset().left,y0:b.offset().top-st,x1:b.width()+b.offset().left+mpsum.x,y1:b.height()+b.offset().top-st+mpsum.y};if(e.clientX>=box.x0&&e.clientX<=box.x1&&e.clientY>=box.y0&&e.clientY<=box.y1){isGo=false;break;}}
if(isGo){anticlick.list[x].callback();}}});});
(function(root,factory){if(typeof define==='function'&&define.amd){define('sifter',factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.Sifter=factory();}}(this,function(){var Sifter=function(items,settings){this.items=items;this.settings=settings||{diacritics:true};};Sifter.prototype.tokenize=function(query){query=trim(String(query||'').toLowerCase());if(!query||!query.length)return[];var i,n,regex,letter;var tokens=[];var words=query.split(/ +/);for(i=0,n=words.length;i<n;i++){regex=escape_regex(words[i]);if(this.settings.diacritics){for(letter in DIACRITICS){if(DIACRITICS.hasOwnProperty(letter)){regex=regex.replace(new RegExp(letter,'g'),DIACRITICS[letter]);}}}
tokens.push({string:words[i],regex:new RegExp(regex,'i')});}
return tokens;};Sifter.prototype.iterator=function(object,callback){var iterator;if(is_array(object)){iterator=Array.prototype.forEach||function(callback){for(var i=0,n=this.length;i<n;i++){callback(this[i],i,this);}};}else{iterator=function(callback){for(var key in this){if(this.hasOwnProperty(key)){callback(this[key],key,this);}}};}
iterator.apply(object,[callback]);};Sifter.prototype.getScoreFunction=function(search,options){var self,fields,tokens,token_count;self=this;search=self.prepareSearch(search,options);tokens=search.tokens;fields=search.options.fields;token_count=tokens.length;var scoreValue=function(value,token){var score,pos;if(!value)return 0;value=String(value||'');pos=value.search(token.regex);if(pos===-1)return 0;score=token.string.length / value.length;if(pos===0)score+=0.5;return score;};var scoreObject=(function(){var field_count=fields.length;if(!field_count){return function(){return 0;};}
if(field_count===1){return function(token,data){return scoreValue(data[fields[0]],token);};}
return function(token,data){for(var i=0,sum=0;i<field_count;i++){sum+=scoreValue(data[fields[i]],token);}
return sum / field_count;};})();if(!token_count){return function(){return 0;};}
if(token_count===1){return function(data){return scoreObject(tokens[0],data);};}
if(search.options.conjunction==='and'){return function(data){var score;for(var i=0,sum=0;i<token_count;i++){score=scoreObject(tokens[i],data);if(score<=0)return 0;sum+=score;}
return sum / token_count;};}else{return function(data){for(var i=0,sum=0;i<token_count;i++){sum+=scoreObject(tokens[i],data);}
return sum / token_count;};}};Sifter.prototype.getSortFunction=function(search,options){var i,n,self,field,fields,fields_count,multiplier,multipliers,get_field,implicit_score,sort;self=this;search=self.prepareSearch(search,options);sort=(!search.query&&options.sort_empty)||options.sort;get_field=function(name,result){if(name==='$score')return result.score;return self.items[result.id][name];};fields=[];if(sort){for(i=0,n=sort.length;i<n;i++){if(search.query||sort[i].field!=='$score'){fields.push(sort[i]);}}}
if(search.query){implicit_score=true;for(i=0,n=fields.length;i<n;i++){if(fields[i].field==='$score'){implicit_score=false;break;}}
if(implicit_score){fields.unshift({field:'$score',direction:'desc'});}}else{for(i=0,n=fields.length;i<n;i++){if(fields[i].field==='$score'){fields.splice(i,1);break;}}}
multipliers=[];for(i=0,n=fields.length;i<n;i++){multipliers.push(fields[i].direction==='desc'?-1:1);}
fields_count=fields.length;if(!fields_count){return null;}else if(fields_count===1){field=fields[0].field;multiplier=multipliers[0];return function(a,b){return multiplier*cmp(get_field(field,a),get_field(field,b));};}else{return function(a,b){var i,result,a_value,b_value,field;for(i=0;i<fields_count;i++){field=fields[i].field;result=multipliers[i]*cmp(get_field(field,a),get_field(field,b));if(result)return result;}
return 0;};}};Sifter.prototype.prepareSearch=function(query,options){if(typeof query==='object')return query;options=extend({},options);var option_fields=options.fields;var option_sort=options.sort;var option_sort_empty=options.sort_empty;if(option_fields&&!is_array(option_fields))options.fields=[option_fields];if(option_sort&&!is_array(option_sort))options.sort=[option_sort];if(option_sort_empty&&!is_array(option_sort_empty))options.sort_empty=[option_sort_empty];return{options:options,query:String(query||'').toLowerCase(),tokens:this.tokenize(query),total:0,items:[]};};Sifter.prototype.search=function(query,options){var self=this,value,score,search,calculateScore;var fn_sort;var fn_score;search=this.prepareSearch(query,options);options=search.options;query=search.query;fn_score=options.score||self.getScoreFunction(search);if(query.length){self.iterator(self.items,function(item,id){score=fn_score(item);if(options.filter===false||score>0){search.items.push({'score':score,'id':id});}});}else{self.iterator(self.items,function(item,id){search.items.push({'score':1,'id':id});});}
fn_sort=self.getSortFunction(search,options);if(fn_sort)search.items.sort(fn_sort);search.total=search.items.length;if(typeof options.limit==='number'){search.items=search.items.slice(0,options.limit);}
return search;};var cmp=function(a,b){if(typeof a==='number'&&typeof b==='number'){return a>b?1:(a<b?-1:0);}
a=asciifold(String(a||''));b=asciifold(String(b||''));if(a>b)return 1;if(b>a)return-1;return 0;};var extend=function(a,b){var i,n,k,object;for(i=1,n=arguments.length;i<n;i++){object=arguments[i];if(!object)continue;for(k in object){if(object.hasOwnProperty(k)){a[k]=object[k];}}}
return a;};var trim=function(str){return(str+'').replace(/^\s+|\s+$|/g,'');};var escape_regex=function(str){return(str+'').replace(/([.?*+^$[\]\\(){}|-])/g,'\\$1');};var is_array=Array.isArray||($&&$.isArray)||function(object){return Object.prototype.toString.call(object)==='[object Array]';};var DIACRITICS={'a':'[aÀÁÂÃÄÅàáâãäåĀāąĄ]','c':'[cÇçćĆčČ]','d':'[dđĐďĎ]','e':'[eÈÉÊËèéêëěĚĒēęĘ]','i':'[iÌÍÎÏìíîïĪī]','l':'[lłŁ]','n':'[nÑñňŇńŃ]','o':'[oÒÓÔÕÕÖØòóôõöøŌō]','r':'[rřŘ]','s':'[sŠšśŚ]','t':'[tťŤ]','u':'[uÙÚÛÜùúûüůŮŪū]','y':'[yŸÿýÝ]','z':'[zŽžżŻźŹ]'};var asciifold=(function(){var i,n,k,chunk;var foreignletters='';var lookup={};for(k in DIACRITICS){if(DIACRITICS.hasOwnProperty(k)){chunk=DIACRITICS[k].substring(2,DIACRITICS[k].length-1);foreignletters+=chunk;for(i=0,n=chunk.length;i<n;i++){lookup[chunk.charAt(i)]=k;}}}
var regexp=new RegExp('['+foreignletters+']','g');return function(str){return str.replace(regexp,function(foreignletter){return lookup[foreignletter];}).toLowerCase();};})();return Sifter;}));(function(root,factory){if(typeof define==='function'&&define.amd){define('microplugin',factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.MicroPlugin=factory();}}(this,function(){var MicroPlugin={};MicroPlugin.mixin=function(Interface){Interface.plugins={};Interface.prototype.initializePlugins=function(plugins){var i,n,key;var self=this;var queue=[];self.plugins={names:[],settings:{},requested:{},loaded:{}};if(utils.isArray(plugins)){for(i=0,n=plugins.length;i<n;i++){if(typeof plugins[i]==='string'){queue.push(plugins[i]);}else{self.plugins.settings[plugins[i].name]=plugins[i].options;queue.push(plugins[i].name);}}}else if(plugins){for(key in plugins){if(plugins.hasOwnProperty(key)){self.plugins.settings[key]=plugins[key];queue.push(key);}}}
while(queue.length){self.require(queue.shift());}};Interface.prototype.loadPlugin=function(name){var self=this;var plugins=self.plugins;var plugin=Interface.plugins[name];if(!Interface.plugins.hasOwnProperty(name)){throw new Error('Unable to find "'+name+'" plugin');}
plugins.requested[name]=true;plugins.loaded[name]=plugin.fn.apply(self,[self.plugins.settings[name]||{}]);plugins.names.push(name);};Interface.prototype.require=function(name){var self=this;var plugins=self.plugins;if(!self.plugins.loaded.hasOwnProperty(name)){if(plugins.requested[name]){throw new Error('Plugin has circular dependency ("'+name+'")');}
self.loadPlugin(name);}
return plugins.loaded[name];};Interface.define=function(name,fn){Interface.plugins[name]={'name':name,'fn':fn};};};var utils={isArray:Array.isArray||function(vArg){return Object.prototype.toString.call(vArg)==='[object Array]';}};return MicroPlugin;}));(function(root,factory){if(typeof define==='function'&&define.amd){define('selectize',['jquery','sifter','microplugin'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'),require('sifter'),require('microplugin'));}else{root.Selectize=factory(root.jQuery,root.Sifter,root.MicroPlugin);}}(this,function($,Sifter,MicroPlugin){'use strict';var highlight=function($element,pattern){if(typeof pattern==='string'&&!pattern.length)return;var regex=(typeof pattern==='string')?new RegExp(pattern,'i'):pattern;var highlight=function(node){var skip=0;if(node.nodeType===3){var pos=node.data.search(regex);if(pos>=0&&node.data.length>0){var match=node.data.match(regex);var spannode=document.createElement('span');spannode.className='highlight';var middlebit=node.splitText(pos);var endbit=middlebit.splitText(match[0].length);var middleclone=middlebit.cloneNode(true);spannode.appendChild(middleclone);middlebit.parentNode.replaceChild(spannode,middlebit);skip=1;}}else if(node.nodeType===1&&node.childNodes&&!/(script|style)/i.test(node.tagName)){for(var i=0;i<node.childNodes.length;++i){i+=highlight(node.childNodes[i]);}}
return skip;};return $element.each(function(){highlight(this);});};var MicroEvent=function(){};MicroEvent.prototype={on:function(event,fct){this._events=this._events||{};this._events[event]=this._events[event]||[];this._events[event].push(fct);},off:function(event,fct){var n=arguments.length;if(n===0)return delete this._events;if(n===1)return delete this._events[event];this._events=this._events||{};if(event in this._events===false)return;this._events[event].splice(this._events[event].indexOf(fct),1);},trigger:function(event){this._events=this._events||{};if(event in this._events===false)return;for(var i=0;i<this._events[event].length;i++){this._events[event][i].apply(this,Array.prototype.slice.call(arguments,1));}}};MicroEvent.mixin=function(destObject){var props=['on','off','trigger'];for(var i=0;i<props.length;i++){destObject.prototype[props[i]]=MicroEvent.prototype[props[i]];}};var IS_MAC=/Mac/.test(navigator.userAgent);var KEY_A=65;var KEY_COMMA=188;var KEY_RETURN=13;var KEY_ESC=27;var KEY_LEFT=37;var KEY_UP=38;var KEY_P=80;var KEY_RIGHT=39;var KEY_DOWN=40;var KEY_N=78;var KEY_BACKSPACE=8;var KEY_DELETE=46;var KEY_SHIFT=16;var KEY_CMD=IS_MAC?91:17;var KEY_CTRL=IS_MAC?18:17;var KEY_TAB=9;var TAG_SELECT=1;var TAG_INPUT=2;var SUPPORTS_VALIDITY_API=!/android/i.test(window.navigator.userAgent)&&!!document.createElement('form').validity;var isset=function(object){return typeof object!=='undefined';};var hash_key=function(value){if(typeof value==='undefined'||value===null)return null;if(typeof value==='boolean')return value?'1':'0';return value+'';};var escape_html=function(str){return(str+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');};var escape_replace=function(str){return(str+'').replace(/\$/g,'$$$$');};var hook={};hook.before=function(self,method,fn){var original=self[method];self[method]=function(){fn.apply(self,arguments);return original.apply(self,arguments);};};hook.after=function(self,method,fn){var original=self[method];self[method]=function(){var result=original.apply(self,arguments);fn.apply(self,arguments);return result;};};var once=function(fn){var called=false;return function(){if(called)return;called=true;fn.apply(this,arguments);};};var debounce=function(fn,delay){var timeout;return function(){var self=this;var args=arguments;window.clearTimeout(timeout);timeout=window.setTimeout(function(){fn.apply(self,args);},delay);};};var debounce_events=function(self,types,fn){var type;var trigger=self.trigger;var event_args={};self.trigger=function(){var type=arguments[0];if(types.indexOf(type)!==-1){event_args[type]=arguments;}else{return trigger.apply(self,arguments);}};fn.apply(self,[]);self.trigger=trigger;for(type in event_args){if(event_args.hasOwnProperty(type)){trigger.apply(self,event_args[type]);}}};var watchChildEvent=function($parent,event,selector,fn){$parent.on(event,selector,function(e){var child=e.target;while(child&&child.parentNode!==$parent[0]){child=child.parentNode;}
e.currentTarget=child;return fn.apply(this,[e]);});};var getSelection=function(input){var result={};if('selectionStart'in input){result.start=input.selectionStart;result.length=input.selectionEnd-result.start;}else if(document.selection){input.focus();var sel=document.selection.createRange();var selLen=document.selection.createRange().text.length;sel.moveStart('character',-input.value.length);result.start=sel.text.length-selLen;result.length=selLen;}
return result;};var transferStyles=function($from,$to,properties){var i,n,styles={};if(properties){for(i=0,n=properties.length;i<n;i++){styles[properties[i]]=$from.css(properties[i]);}}else{styles=$from.css();}
$to.css(styles);};var measureString=function(str,$parent){if(!str){return 0;}
var $test=$('<test>').css({position:'absolute',top:-99999,left:-99999,width:'auto',padding:0,whiteSpace:'pre'}).text(str).appendTo('body');transferStyles($parent,$test,['letterSpacing','fontSize','fontFamily','fontWeight','textTransform']);var width=$test.width();$test.remove();return width;};var autoGrow=function($input){var currentWidth=null;var update=function(e,options){var value,keyCode,printable,placeholder,width;var shift,character,selection;e=e||window.event||{};options=options||{};if(e.metaKey||e.altKey)return;if(!options.force&&$input.data('grow')===false)return;value=$input.val();if(e.type&&e.type.toLowerCase()==='keydown'){keyCode=e.keyCode;printable=((keyCode>=97&&keyCode<=122)||(keyCode>=65&&keyCode<=90)||(keyCode>=48&&keyCode<=57)||keyCode===32);if(keyCode===KEY_DELETE||keyCode===KEY_BACKSPACE){selection=getSelection($input[0]);if(selection.length){value=value.substring(0,selection.start)+value.substring(selection.start+selection.length);}else if(keyCode===KEY_BACKSPACE&&selection.start){value=value.substring(0,selection.start-1)+value.substring(selection.start+1);}else if(keyCode===KEY_DELETE&&typeof selection.start!=='undefined'){value=value.substring(0,selection.start)+value.substring(selection.start+1);}}else if(printable){shift=e.shiftKey;character=String.fromCharCode(e.keyCode);if(shift)character=character.toUpperCase();else character=character.toLowerCase();value+=character;}}
placeholder=$input.attr('placeholder');if(!value&&placeholder){value=placeholder;}
width=measureString(value,$input)+4;if(width!==currentWidth){currentWidth=width;$input.width(width);$input.triggerHandler('resize');}};$input.on('keydown keyup update blur',update);update();};var Selectize=function($input,settings){var key,i,n,dir,input,self=this;input=$input[0];input.selectize=self;var computedStyle=window.getComputedStyle&&window.getComputedStyle(input,null);dir=computedStyle?computedStyle.getPropertyValue('direction'):input.currentStyle&&input.currentStyle.direction;dir=dir||$input.parents('[dir]:first').attr('dir')||'';$.extend(self,{order:0,settings:settings,$input:$input,tabIndex:$input.attr('tabindex')||'',tagType:input.tagName.toLowerCase()==='select'?TAG_SELECT:TAG_INPUT,rtl:/rtl/i.test(dir),eventNS:'.selectize'+(++Selectize.count),highlightedValue:null,isOpen:false,isDisabled:false,isRequired:$input.is('[required]'),isInvalid:false,isLocked:false,isFocused:false,isInputHidden:false,isSetup:false,isShiftDown:false,isCmdDown:false,isCtrlDown:false,ignoreFocus:false,ignoreBlur:false,ignoreHover:false,hasOptions:false,currentResults:null,lastValue:'',caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:settings.loadThrottle===null?self.onSearchChange:debounce(self.onSearchChange,settings.loadThrottle)});self.sifter=new Sifter(this.options,{diacritics:settings.diacritics});if(self.settings.options){for(i=0,n=self.settings.options.length;i<n;i++){self.registerOption(self.settings.options[i]);}
delete self.settings.options;}
if(self.settings.optgroups){for(i=0,n=self.settings.optgroups.length;i<n;i++){self.registerOptionGroup(self.settings.optgroups[i]);}
delete self.settings.optgroups;}
self.settings.mode=self.settings.mode||(self.settings.maxItems===1?'single':'multi');if(typeof self.settings.hideSelected!=='boolean'){self.settings.hideSelected=self.settings.mode==='multi';}
self.initializePlugins(self.settings.plugins);self.setupCallbacks();self.setupTemplates();self.setup();};MicroEvent.mixin(Selectize);MicroPlugin.mixin(Selectize);$.extend(Selectize.prototype,{setup:function(){var self=this;var settings=self.settings;var eventNS=self.eventNS;var $window=$(window);var $document=$(document);var $input=self.$input;var $wrapper;var $control;var $control_input;var $dropdown;var $dropdown_content;var $dropdown_parent;var inputMode;var timeout_blur;var timeout_focus;var classes;var classes_plugins;inputMode=self.settings.mode;classes=$input.attr('class')||'';$wrapper=$('<div>').addClass(settings.wrapperClass).addClass(classes).addClass(inputMode);$control=$('<div>').addClass(settings.inputClass).addClass('items').appendTo($wrapper);$control_input=$('<input type="text" autocomplete="off" />').appendTo($control).attr('tabindex',$input.is(':disabled')?'-1':self.tabIndex);$dropdown_parent=$(settings.dropdownParent||$wrapper);$dropdown=$('<div>').addClass(settings.dropdownClass).addClass(inputMode).hide().appendTo($dropdown_parent);$dropdown_content=$('<div>').addClass(settings.dropdownContentClass).appendTo($dropdown);if(self.settings.copyClassesToDropdown){$dropdown.addClass(classes);}
$wrapper.css({width:$input[0].style.width});if(self.plugins.names.length){classes_plugins='plugin-'+self.plugins.names.join(' plugin-');$wrapper.addClass(classes_plugins);$dropdown.addClass(classes_plugins);}
if((settings.maxItems===null||settings.maxItems>1)&&self.tagType===TAG_SELECT){$input.attr('multiple','multiple');}
if(self.settings.placeholder){$control_input.attr('placeholder',settings.placeholder);}
if(!self.settings.splitOn&&self.settings.delimiter){var delimiterEscaped=self.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');self.settings.splitOn=new RegExp('\\s*'+delimiterEscaped+'+\\s*');}
if($input.attr('autocorrect')){$control_input.attr('autocorrect',$input.attr('autocorrect'));}
if($input.attr('autocapitalize')){$control_input.attr('autocapitalize',$input.attr('autocapitalize'));}
self.$wrapper=$wrapper;self.$control=$control;self.$control_input=$control_input;self.$dropdown=$dropdown;self.$dropdown_content=$dropdown_content;$dropdown.on('mouseenter','[data-selectable]',function(){return self.onOptionHover.apply(self,arguments);});$dropdown.on('mousedown click','[data-selectable]',function(){return self.onOptionSelect.apply(self,arguments);});watchChildEvent($control,'mousedown','*:not(input)',function(){return self.onItemSelect.apply(self,arguments);});autoGrow($control_input);$control.on({mousedown:function(){return self.onMouseDown.apply(self,arguments);},click:function(){return self.onClick.apply(self,arguments);}});$control_input.on({mousedown:function(e){e.stopPropagation();},keydown:function(){return self.onKeyDown.apply(self,arguments);},keyup:function(){return self.onKeyUp.apply(self,arguments);},keypress:function(){return self.onKeyPress.apply(self,arguments);},resize:function(){self.positionDropdown.apply(self,[]);},blur:function(){return self.onBlur.apply(self,arguments);},focus:function(){self.ignoreBlur=false;return self.onFocus.apply(self,arguments);},paste:function(){return self.onPaste.apply(self,arguments);}});$document.on('keydown'+eventNS,function(e){self.isCmdDown=e[IS_MAC?'metaKey':'ctrlKey'];self.isCtrlDown=e[IS_MAC?'altKey':'ctrlKey'];self.isShiftDown=e.shiftKey;});$document.on('keyup'+eventNS,function(e){if(e.keyCode===KEY_CTRL)self.isCtrlDown=false;if(e.keyCode===KEY_SHIFT)self.isShiftDown=false;if(e.keyCode===KEY_CMD)self.isCmdDown=false;});$document.on('mousedown'+eventNS,function(e){if(self.isFocused){if(e.target===self.$dropdown[0]||e.target.parentNode===self.$dropdown[0]){return false;}
if(!self.$control.has(e.target).length&&e.target!==self.$control[0]){self.blur(e.target);}}});$window.on(['scroll'+eventNS,'resize'+eventNS].join(' '),function(){if(self.isOpen){self.positionDropdown.apply(self,arguments);}});$window.on('mousemove'+eventNS,function(){self.ignoreHover=false;});this.revertSettings={$children:$input.children().detach(),tabindex:$input.attr('tabindex')};$input.attr('tabindex',-1).hide().after(self.$wrapper);if($.isArray(settings.items)){self.setValue(settings.items);delete settings.items;}
if(SUPPORTS_VALIDITY_API){$input.on('invalid'+eventNS,function(e){e.preventDefault();self.isInvalid=true;self.refreshState();});}
self.updateOriginalInput();self.refreshItems();self.refreshState();self.updatePlaceholder();self.isSetup=true;if($input.is(':disabled')){self.disable();}
self.on('change',this.onChange);$input.data('selectize',self);$input.addClass('selectized');self.trigger('initialize');if(settings.preload===true){self.onSearchChange('');}},setupTemplates:function(){var self=this;var field_label=self.settings.labelField;var field_optgroup=self.settings.optgroupLabelField;var templates={'optgroup':function(data){return'<div class="optgroup">'+data.html+'</div>';},'optgroup_header':function(data,escape){return'<div class="optgroup-header">'+escape(data[field_optgroup])+'</div>';},'option':function(data,escape){return'<div class="option">'+escape(data[field_label])+'</div>';},'item':function(data,escape){return'<div class="item">'+escape(data[field_label])+'</div>';},'option_create':function(data,escape){return'<div class="create">Add <strong>'+escape(data.input)+'</strong>&hellip;</div>';}};self.settings.render=$.extend({},templates,self.settings.render);},setupCallbacks:function(){var key,fn,callbacks={'initialize':'onInitialize','change':'onChange','item_add':'onItemAdd','item_remove':'onItemRemove','clear':'onClear','option_add':'onOptionAdd','option_remove':'onOptionRemove','option_clear':'onOptionClear','optgroup_add':'onOptionGroupAdd','optgroup_remove':'onOptionGroupRemove','optgroup_clear':'onOptionGroupClear','dropdown_open':'onDropdownOpen','dropdown_close':'onDropdownClose','type':'onType','load':'onLoad','focus':'onFocus','blur':'onBlur'};for(key in callbacks){if(callbacks.hasOwnProperty(key)){fn=this.settings[callbacks[key]];if(fn)this.on(key,fn);}}},onClick:function(e){var self=this;if(!self.isFocused){self.focus();e.preventDefault();}},onMouseDown:function(e){var self=this;var defaultPrevented=e.isDefaultPrevented();var $target=$(e.target);if(self.isFocused){if(e.target!==self.$control_input[0]){if(self.settings.mode==='single'){self.isOpen?self.close():self.open();}else if(!defaultPrevented){self.setActiveItem(null);}
return false;}}else{if(!defaultPrevented){window.setTimeout(function(){self.focus();},0);}}},onChange:function(){this.$input.trigger('change');},onPaste:function(e){var self=this;if(self.isFull()||self.isInputHidden||self.isLocked){e.preventDefault();}else{if(self.settings.splitOn){setTimeout(function(){var splitInput=$.trim(self.$control_input.val()||'').split(self.settings.splitOn);for(var i=0,n=splitInput.length;i<n;i++){self.createItem(splitInput[i]);}},0);}}},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var character=String.fromCharCode(e.keyCode||e.which);if(this.settings.create&&this.settings.mode==='multi'&&character===this.settings.delimiter){this.createItem();e.preventDefault();return false;}},onKeyDown:function(e){var isInput=e.target===this.$control_input[0];var self=this;if(self.isLocked){if(e.keyCode!==KEY_TAB){e.preventDefault();}
return;}
switch(e.keyCode){case KEY_A:if(self.isCmdDown){self.selectAll();return;}
break;case KEY_ESC:if(self.isOpen){e.preventDefault();e.stopPropagation();self.close();}
return;case KEY_N:if(!e.ctrlKey||e.altKey)break;case KEY_DOWN:if(!self.isOpen&&self.hasOptions){self.open();}else if(self.$activeOption){self.ignoreHover=true;var $next=self.getAdjacentOption(self.$activeOption,1);if($next.length)self.setActiveOption($next,true,true);}
e.preventDefault();return;case KEY_P:if(!e.ctrlKey||e.altKey)break;case KEY_UP:if(self.$activeOption){self.ignoreHover=true;var $prev=self.getAdjacentOption(self.$activeOption,-1);if($prev.length)self.setActiveOption($prev,true,true);}
e.preventDefault();return;case KEY_RETURN:if(self.isOpen&&self.$activeOption){self.onOptionSelect({currentTarget:self.$activeOption});e.preventDefault();}
return;case KEY_LEFT:self.advanceSelection(-1,e);return;case KEY_RIGHT:self.advanceSelection(1,e);return;case KEY_TAB:if(self.settings.selectOnTab&&self.isOpen&&self.$activeOption){self.onOptionSelect({currentTarget:self.$activeOption});if(!self.isFull()){e.preventDefault();}}
if(self.settings.create&&self.createItem()){e.preventDefault();}
return;case KEY_BACKSPACE:case KEY_DELETE:self.deleteSelection(e);return;}
if((self.isFull()||self.isInputHidden)&&!(IS_MAC?e.metaKey:e.ctrlKey)){e.preventDefault();return;}},onKeyUp:function(e){var self=this;if(self.isLocked)return e&&e.preventDefault();var value=self.$control_input.val()||'';if(self.lastValue!==value){self.lastValue=value;self.onSearchChange(value);self.refreshOptions();self.trigger('type',value);}},onSearchChange:function(value){var self=this;var fn=self.settings.load;if(!fn)return;if(self.loadedSearches.hasOwnProperty(value))return;self.loadedSearches[value]=true;self.load(function(callback){fn.apply(self,[value,callback]);});},onFocus:function(e){var self=this;var wasFocused=self.isFocused;if(self.isDisabled){self.blur();e&&e.preventDefault();return false;}
if(self.ignoreFocus)return;self.isFocused=true;if(self.settings.preload==='focus')self.onSearchChange('');if(!wasFocused)self.trigger('focus');if(!self.$activeItems.length){self.showInput();self.setActiveItem(null);self.refreshOptions(!!self.settings.openOnFocus);}
self.refreshState();},onBlur:function(e,dest){var self=this;if(!self.isFocused)return;self.isFocused=false;if(self.ignoreFocus){return;}else if(!self.ignoreBlur&&document.activeElement===self.$dropdown_content[0]){self.ignoreBlur=true;self.onFocus(e);return;}
var deactivate=function(){self.close();self.setTextboxValue('');self.setActiveItem(null);self.setActiveOption(null);self.setCaret(self.items.length);self.refreshState();(dest||document.body).focus();self.ignoreFocus=false;self.trigger('blur');};self.ignoreFocus=true;if(self.settings.create&&self.settings.createOnBlur){self.createItem(null,false,deactivate);}else{deactivate();}},onOptionHover:function(e){if(this.ignoreHover)return;this.setActiveOption(e.currentTarget,false);},onOptionSelect:function(e){var value,$target,$option,self=this;if(e.preventDefault){e.preventDefault();e.stopPropagation();}
$target=$(e.currentTarget);if($target.hasClass('create')){self.createItem(null,function(){if(self.settings.closeAfterSelect){self.close();}});}else{value=$target.attr('data-value');if(typeof value!=='undefined'){self.lastQuery=null;self.setTextboxValue('');self.addItem(value);if(self.settings.closeAfterSelect){self.close();}else if(!self.settings.hideSelected&&e.type&&/mouse/.test(e.type)){self.setActiveOption(self.getOption(value));}}}},onItemSelect:function(e){var self=this;if(self.isLocked)return;if(self.settings.mode==='multi'){e.preventDefault();self.setActiveItem(e.currentTarget,e);}},load:function(fn){var self=this;var $wrapper=self.$wrapper.addClass(self.settings.loadingClass);self.loading++;fn.apply(self,[function(results){self.loading=Math.max(self.loading-1,0);if(results&&results.length){self.addOption(results);self.refreshOptions(self.isFocused&&!self.isInputHidden);}
if(!self.loading){$wrapper.removeClass(self.settings.loadingClass);}
self.trigger('load',results);}]);},setTextboxValue:function(value){var $input=this.$control_input;var changed=$input.val()!==value;if(changed){$input.val(value).triggerHandler('update');this.lastValue=value;}},getValue:function(){if(this.tagType===TAG_SELECT&&this.$input.attr('multiple')){return this.items;}else{return this.items.join(this.settings.delimiter);}},setValue:function(value,silent){var events=silent?[]:['change'];debounce_events(this,events,function(){this.clear(silent);this.addItems(value,silent);});},setActiveItem:function($item,e){var self=this;var eventName;var i,idx,begin,end,item,swap;var $last;if(self.settings.mode==='single')return;$item=$($item);if(!$item.length){$(self.$activeItems).removeClass('active');self.$activeItems=[];if(self.isFocused){self.showInput();}
return;}
eventName=e&&e.type.toLowerCase();if(eventName==='mousedown'&&self.isShiftDown&&self.$activeItems.length){$last=self.$control.children('.active:last');begin=Array.prototype.indexOf.apply(self.$control[0].childNodes,[$last[0]]);end=Array.prototype.indexOf.apply(self.$control[0].childNodes,[$item[0]]);if(begin>end){swap=begin;begin=end;end=swap;}
for(i=begin;i<=end;i++){item=self.$control[0].childNodes[i];if(self.$activeItems.indexOf(item)===-1){$(item).addClass('active');self.$activeItems.push(item);}}
e.preventDefault();}else if((eventName==='mousedown'&&self.isCtrlDown)||(eventName==='keydown'&&this.isShiftDown)){if($item.hasClass('active')){idx=self.$activeItems.indexOf($item[0]);self.$activeItems.splice(idx,1);$item.removeClass('active');}else{self.$activeItems.push($item.addClass('active')[0]);}}else{$(self.$activeItems).removeClass('active');self.$activeItems=[$item.addClass('active')[0]];}
self.hideInput();if(!this.isFocused){self.focus();}},setActiveOption:function($option,scroll,animate){var height_menu,height_item,y;var scroll_top,scroll_bottom;var self=this;if(self.$activeOption)self.$activeOption.removeClass('active');self.$activeOption=null;$option=$($option);if(!$option.length)return;self.$activeOption=$option.addClass('active');if(scroll||!isset(scroll)){height_menu=self.$dropdown_content.height();height_item=self.$activeOption.outerHeight(true);scroll=self.$dropdown_content.scrollTop()||0;y=self.$activeOption.offset().top-self.$dropdown_content.offset().top+scroll;scroll_top=y;scroll_bottom=y-height_menu+height_item;if(y+height_item>height_menu+scroll){self.$dropdown_content.stop().animate({scrollTop:scroll_bottom},animate?self.settings.scrollDuration:0);}else if(y<scroll){self.$dropdown_content.stop().animate({scrollTop:scroll_top},animate?self.settings.scrollDuration:0);}}},selectAll:function(){var self=this;if(self.settings.mode==='single')return;self.$activeItems=Array.prototype.slice.apply(self.$control.children(':not(input)').addClass('active'));if(self.$activeItems.length){self.hideInput();self.close();}
self.focus();},hideInput:function(){var self=this;self.setTextboxValue('');self.$control_input.css({opacity:0,position:'absolute',left:self.rtl?10000:-10000});self.isInputHidden=true;},showInput:function(){this.$control_input.css({opacity:1,position:'relative',left:0});this.isInputHidden=false;},focus:function(){var self=this;if(self.isDisabled)return;self.ignoreFocus=true;self.$control_input[0].focus();window.setTimeout(function(){self.ignoreFocus=false;self.onFocus();},0);},blur:function(dest){this.$control_input[0].blur();this.onBlur(null,dest);},getScoreFunction:function(query){return this.sifter.getScoreFunction(query,this.getSearchOptions());},getSearchOptions:function(){var settings=this.settings;var sort=settings.sortField;if(typeof sort==='string'){sort=[{field:sort}];}
return{fields:settings.searchField,conjunction:settings.searchConjunction,sort:sort};},search:function(query){var i,value,score,result,calculateScore;var self=this;var settings=self.settings;var options=this.getSearchOptions();if(settings.score){calculateScore=self.settings.score.apply(this,[query]);if(typeof calculateScore!=='function'){throw new Error('Selectize "score" setting must be a function that returns a function');}}
if(query!==self.lastQuery){self.lastQuery=query;result=self.sifter.search(query,$.extend(options,{score:calculateScore}));self.currentResults=result;}else{result=$.extend(true,{},self.currentResults);}
if(settings.hideSelected){for(i=result.items.length-1;i>=0;i--){if(self.items.indexOf(hash_key(result.items[i].id))!==-1){result.items.splice(i,1);}}}
return result;},refreshOptions:function(triggerDropdown){var i,j,k,n,groups,groups_order,option,option_html,optgroup,optgroups,html,html_children,has_create_option;var $active,$active_before,$create;if(typeof triggerDropdown==='undefined'){triggerDropdown=true;}
var self=this;var query=$.trim(self.$control_input.val());var results=self.search(query);var $dropdown_content=self.$dropdown_content;var active_before=self.$activeOption&&hash_key(self.$activeOption.attr('data-value'));n=results.items.length;if(typeof self.settings.maxOptions==='number'){n=Math.min(n,self.settings.maxOptions);}
groups={};groups_order=[];for(i=0;i<n;i++){option=self.options[results.items[i].id];option_html=self.render('option',option);optgroup=option[self.settings.optgroupField]||'';optgroups=$.isArray(optgroup)?optgroup:[optgroup];for(j=0,k=optgroups&&optgroups.length;j<k;j++){optgroup=optgroups[j];if(!self.optgroups.hasOwnProperty(optgroup)){optgroup='';}
if(!groups.hasOwnProperty(optgroup)){groups[optgroup]=[];groups_order.push(optgroup);}
groups[optgroup].push(option_html);}}
if(this.settings.lockOptgroupOrder){groups_order.sort(function(a,b){var a_order=self.optgroups[a].$order||0;var b_order=self.optgroups[b].$order||0;return a_order-b_order;});}
html=[];for(i=0,n=groups_order.length;i<n;i++){optgroup=groups_order[i];if(self.optgroups.hasOwnProperty(optgroup)&&groups[optgroup].length){html_children=self.render('optgroup_header',self.optgroups[optgroup])||'';html_children+=groups[optgroup].join('');html.push(self.render('optgroup',$.extend({},self.optgroups[optgroup],{html:html_children})));}else{html.push(groups[optgroup].join(''));}}
$dropdown_content.html(html.join(''));if(self.settings.highlight&&results.query.length&&results.tokens.length){for(i=0,n=results.tokens.length;i<n;i++){highlight($dropdown_content,results.tokens[i].regex);}}
if(!self.settings.hideSelected){for(i=0,n=self.items.length;i<n;i++){self.getOption(self.items[i]).addClass('selected');}}
has_create_option=self.canCreate(query);if(has_create_option){$dropdown_content.prepend(self.render('option_create',{input:query}));$create=$($dropdown_content[0].childNodes[0]);}
self.hasOptions=results.items.length>0||has_create_option;if(self.hasOptions){if(results.items.length>0){$active_before=active_before&&self.getOption(active_before);if($active_before&&$active_before.length){$active=$active_before;}else if(self.settings.mode==='single'&&self.items.length){$active=self.getOption(self.items[0]);}
if(!$active||!$active.length){if($create&&!self.settings.addPrecedence){$active=self.getAdjacentOption($create,1);}else{$active=$dropdown_content.find('[data-selectable]:first');}}}else{$active=$create;}
self.setActiveOption($active);if(triggerDropdown&&!self.isOpen){self.open();}}else{self.setActiveOption(null);if(triggerDropdown&&self.isOpen){self.close();}}},addOption:function(data){var i,n,value,self=this;if($.isArray(data)){for(i=0,n=data.length;i<n;i++){self.addOption(data[i]);}
return;}
if(value=self.registerOption(data)){self.userOptions[value]=true;self.lastQuery=null;self.trigger('option_add',value,data);}},registerOption:function(data){var key=hash_key(data[this.settings.valueField]);if(!key||this.options.hasOwnProperty(key))return false;data.$order=data.$order||++this.order;this.options[key]=data;return key;},registerOptionGroup:function(data){var key=hash_key(data[this.settings.optgroupValueField]);if(!key)return false;data.$order=data.$order||++this.order;this.optgroups[key]=data;return key;},addOptionGroup:function(id,data){data[this.settings.optgroupValueField]=id;if(id=this.registerOptionGroup(data)){this.trigger('optgroup_add',id,data);}},removeOptionGroup:function(id){if(this.optgroups.hasOwnProperty(id)){delete this.optgroups[id];this.renderCache={};this.trigger('optgroup_remove',id);}},clearOptionGroups:function(){this.optgroups={};this.renderCache={};this.trigger('optgroup_clear');},updateOption:function(value,data){var self=this;var $item,$item_new;var value_new,index_item,cache_items,cache_options,order_old;value=hash_key(value);value_new=hash_key(data[self.settings.valueField]);if(value===null)return;if(!self.options.hasOwnProperty(value))return;if(typeof value_new!=='string')throw new Error('Value must be set in option data');order_old=self.options[value].$order;if(value_new!==value){delete self.options[value];index_item=self.items.indexOf(value);if(index_item!==-1){self.items.splice(index_item,1,value_new);}}
data.$order=data.$order||order_old;self.options[value_new]=data;cache_items=self.renderCache['item'];cache_options=self.renderCache['option'];if(cache_items){delete cache_items[value];delete cache_items[value_new];}
if(cache_options){delete cache_options[value];delete cache_options[value_new];}
if(self.items.indexOf(value_new)!==-1){$item=self.getItem(value);$item_new=$(self.render('item',data));if($item.hasClass('active'))$item_new.addClass('active');$item.replaceWith($item_new);}
self.lastQuery=null;if(self.isOpen){self.refreshOptions(false);}},removeOption:function(value,silent){var self=this;value=hash_key(value);var cache_items=self.renderCache['item'];var cache_options=self.renderCache['option'];if(cache_items)delete cache_items[value];if(cache_options)delete cache_options[value];delete self.userOptions[value];delete self.options[value];self.lastQuery=null;self.trigger('option_remove',value);self.removeItem(value,silent);},clearOptions:function(){var self=this;self.loadedSearches={};self.userOptions={};self.renderCache={};self.options=self.sifter.items={};self.lastQuery=null;self.trigger('option_clear');self.clear();},getOption:function(value){return this.getElementWithValue(value,this.$dropdown_content.find('[data-selectable]'));},getAdjacentOption:function($option,direction){var $options=this.$dropdown.find('[data-selectable]');var index=$options.index($option)+direction;return index>=0&&index<$options.length?$options.eq(index):$();},getElementWithValue:function(value,$els){value=hash_key(value);if(typeof value!=='undefined'&&value!==null){for(var i=0,n=$els.length;i<n;i++){if($els[i].getAttribute('data-value')===value){return $($els[i]);}}}
return $();},getItem:function(value){return this.getElementWithValue(value,this.$control.children());},addItems:function(values,silent){var items=$.isArray(values)?values:[values];for(var i=0,n=items.length;i<n;i++){this.isPending=(i<n-1);this.addItem(items[i],silent);}},addItem:function(value,silent){var events=silent?[]:['change'];debounce_events(this,events,function(){var $item,$option,$options;var self=this;var inputMode=self.settings.mode;var i,active,value_next,wasFull;value=hash_key(value);if(self.items.indexOf(value)!==-1){if(inputMode==='single')self.close();return;}
if(!self.options.hasOwnProperty(value))return;if(inputMode==='single')self.clear(silent);if(inputMode==='multi'&&self.isFull())return;$item=$(self.render('item',self.options[value]));wasFull=self.isFull();self.items.splice(self.caretPos,0,value);self.insertAtCaret($item);if(!self.isPending||(!wasFull&&self.isFull())){self.refreshState();}
if(self.isSetup){$options=self.$dropdown_content.find('[data-selectable]');if(!self.isPending){$option=self.getOption(value);value_next=self.getAdjacentOption($option,1).attr('data-value');self.refreshOptions(self.isFocused&&inputMode!=='single');if(value_next){self.setActiveOption(self.getOption(value_next));}}
if(!$options.length||self.isFull()){self.close();}else{self.positionDropdown();}
self.updatePlaceholder();self.trigger('item_add',value,$item);self.updateOriginalInput({silent:silent});}});},removeItem:function(value,silent){var self=this;var $item,i,idx;$item=(typeof value==='object')?value:self.getItem(value);value=hash_key($item.attr('data-value'));i=self.items.indexOf(value);if(i!==-1){$item.remove();if($item.hasClass('active')){idx=self.$activeItems.indexOf($item[0]);self.$activeItems.splice(idx,1);}
self.items.splice(i,1);self.lastQuery=null;if(!self.settings.persist&&self.userOptions.hasOwnProperty(value)){self.removeOption(value,silent);}
if(i<self.caretPos){self.setCaret(self.caretPos-1);}
self.refreshState();self.updatePlaceholder();self.updateOriginalInput({silent:silent});self.positionDropdown();self.trigger('item_remove',value,$item);}},createItem:function(input,triggerDropdown){var self=this;var caret=self.caretPos;input=input||$.trim(self.$control_input.val()||'');var callback=arguments[arguments.length-1];if(typeof callback!=='function')callback=function(){};if(typeof triggerDropdown!=='boolean'){triggerDropdown=true;}
if(!self.canCreate(input)){callback();return false;}
self.lock();var setup=(typeof self.settings.create==='function')?this.settings.create:function(input){var data={};data[self.settings.labelField]=input;data[self.settings.valueField]=input;return data;};var create=once(function(data){self.unlock();if(!data||typeof data!=='object')return callback();var value=hash_key(data[self.settings.valueField]);if(typeof value!=='string')return callback();self.setTextboxValue('');self.addOption(data);self.setCaret(caret);self.addItem(value);self.refreshOptions(triggerDropdown&&self.settings.mode!=='single');callback(data);});var output=setup.apply(this,[input,create]);if(typeof output!=='undefined'){create(output);}
return true;},refreshItems:function(){this.lastQuery=null;if(this.isSetup){this.addItem(this.items);}
this.refreshState();this.updateOriginalInput();},refreshState:function(){var invalid,self=this;if(self.isRequired){if(self.items.length)self.isInvalid=false;self.$control_input.prop('required',invalid);}
self.refreshClasses();},refreshClasses:function(){var self=this;var isFull=self.isFull();var isLocked=self.isLocked;self.$wrapper.toggleClass('rtl',self.rtl);self.$control.toggleClass('focus',self.isFocused).toggleClass('disabled',self.isDisabled).toggleClass('required',self.isRequired).toggleClass('invalid',self.isInvalid).toggleClass('locked',isLocked).toggleClass('full',isFull).toggleClass('not-full',!isFull).toggleClass('input-active',self.isFocused&&!self.isInputHidden).toggleClass('dropdown-active',self.isOpen).toggleClass('has-options',!$.isEmptyObject(self.options)).toggleClass('has-items',self.items.length>0);self.$control_input.data('grow',!isFull&&!isLocked);},isFull:function(){return this.settings.maxItems!==null&&this.items.length>=this.settings.maxItems;},updateOriginalInput:function(opts){var i,n,options,label,self=this;opts=opts||{};if(self.tagType===TAG_SELECT){options=[];for(i=0,n=self.items.length;i<n;i++){label=self.options[self.items[i]][self.settings.labelField]||'';options.push('<option value="'+escape_html(self.items[i])+'" selected="selected">'+escape_html(label)+'</option>');}
if(!options.length&&!this.$input.attr('multiple')){options.push('<option value="" selected="selected"></option>');}
self.$input.html(options.join(''));}else{self.$input.val(self.getValue());self.$input.attr('value',self.$input.val());}
if(self.isSetup){if(!opts.silent){self.trigger('change',self.$input.val());}}},updatePlaceholder:function(){if(!this.settings.placeholder)return;var $input=this.$control_input;if(this.items.length){$input.removeAttr('placeholder');}else{$input.attr('placeholder',this.settings.placeholder);}
$input.triggerHandler('update',{force:true});},open:function(){var self=this;if(self.isLocked||self.isOpen||(self.settings.mode==='multi'&&self.isFull()))return;self.focus();self.isOpen=true;self.refreshState();self.$dropdown.css({visibility:'hidden',display:'block'});self.positionDropdown();self.$dropdown.css({visibility:'visible'});self.trigger('dropdown_open',self.$dropdown);},close:function(){var self=this;var trigger=self.isOpen;if(self.settings.mode==='single'&&self.items.length){self.hideInput();}
self.isOpen=false;self.$dropdown.hide();self.setActiveOption(null);self.refreshState();if(trigger)self.trigger('dropdown_close',self.$dropdown);},positionDropdown:function(){var $control=this.$control;var offset=this.settings.dropdownParent==='body'?$control.offset():$control.position();offset.top+=$control.outerHeight(true);this.$dropdown.css({width:$control.outerWidth(),top:offset.top,left:offset.left});},clear:function(silent){var self=this;if(!self.items.length)return;self.$control.children(':not(input)').remove();self.items=[];self.lastQuery=null;self.setCaret(0);self.setActiveItem(null);self.updatePlaceholder();self.updateOriginalInput({silent:silent});self.refreshState();self.showInput();self.trigger('clear');},insertAtCaret:function($el){var caret=Math.min(this.caretPos,this.items.length);if(caret===0){this.$control.prepend($el);}else{$(this.$control[0].childNodes[caret]).before($el);}
this.setCaret(caret+1);},deleteSelection:function(e){var i,n,direction,selection,values,caret,option_select,$option_select,$tail;var self=this;direction=(e&&e.keyCode===KEY_BACKSPACE)?-1:1;selection=getSelection(self.$control_input[0]);if(self.$activeOption&&!self.settings.hideSelected){option_select=self.getAdjacentOption(self.$activeOption,-1).attr('data-value');}
values=[];if(self.$activeItems.length){$tail=self.$control.children('.active:'+(direction>0?'last':'first'));caret=self.$control.children(':not(input)').index($tail);if(direction>0){caret++;}
for(i=0,n=self.$activeItems.length;i<n;i++){values.push($(self.$activeItems[i]).attr('data-value'));}
if(e){e.preventDefault();e.stopPropagation();}}else if((self.isFocused||self.settings.mode==='single')&&self.items.length){if(direction<0&&selection.start===0&&selection.length===0){values.push(self.items[self.caretPos-1]);}else if(direction>0&&selection.start===self.$control_input.val().length){values.push(self.items[self.caretPos]);}}
if(!values.length||(typeof self.settings.onDelete==='function'&&self.settings.onDelete.apply(self,[values])===false)){return false;}
if(typeof caret!=='undefined'){self.setCaret(caret);}
while(values.length){self.removeItem(values.pop());}
self.showInput();self.positionDropdown();self.refreshOptions(true);if(option_select){$option_select=self.getOption(option_select);if($option_select.length){self.setActiveOption($option_select);}}
return true;},advanceSelection:function(direction,e){var tail,selection,idx,valueLength,cursorAtEdge,$tail;var self=this;if(direction===0)return;if(self.rtl)direction*=-1;tail=direction>0?'last':'first';selection=getSelection(self.$control_input[0]);if(self.isFocused&&!self.isInputHidden){valueLength=self.$control_input.val().length;cursorAtEdge=direction<0?selection.start===0&&selection.length===0:selection.start===valueLength;if(cursorAtEdge&&!valueLength){self.advanceCaret(direction,e);}}else{$tail=self.$control.children('.active:'+tail);if($tail.length){idx=self.$control.children(':not(input)').index($tail);self.setActiveItem(null);self.setCaret(direction>0?idx+1:idx);}}},advanceCaret:function(direction,e){var self=this,fn,$adj;if(direction===0)return;fn=direction>0?'next':'prev';if(self.isShiftDown){$adj=self.$control_input[fn]();if($adj.length){self.hideInput();self.setActiveItem($adj);e&&e.preventDefault();}}else{self.setCaret(self.caretPos+direction);}},setCaret:function(i){var self=this;if(self.settings.mode==='single'){i=self.items.length;}else{i=Math.max(0,Math.min(self.items.length,i));}
if(!self.isPending){var j,n,fn,$children,$child;$children=self.$control.children(':not(input)');for(j=0,n=$children.length;j<n;j++){$child=$($children[j]).detach();if(j<i){self.$control_input.before($child);}else{self.$control.append($child);}}}
self.caretPos=i;},lock:function(){this.close();this.isLocked=true;this.refreshState();},unlock:function(){this.isLocked=false;this.refreshState();},disable:function(){var self=this;self.$input.prop('disabled',true);self.$control_input.prop('disabled',true).prop('tabindex',-1);self.isDisabled=true;self.lock();},enable:function(){var self=this;self.$input.prop('disabled',false);self.$control_input.prop('disabled',false).prop('tabindex',self.tabIndex);self.isDisabled=false;self.unlock();},destroy:function(){var self=this;var eventNS=self.eventNS;var revertSettings=self.revertSettings;self.trigger('destroy');self.off();self.$wrapper.remove();self.$dropdown.remove();self.$input.html('').append(revertSettings.$children).removeAttr('tabindex').removeClass('selectized').attr({tabindex:revertSettings.tabindex}).show();self.$control_input.removeData('grow');self.$input.removeData('selectize');$(window).off(eventNS);$(document).off(eventNS);$(document.body).off(eventNS);delete self.$input[0].selectize;},render:function(templateName,data){var value,id,label;var html='';var cache=false;var self=this;var regex_tag=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;if(templateName==='option'||templateName==='item'){value=hash_key(data[self.settings.valueField]);cache=!!value;}
if(cache){if(!isset(self.renderCache[templateName])){self.renderCache[templateName]={};}
if(self.renderCache[templateName].hasOwnProperty(value)){return self.renderCache[templateName][value];}}
html=self.settings.render[templateName].apply(this,[data,escape_html]);if(templateName==='option'||templateName==='option_create'){html=html.replace(regex_tag,'<$1 data-selectable');}
if(templateName==='optgroup'){id=data[self.settings.optgroupValueField]||'';html=html.replace(regex_tag,'<$1 data-group="'+escape_replace(escape_html(id))+'"');}
if(templateName==='option'||templateName==='item'){html=html.replace(regex_tag,'<$1 data-value="'+escape_replace(escape_html(value||''))+'"');}
if(cache){self.renderCache[templateName][value]=html;}
return html;},clearCache:function(templateName){var self=this;if(typeof templateName==='undefined'){self.renderCache={};}else{delete self.renderCache[templateName];}},canCreate:function(input){var self=this;if(!self.settings.create)return false;var filter=self.settings.createFilter;return input.length&&(typeof filter!=='function'||filter.apply(self,[input]))&&(typeof filter!=='string'||new RegExp(filter).test(input))&&(!(filter instanceof RegExp)||filter.test(input));}});Selectize.count=0;Selectize.defaults={options:[],optgroups:[],plugins:[],delimiter:',',splitOn:null,persist:true,diacritics:true,create:false,createOnBlur:false,createFilter:null,highlight:true,openOnFocus:true,maxOptions:1000,maxItems:null,hideSelected:null,addPrecedence:false,selectOnTab:false,preload:false,allowEmptyOption:false,closeAfterSelect:false,scrollDuration:60,loadThrottle:300,loadingClass:'loading',dataAttr:'data-data',optgroupField:'optgroup',valueField:'value',labelField:'text',optgroupLabelField:'label',optgroupValueField:'value',lockOptgroupOrder:false,sortField:'$order',searchField:['text'],searchConjunction:'and',mode:null,wrapperClass:'selectize-control',inputClass:'selectize-input',dropdownClass:'selectize-dropdown',dropdownContentClass:'selectize-dropdown-content',dropdownParent:null,copyClassesToDropdown:true,render:{}};$.fn.selectize=function(settings_user){var defaults=$.fn.selectize.defaults;var settings=$.extend({},defaults,settings_user);var attr_data=settings.dataAttr;var field_label=settings.labelField;var field_value=settings.valueField;var field_optgroup=settings.optgroupField;var field_optgroup_label=settings.optgroupLabelField;var field_optgroup_value=settings.optgroupValueField;var init_textbox=function($input,settings_element){var i,n,values,option;var data_raw=$input.attr(attr_data);if(!data_raw){var value=$.trim($input.val()||'');if(!settings.allowEmptyOption&&!value.length)return;values=value.split(settings.delimiter);for(i=0,n=values.length;i<n;i++){option={};option[field_label]=values[i];option[field_value]=values[i];settings_element.options.push(option);}
settings_element.items=values;}else{settings_element.options=JSON.parse(data_raw);for(i=0,n=settings_element.options.length;i<n;i++){settings_element.items.push(settings_element.options[i][field_value]);}}};var init_select=function($input,settings_element){var i,n,tagName,$children,order=0;var options=settings_element.options;var optionsMap={};var readData=function($el){var data=attr_data&&$el.attr(attr_data);if(typeof data==='string'&&data.length){return JSON.parse(data);}
return null;};var addOption=function($option,group){$option=$($option);var value=hash_key($option.attr('value'));if(!value&&!settings.allowEmptyOption)return;if(optionsMap.hasOwnProperty(value)){if(group){var arr=optionsMap[value][field_optgroup];if(!arr){optionsMap[value][field_optgroup]=group;}else if(!$.isArray(arr)){optionsMap[value][field_optgroup]=[arr,group];}else{arr.push(group);}}
return;}
var option=readData($option)||{};option[field_label]=option[field_label]||$option.text();option[field_value]=option[field_value]||value;option[field_optgroup]=option[field_optgroup]||group;optionsMap[value]=option;options.push(option);if($option.is(':selected')){settings_element.items.push(value);}};var addGroup=function($optgroup){var i,n,id,optgroup,$options;$optgroup=$($optgroup);id=$optgroup.attr('label');if(id){optgroup=readData($optgroup)||{};optgroup[field_optgroup_label]=id;optgroup[field_optgroup_value]=id;settings_element.optgroups.push(optgroup);}
$options=$('option',$optgroup);for(i=0,n=$options.length;i<n;i++){addOption($options[i],id);}};settings_element.maxItems=$input.attr('multiple')?null:1;$children=$input.children();for(i=0,n=$children.length;i<n;i++){tagName=$children[i].tagName.toLowerCase();if(tagName==='optgroup'){addGroup($children[i]);}else if(tagName==='option'){addOption($children[i]);}}};return this.each(function(){if(this.selectize)return;var instance;var $input=$(this);var tag_name=this.tagName.toLowerCase();var placeholder=$input.attr('placeholder')||$input.attr('data-placeholder');if(!placeholder&&!settings.allowEmptyOption){placeholder=$input.children('option[value=""]').text();}
var settings_element={'placeholder':placeholder,'options':[],'optgroups':[],'items':[]};if(tag_name==='select'){init_select($input,settings_element);}else{init_textbox($input,settings_element);}
instance=new Selectize($input,$.extend(true,{},defaults,settings_element,settings_user));});};$.fn.selectize.defaults=Selectize.defaults;$.fn.selectize.support={validity:SUPPORTS_VALIDITY_API};Selectize.define('drag_drop',function(options){if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if(this.settings.mode!=='multi')return;var self=this;self.lock=(function(){var original=self.lock;return function(){var sortable=self.$control.data('sortable');if(sortable)sortable.disable();return original.apply(self,arguments);};})();self.unlock=(function(){var original=self.unlock;return function(){var sortable=self.$control.data('sortable');if(sortable)sortable.enable();return original.apply(self,arguments);};})();self.setup=(function(){var original=self.setup;return function(){original.apply(this,arguments);var $control=self.$control.sortable({items:'[data-value]',forcePlaceholderSize:true,disabled:self.isLocked,start:function(e,ui){ui.placeholder.css('width',ui.helper.css('width'));$control.css({overflow:'visible'});},stop:function(){$control.css({overflow:'hidden'});var active=self.$activeItems?self.$activeItems.slice():null;var values=[];$control.children('[data-value]').each(function(){values.push($(this).attr('data-value'));});self.setValue(values);self.setActiveItem(active);}});};})();});Selectize.define('dropdown_header',function(options){var self=this;options=$.extend({title:'Untitled',headerClass:'selectize-dropdown-header',titleRowClass:'selectize-dropdown-header-title',labelClass:'selectize-dropdown-header-label',closeClass:'selectize-dropdown-header-close',html:function(data){return('<div class="'+data.headerClass+'">'+'<div class="'+data.titleRowClass+'">'+'<span class="'+data.labelClass+'">'+data.title+'</span>'+'<a href="javascript:void(0)" class="'+data.closeClass+'">&times;</a>'+'</div>'+'</div>');}},options);self.setup=(function(){var original=self.setup;return function(){original.apply(self,arguments);self.$dropdown_header=$(options.html(options));self.$dropdown.prepend(self.$dropdown_header);};})();});Selectize.define('optgroup_columns',function(options){var self=this;options=$.extend({equalizeWidth:true,equalizeHeight:true},options);this.getAdjacentOption=function($option,direction){var $options=$option.closest('[data-group]').find('[data-selectable]');var index=$options.index($option)+direction;return index>=0&&index<$options.length?$options.eq(index):$();};this.onKeyDown=(function(){var original=self.onKeyDown;return function(e){var index,$option,$options,$optgroup;if(this.isOpen&&(e.keyCode===KEY_LEFT||e.keyCode===KEY_RIGHT)){self.ignoreHover=true;$optgroup=this.$activeOption.closest('[data-group]');index=$optgroup.find('[data-selectable]').index(this.$activeOption);if(e.keyCode===KEY_LEFT){$optgroup=$optgroup.prev('[data-group]');}else{$optgroup=$optgroup.next('[data-group]');}
$options=$optgroup.find('[data-selectable]');$option=$options.eq(Math.min($options.length-1,index));if($option.length){this.setActiveOption($option);}
return;}
return original.apply(this,arguments);};})();var getScrollbarWidth=function(){var div;var width=getScrollbarWidth.width;var doc=document;if(typeof width==='undefined'){div=doc.createElement('div');div.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>';div=div.firstChild;doc.body.appendChild(div);width=getScrollbarWidth.width=div.offsetWidth-div.clientWidth;doc.body.removeChild(div);}
return width;};var equalizeSizes=function(){var i,n,height_max,width,width_last,width_parent,$optgroups;$optgroups=$('[data-group]',self.$dropdown_content);n=$optgroups.length;if(!n||!self.$dropdown_content.width())return;if(options.equalizeHeight){height_max=0;for(i=0;i<n;i++){height_max=Math.max(height_max,$optgroups.eq(i).height());}
$optgroups.css({height:height_max});}
if(options.equalizeWidth){width_parent=self.$dropdown_content.innerWidth()-getScrollbarWidth();width=Math.round(width_parent / n);$optgroups.css({width:width});if(n>1){width_last=width_parent-width*(n-1);$optgroups.eq(n-1).css({width:width_last});}}};if(options.equalizeHeight||options.equalizeWidth){hook.after(this,'positionDropdown',equalizeSizes);hook.after(this,'refreshOptions',equalizeSizes);}});Selectize.define('remove_button',function(options){if(this.settings.mode==='single')return;options=$.extend({label:'&times;',title:'Remove',className:'remove',append:true},options);var self=this;var html='<a href="javascript:void(0)" class="'+options.className+'" tabindex="-1" title="'+escape_html(options.title)+'">'+options.label+'</a>';var append=function(html_container,html_element){var pos=html_container.search(/(<\/[^>]+>\s*)$/);return html_container.substring(0,pos)+html_element+html_container.substring(pos);};this.setup=(function(){var original=self.setup;return function(){if(options.append){var render_item=self.settings.render.item;self.settings.render.item=function(data){return append(render_item.apply(this,arguments),html);};}
original.apply(this,arguments);this.$control.on('click','.'+options.className,function(e){e.preventDefault();if(self.isLocked)return;var $item=$(e.currentTarget).parent();self.setActiveItem($item);if(self.deleteSelection()){self.setCaret(self.items.length);}});};})();});Selectize.define('restore_on_backspace',function(options){var self=this;options.text=options.text||function(option){return option[this.settings.labelField];};this.onKeyDown=(function(){var original=self.onKeyDown;return function(e){var index,option;if(e.keyCode===KEY_BACKSPACE&&this.$control_input.val()===''&&!this.$activeItems.length){index=this.caretPos-1;if(index>=0&&index<this.items.length){option=this.options[this.items[index]];if(this.deleteSelection(e)){this.setTextboxValue(options.text.apply(this,[option]));this.refreshOptions(true);}
e.preventDefault();return;}}
return original.apply(this,arguments);};})();});return Selectize;}));
bkt.mvc={urlparams:bkt.parseParams(),presentationSettings:bkt.loadSetting('presentationSettings'),guilang:bkt.getLanguage(),controller:bkt.getController(),skin:bkt.getSkin()};bkt.mvc.callbacks={};bkt.mvc.renderView=function(actions,parameters,options){var params=$.extend({actions:actions,pres:bkt.mvc.presentationSettings},parameters||{});var callbacks=bkt.mvc.callbacks;if(!actions){return;}
if(jQuery.isEmptyObject(params.pres)&&typeof bkt.mvc.urlparams.pres!=="undefined"){delete params.pres;}
if(!bkt.mvc.urlparams.coll&&!bkt.mvc.urlparams.skin&&!params.coll&&!params.skin){params.skin=bkt.mvc.skin;}
var requestParams=$.extend(bkt.mvc.urlparams,params);if(!params.sortfield){if(requestParams.sortfield){if(params.coll==='ngvn'){delete requestParams.sortfield;}else{params.sortfield=requestParams.sortfield;}}}
bkt.events.beforeMultiActionApiRequest.dispatch(requestParams,bkt.mvc.controller,bkt.mvc.guilang);bkt.fetch("/"+bkt.mvc.guilang+"/pres/"+bkt.mvc.controller+"/multi",{data:requestParams,success:function(response){if(!response){return;}
bkt.events.beforeMultiActionCallbacks.dispatch(actions);for(var action in response){$(".bkt-mvc-"+action).html(response[action]);if(callbacks[action]){callbacks[action]();bkt.events.afterMultiActionCallback.dispatch(action);}}
bkt.events.afterMultiActionCallbacks.dispatch(actions);},error:function(response){console.log("Error state in response: ",response);}});};bkt.mvc.renderPartial=function(action,options){var controller=options.controller||bkt.mvc.controller;if(options.coll){options.data.coll=options.coll;}
if(!options.data.coll&&!options.data.skin){options.data.skin=bkt.mvc.skin;}
bkt.fetch("/"+bkt.mvc.guilang+"/pres/"+controller+"/"+action,{data:options.data,success:function(html){$(".bkt-mvc-"+action+"Action").html(html);if(options.callback){options.callback();}},error:function(response){console.log("Error state in response: ",response);}});};bkt.mvc.proceedAfterBlackistNoticeConfirmation=function(){var confirmed=bkt.loadSetting("agreedtonotice");if($("#dblcheck").is(":checked")){$("body, html").css({height:"100%",overflow:"hidden"});confirmed[bkt.mvc.confirmPPN]=true;bkt.storeSetting('agreedtonotice',confirmed);bkt.mvc.viewer.blockedByNotice=false;bkt.mvc.renderView(bkt.mvc.actionsAfterConfirm);bkt.mvc.viewer.initialize();$(".view-content").removeClass("notice");$(".side-block").show();}};bkt.mvc.confirmPPN="";bkt.mvc.actionsAfterConfirm=[];bkt.mvc.renderViewOnConfirmationOfBlacklistedPPN=function(actions,ppn){var confirmed=bkt.loadSetting("agreedtonotice");bkt.mvc.confirmPPN=ppn;bkt.mvc.actionsAfterConfirm=actions;if(confirmed[ppn]){bkt.mvc.renderView(actions);}else{$("body, html").css({height:"auto",overflow:"auto"});bkt.mvc.viewer.blockedByNotice=true;$(".side-block").hide();$(".view-content").addClass("notice");$(".view-tabs a").each(function(i,tab){var href=$(tab).attr("href");$(tab).addClass("header__form__input-text-search--disabled").removeAttr("href").attr("disabled-href",href);});bkt.fetch("/nl/kranten/view/blacklistnotice",{data:bkt.mvc.urlparams,success:function(html){$(".bkt-mvc-imageAction").html(html);$('.bkt-mvc-imageAction input[type="checkbox"]').on('click',function(e){if($(this).is(":checked")){$(".bkt-mvc-imageAction a.next").addClass("confirmed");}else{$(".bkt-mvc-imageAction a.next").removeClass("confirmed");}});}});}};bkt.mvc.toggleMenu=function(el,menu){if(!menu.is(":visible")){bkt.mvc.showMenu(el,menu);}else{bkt.mvc.hideMenu(el,menu);}};bkt.mvc.showMenu=function(el,menu){$(".storables-notice").hide();$(el).addClass("active");$(".storables-context-menu-link").parent("span").removeClass("opened");$(el).parent("span").addClass("opened");menu.show().removeAntiClick().onAntiClick(function(){bkt.mvc.hideMenu(el,menu);},{excludedElements:[el]});};bkt.mvc.hideMenu=function(el,menu){$(el).removeClass("active");$(el).parent("span").removeClass("opened");menu.hide();};bkt.mvc.restoreSearchBoxOnIEBackNavigation=function(){$(".basic-query").prop('disabled',false).removeClass("header__form__input-text-search--disabled").attr("placeholder",$(".basic-query").attr("data-placeholder"));$(".indicator-load").hide();};bkt.mvc.greyOutSearchBoxOnTabNavigation=function(){var placeholder=$(".basic-query").attr("placeholder");$(".basic-query").prop('disabled',true).addClass("header__form__input-text-search--disabled").attr("placeholder","").attr("data-placeholder",placeholder).val("");$(".indicator-load").show();};
bkt.mvc.callbacks.onAdvancedSearchAddRemoveClick=function(el){function appendRemoveButton(clone,field,nameIndex){var removeButton=$("<button>").attr("name","removefield["+field+"]").attr("value",nameIndex).addClass("remove-button header__form__button-remove icon button-icon icon--zz003-min").attr("data-testing-id","advanced-search__form__button__"+field+"--remove").attr("title",bkt.i18n.lookup("remove_field",{controller:"advancedsearch"})).attr("type","button").on("click",function(){removeField(this);});clone.append(removeButton);}
function addField(){var prev=$(el).parent("div").prev("div");var field=$(el).parents(".field").attr("data-name");var clone=prev.clone();var nameIndex=parseInt(clone.find("input").attr("name").replace(/^.*([0-9]+).*/,'$1'))+1;var newSelectName="search["+field+"][operator]["+nameIndex+"]";var newInputName="search["+field+"][value]["+nameIndex+"]";clone.find("select").attr("name",newSelectName);clone.find("input").attr("name",newInputName).val("");clone.find("option").prop("selected",false);if(clone.find("button").length>0){clone.find("button").attr("value",nameIndex).on("click",function(){removeField(this);});}else{appendRemoveButton(clone,field,nameIndex);}
prev.after(clone);}
function removeField(elem){var _self=elem||this;var field=$(_self).parents(".field").attr("data-name");var startIndex=parseInt($(_self).attr("value"));var endIndex=parseInt($("button[name='addfield["+field+"]']").parent("div").prev("div").find("button").attr("value"));if(isNaN(endIndex)||endIndex<startIndex){return;}
for(var i=startIndex;i<=endIndex;i++){var select=$(_self).parents(".field").find("select[name='search["+field+"][operator]["+i+"]']");var input=$(_self).parents(".field").find("input[name='search["+field+"][value]["+i+"]']");var removeButton=$(_self).parents(".field").find("button[name='removefield["+field+"]']");select.attr("name","search["+field+"][operator]["+(i-1)+"]");input.attr("name","search["+field+"][value]["+(i-1)+"]");removeButton.attr("value",i-1);}
$(_self).parent("div").remove();}
if($(el).attr("name").match(/^addfield/)){addField();}else{removeField(el);}};bkt.mvc.callbacks.onAdvancedSearchButtonClick=function(){var postdata={};if($(this).attr("name")&&$(this).attr("name").match(/^addfield\[|removefield\[/)){bkt.mvc.callbacks.onAdvancedSearchAddRemoveClick(this);return false;}
if($(this).hasClass("expand-collapse")){bkt.mvc.lexicon.show=false;}
$(".bkt-mvc-advancedsearchAction").find("input, select").each(function(i,input){if($(input).attr("type")!=="submit"){if($(input).attr("type")==="checkbox"){if($(input).is(":checked")){postdata[$(input).attr("name")]=postdata[$(input).attr("name")]||[];postdata[$(input).attr("name")].push($(input).val());}}else{postdata[$(input).attr("name")]=$(input).val();}}});postdata[$(this).attr("name")]=$(this).attr("value");$.ajax("/"+bkt.mvc.guilang+"/pres/search/advancedsearch?skin="+bkt.getSkin(),{type:"POST",data:postdata,success:function(html){$(".bkt-mvc-advancedsearchAction").html(html);bkt.mvc.callbacks.advancedsearchAction();}});return false;};bkt.mvc.callbacks.advancedsearchAction=function(){var _fetchingCheckboxes=false;if(bkt.mvc.urlparams.coll==="dddtitel"||bkt.mvc.urlparams.coll==="ddd"||bkt.mvc.urlparams.coll==="anp"||bkt.mvc.urlparams.coll==="regio"){_addCalendar();}
var fieldType=$("form > div.cc12 > div.field.text").attr('data-name');var advInput='input[name="search['+fieldType+'][value][0]"]';$(advInput).keyup(function(){bkt.mvc.storeSetting('query',this.value);});$("#js-close-advanced-search").click(function(){var value=$('.advanced-search-form-input-text');var input=$('.simple-search-form-input-text');input.val(value.val());bkt.mvc.addResizeForPlaceholder(false);});$(".bkt-mvc-advancedsearchAction .clear-all").on("click",function(e){bkt.mvc.lexicon.show=false;bkt.mvc.lexicon.variants={};delete(bkt.mvc.urlparams.cql);delete(bkt.mvc.urlparams.facets);delete(bkt.mvc.urlparams.query);bkt.deleteSetting('query');$('.advanced-search-form-input-text').attr('value','');$(".simple-search form input[name='query']").attr('value','');bkt.mvc.slideAdvancedSearch(bkt.mvc.urlparams.coll);var listDiv=$(".field[data-name='content']").find(".header__form__inl-variants-list-wrapper");listDiv.html("");var inputDiv=$(".field[data-name='content']").find(".header__form__input-text-search");inputDiv.val("");var inputDiv=$(".simple-search").find(".header__form__input-text-search");inputDiv.val("");e.preventDefault();$("html, body").animate({scrollTop:0},0);return false;});$(".bkt-mvc-advancedsearchAction label.expand-collapse").add(".js-add-button").on("click",bkt.mvc.callbacks.onAdvancedSearchButtonClick);$('.remove-button').on("click",bkt.mvc.callbacks.onAdvancedSearchButtonClick);function _isValidDate(s){var $valueStart=$(".date-input--start").attr("value").split("-");var startValue=new Date($valueStart[2],$valueStart[1]-1,$valueStart[0]);var $valueEnd=$(".date-input--end").attr("value").split("-");var endValue=new Date($valueEnd[2],$valueEnd[1]-1,$valueEnd[0]);var bits=s.split('-');var d=new Date(bits[2]+'-'+bits[1]+'-'+bits[0]);if(d>=startValue&&d<=endValue){return!!(d&&(d.getMonth()+1)==bits[1]&&d.getDate()==Number(bits[0]));}}
function _addCalendar(){var $inputFieldStart=$(".date-input--start");var $calendarFieldStart=$(".date-icon--start");var $inputFieldEnd=$(".date-input--end");var $calendarFieldEnd=$(".date-icon--end");$calendarFieldStart.on("click",function(){if(_isValidDate($inputFieldStart.val().toString())){}else{$inputFieldStart.val($inputFieldStart.attr("value"));}});$calendarFieldEnd.on("click",function(){if(_isValidDate($inputFieldEnd.val().toString())){}else{$inputFieldEnd.val($inputFieldEnd.attr("value"));}});bkt.mvc.calendar();}
function checkWidth(){if((!bkt.mvc.settings.get("spellingVariants")||bkt.mvc.settings.get("spellingVariants")==="on")&&$(window).width()>664&&bkt.mvc.lexicon.show===false){bkt.mvc.lexicon.init();}
if($(window).width()<665&&bkt.mvc.lexicon.show===true){bkt.mvc.lexicon.removeInl();}}
checkWidth();$(window).resize(checkWidth);$(".field.checkbox, .field.apilist .header__form__checkbox-list-unchecked-wrapper").on("click",function(){var fieldDiv=$(this).parents(".field");var count=fieldDiv.find("input[class=header__form__input-checkbox-inputfield]:checked").length;if(count>0){fieldDiv.find(".icon--header__form__section__label").addClass("remove-icon");}});$(".field.checkbox, .field.apilist .header__form__checkbox-list-checked-wrapper").on("click",function(){var fieldDiv=$(this).parents(".field");var count=fieldDiv.find("input[class=header__form__input-checkbox-inputfield]:checked").length;if(count>0){fieldDiv.find(".icon--header__form__section__label").removeClass("remove-icon");}});$(".field.checkbox input[type=checkbox]").on("click",function(){var fieldDiv=$(this).parents(".field");var count=fieldDiv.find("input[class=header__form__input-checkbox-inputfield]:checked").length;if(count>0){fieldDiv.find(".icon--header__form__section__label").addClass("remove-icon");fieldDiv.find(".icon--header__form__section__label").removeAttr("name");}else{fieldDiv.find(".icon--header__form__section__label").removeClass("remove-icon");fieldDiv.find(".icon--header__form__section__label").attr("name","field_collapse");}});$(".field.simple input[type=text], .field.text input[type=text]").on("keyup",function(){var fieldDiv=$(this).parents(".field");if(fieldDiv.find("div > .header__form__input-text").filter(function(){fieldDiv.find(".icon--header__form__section__label").removeClass("remove-icon");fieldDiv.find(".icon--header__form__section__label").attr("name","field_collapse");return $(this).val().trim()!=="";}).length!==0){fieldDiv.find(".icon--header__form__section__label").addClass("remove-icon");fieldDiv.find(".icon--header__form__section__label").removeAttr("name");}});$(".js-header__form__section").each(function(i,div){var fieldDiv=$(div);if(fieldDiv.find(".header__form__input-checkbox-inputfield:checked").length>0){fieldDiv.find(".icon--header__form__section__label").addClass("remove-icon");}else if(fieldDiv.find("div > .header__form__input-text").filter(function(){return $(this).val().trim()!=="";}).length>0){fieldDiv.find(".icon--header__form__section__label").addClass("remove-icon");}else{fieldDiv.find(".icon--header__form__section__label").removeClass("remove-icon");}});function observeCheckboxes(fieldDiv){var checkedList=fieldDiv.find(".list.checked");fieldDiv.find("input[type=checkbox]").off("click").on("click",function(){if(checkedList.length>0){var count=fieldDiv.find("input:checked").length;if(count<11){fieldDiv.find(".header__form__checkbox-list-selected-text-count").html(count);}else{fieldDiv.find(".header__form__checkbox-list-selected-text-count").html(10);}
if(count===0){fieldDiv.find(".selected-checkboxes").hide();fieldDiv.find("button.expand-collapse").show();}else if(count>10){fieldDiv.find(".unchecked .header__form__input-checkbox-inputfield:checked").prop("checked",false);fieldDiv.find(".selected-checkboxes").show();return;}else if(count>9){fieldDiv.find(".header__form__checkbox-list-selected-text-max").show();fieldDiv.find(".header__form__checkbox-list-selected-text-count").hide();fieldDiv.find(".header__form__checkbox-list-selected-text-selected").hide();}else{fieldDiv.find(".selected-checkboxes").show();fieldDiv.find(".header__form__checkbox-list-selected-text-count").show();fieldDiv.find(".header__form__checkbox-list-selected-text-selected").show();fieldDiv.find("button.expand-collapse").hide();fieldDiv.find(".header__form__checkbox-list-selected-text-max").hide();}
var myDiv=$(this).parents()[0];if($(this).is(":checked")){checkedList.append($(myDiv).clone());}else{$(myDiv).remove();}
fetchCheckboxes(fieldDiv);}});}
function fetchCheckboxes(fieldDiv,p){var params=p||{};var listDiv=fieldDiv.find(".list.unchecked");var lastTopId=storeOffset(listDiv);delete(params.callback);params.optstart=(typeof params.optstart==='undefined'?parseInt(listDiv.attr("data-optstart")):params.optstart);params.optmax=params.optmax||75;params.filter=params.filter||fieldDiv.find(".filter input").val()||"";params.field=fieldDiv.attr("data-name");params.skin=bkt.getSkin();params.values=$.makeArray(fieldDiv.find("input:checked").map(function(i,el){return el.value;}));params.scrollToTop=params.scrollToTop||false;_fetchingCheckboxes=true;bkt.fetch("/"+bkt.mvc.guilang+"/pres/search/fetchcheckboxes",{data:params,success:function(html){_fetchingCheckboxes=false;listDiv.html(html);observeCheckboxes(fieldDiv);listDiv.attr("data-optstart",params.optstart);if(params.scrollToTop){$(listDiv).scrollTop(0);}else{scrollToStoredOffset(lastTopId,listDiv);}}});}
function scrollToStoredOffset(toId,div){var elem=document.getElementById(toId);if(elem){var storedOffset=$($(elem).parents("div")[0]).offset().top;$(div).scrollTop(($(div).scrollTop()-$(div).offset().top)+storedOffset);}}
function storeOffset(div){var id="";var divs=$.makeArray($(div).find("div"));for(var i in divs){var top=$(div).offset().top;if(top-$(divs[i]).offset().top<0&&$(divs[i]).find("input").length>0){id=$(divs[i]).find("input").attr("id");break;}}
return id;}
$(".bkt-mvc-advancedsearchAction .list.unchecked").each(function(i,listDiv){observeCheckboxes($(listDiv).parents("div.field"));$(listDiv).attr("data-optstart","0");$(listDiv).on("scroll",function(e){if(_fetchingCheckboxes){return;}
var progressBufferBottom=$(this).find(".progress-buffer.bottom");var progressBufferTop=$(this).find(".progress-buffer.top");if(progressBufferBottom.length>0&&($(this).offset().top+$(this).height()-progressBufferBottom.offset().top>0)){fetchCheckboxes($(listDiv).parents("div.field"),{optstart:parseInt($(listDiv).attr("data-optstart"))+50});}
if(progressBufferTop.length>0&&($(this).offset().top-(progressBufferTop.height()+progressBufferTop.offset().top)<0)){fetchCheckboxes($(listDiv).parents("div.field"),{optstart:parseInt($(listDiv).attr("data-optstart"))-50});}});});$(".bkt-mvc-advancedsearchAction .filter input").on("keyup",function(){fetchCheckboxes($(this).parents("div.field"),{scrollToTop:true});});var $btnGoToNgram=$("#js-btnGoToNgram-advanced");var $advancedSearchInputfield=$("#js-advanced-search-inputfield");function toggleNgramButton(active){if($btnGoToNgram&&$btnGoToNgram.length>0){if(active){$btnGoToNgram[0].disabled=false;$btnGoToNgram.removeClass("header__form__button-submit--disabled");}else{$btnGoToNgram[0].disabled=true;$btnGoToNgram.addClass("header__form__button-submit--disabled");}}}
var $btnGoToNgramMobile=$("#js-btnGoToNgram-advanced--mobile");var $advancedSearchInputfield=$("#js-advanced-search-inputfield");function toggleNgramButtonMobile(active){if($btnGoToNgramMobile&&$btnGoToNgramMobile.length>0){if(active){$btnGoToNgramMobile[0].disabled=false;$btnGoToNgramMobile.removeClass("header__form__button-submit--mobile--disabled");}else{$btnGoToNgramMobile[0].disabled=true;$btnGoToNgramMobile.addClass("header__form__button-submit--mobile--disabled");}}}
toggleNgramButton($advancedSearchInputfield.val()!=="");toggleNgramButtonMobile($advancedSearchInputfield.val()!=="");$advancedSearchInputfield.keyup(function(){toggleNgramButton(this.value!=="");toggleNgramButtonMobile(this.value!=="");});bkt.events.afterAdvancedsearchAction.dispatch("advancedsearchAction");};
bkt.mvc.callbacks.breadcrumbsAction=function(){$(".bkt-mvc-breadcrumbsAction a[data-field='ppn']").each(function(idx,el){var matches=$(el).html().trim().match(/[0-9X]{9}/g);for(var i in matches){var ppn=matches[i];bkt.fetch("/"+bkt.getLanguage()+"/api/dddtitle",{data:{ppn:ppn,fields:"title"},success:function(data){if(data.length>0&&data[0].title){$(el).html($(el).html().replace(data[0].ppn,data[0].title));$(el).attr("title",$(el).attr("title").replace(data[0].ppn,data[0].title));}}});}});$(".bkt-mvc-breadcrumbsAction a").on("click",function(){var coll=bkt.mvc.urlparams.coll;var storedFacetFilters=bkt.loadSetting("stored-facet-filters");delete(storedFacetFilters[coll]);bkt.storeSetting("stored-facet-filters",storedFacetFilters);});};
var eSources={'DBP':'DBpedia','VIAF':'VIAF','FB':'Freebase','GEO':'Geonames','Unknown':'onbekende bronnaam'};bkt.mvc.callbacks.enrichmentAction=function(){var baseUrl='/nl/api/enrichment?id=';var ids=$("table.searchresults tr");$("#flash").hide();$(ids).each(function(k,v)
{$.ajax(baseUrl+$(v).attr('data-identifier'),{success:function(data){var arr=JSON.parse(data);if(arr.length>0)
{var names={};var text='<u><b>Verrijking gevonden voor dit object:</b></u><p/>';for(var i in arr)
{var link='';if(arr[i].linkType==='NIR')
{if(typeof names[arr[i].name]==='undefined'&&typeof arr[i].relation!=='undefined')
{link='<a onclick="javascript:bkt.mvc.callbacks.getResources(\''+arr[i].relation+'\',\''+arr[i].name+'\');">Bronnen met informatie over <b>'+arr[i].name+'</b></a>';names[arr[i].name]="true";}}else
{if(typeof arr[i].hasVideo!=='undefined')
{link='<a onclick="javascript:bkt.mvc.callbacks.showVideo(\''+arr[i].hasVideo+'\',\''+arr[i].name+'\');">Link naar video </a>';}else
{link='<a href="'+arr[i].relation+'">Link naar <b>'+eSources[arr[i].linkType]+'</b></a>';}}
text+=link+'<br/>';}
var t=$(v).find(".tools");var td=$('<td class="greenlight">').addClass("tools").append('<img style="padding-left: 20px; margin-right: 0px; " src="/images/green-light1.png" />');$(td).click(function(){bkt.dialogs.informationBox(text,{title:'',width:"18%",height:"auto",left:(parseInt($(".greenlight").offset().left)*0.8)+'px',top:$(v).offset().top+'px',showClose:true});});$(t).append(td);}}});});};bkt.mvc.callbacks.getResources=function(link,about){$.ajax(link,{success:function(data)
{var links=data.links;var flinks={};for(var i in links)
{flinks[links[i].sameAs]=eSources[links[i].linkType];}
var text='';for(var i1 in flinks)
{text+='<a href="'+i1+'">Link naar '+flinks[i1]+'</a><br/>';}
bkt.dialogs.informationBox(text,{title:about,width:"15%",height:"auto",left:(parseInt($("#flash").offset().left)*0.8)+'px',top:$("#flash").offset().top+'px',showClose:true});}});};bkt.mvc.callbacks.showVideo=function(link){var text='<video id="video" controls="true"  autoplay="true" width="320" height="240" type="video/ogg" src="'+link+'"></video>';bkt.dialogs.informationBox(text,{title:'Video',width:"24%",height:"auto",left:(parseInt($("#flash").offset().left)*0.8)+'px',top:$("#flash").offset().top+'px',showClose:true,onClose:function(){$("#video").remove();}});};
bkt.mvc.callbacks.facetsAction=function(){var currentFacets=[];var maxDelay=0;var currentDelay=maxDelay;var submitting=false;var currentSortfield=false;$(".bkt-mvc-facetsAction label").each(function(i,label){var params=bkt.deparam($(label).find("a").attr("href"));$(label).html(($(label).find("a").html()));if(params.sortfield){currentSortfield=params.sortfield;}});$(".bkt-mvc-facetsAction input:checked").each(function(){toggleFacet(this);});if($(".bkt-mvc-facetsAction").children().length>=1){$("#js-recentadditions-box").css("display","block");};$(".bkt-mvc-facetsAction input").on("click",function(){toggleFacet(this);currentDelay=maxDelay;if(!submitting){postponedSubmit();submitting=true;}});$(".bkt-mvc-facetsAction .facet-list > a").on("click",bkt.mvc.callbacks.startFilterAction);$(".js-index-recordbatch").off("click").on("click",function(){doSubmit();});function doSubmit(){var newParams=bkt.parseParams();newParams.facets={};newParams.page=1;for(var i in currentFacets){newParams.facets[currentFacets[i].name]=newParams.facets[currentFacets[i].name]||[];newParams.facets[currentFacets[i].name].push(currentFacets[i].value);}
if(currentSortfield){newParams.sortfield=currentSortfield;}
var step=12;if(bkt.mvc.urlparams.coll&&(bkt.mvc.urlparams.coll==='ddd')){step=2;}
bkt.mvc.progress.fake(".progress",".progress .percentage",step);setProjectCodesCQL();if(bkt.mvc.urlparams.cql){newParams.cql=bkt.mvc.urlparams.cql.slice();}else{delete newParams.cql;}
bkt.mvc.renderView(['paginate','results','resultsCount','facets','breadcrumbs','sortlinks'],newParams);}
function postponedSubmit(){currentDelay-=10;if(currentDelay<=0){doSubmit();}else{setTimeout(postponedSubmit,10);}}
function toggleFacet(el){if(el.checked){currentFacets.push({name:$(el).attr("name"),value:$(el).val()});if($(el).attr("value").match(/^[1-9]\|/)){uncheckParentFacet(el);}}else{for(var i in currentFacets){if(currentFacets[i].name===$(el).attr("name")&&currentFacets[i].value===$(el).val()){currentFacets.splice(i,1);}}}}
function uncheckParentFacet(child){var name=$(child).attr("name");var depth=parseInt($(child).attr("value").replace(/\|.*$/,""))-1;$("input[name="+name+"]:checked").each(function(i,el){var curDepth=parseInt($(el).attr("value").replace(/\|.*$/,""));if(curDepth===depth){$(el).attr("checked",false);toggleFacet(el);}});}
function setProjectCodesCQL(){var activeProjectcodes;var conditionals;var cql;activeProjectcodes=[];$(".js-index-recordbatch:checked").each(function(){activeProjectcodes=activeProjectcodes.concat(this.value.split(","));});conditionals=activeProjectcodes.map(function(projectcode){return"projectcode any "+projectcode;});cql=(conditionals.length>0)?"("+conditionals.join(" OR ")+")":null;if(bkt.mvc.urlparams.cql){for(var i=bkt.mvc.urlparams.cql.length-1;i>=0;i--)
{if(bkt.mvc.urlparams.cql[i].indexOf("projectcode")>-1){bkt.mvc.urlparams.cql.splice(i,1);}}
if(cql){bkt.mvc.urlparams.cql.push(cql);}
if(bkt.mvc.urlparams.cql.length===0){delete bkt.mvc.urlparams.cql;}}else if(cql){bkt.mvc.urlparams.cql=[cql];}}};
bkt.mvc.callbacks.hideFilterLightBox=function(){$(".filter-lightbox").fadeOut({complete:function(){$("body").css("overflow-y","auto");$(".filter-lightbox > a.cancel").show();}});$(".overlay__backdrop").hide().off("click");bkt.inFilterBox=false;};bkt.mvc.callbacks.startFilterAction=function(){var filterParams,href;bkt.inFilterBox=true;if($(this).is("[href]")){href=$(this).attr("href");filterParams=bkt.deparam(href.replace(/.+\?/,""));$(this).removeAttr("href").attr("data-href",href);}else{href=$(this).attr("data-href");filterParams=bkt.deparam(href.replace(/.+\?/,""));}
$(".bkt-mvc-filterAction").hide();$(".filter-lightbox .pending").show();$(".overlay__backdrop").show();$(".filter-lightbox").fadeIn();$("body").css("overflow-y","hidden");bkt.mvc.progress.fake(".filter-lightbox .progress",".filter-lightbox .progress .percentage",5);bkt.mvc.renderPartial("filter",{data:filterParams,callback:bkt.mvc.callbacks.filterAction});};bkt.mvc.callbacks.filterAction=function(){var indexLinkParams={};$(".bkt-mvc-filterAction").show();$(".filter-lightbox > a.cancel").hide();$(".filter-lightbox .pending").hide();$(".overlay__backdrop, .filter-lightbox a.cancel, a.close-link").attr("href","#").on("click",function(){bkt.mvc.callbacks.hideFilterLightBox();});$(".bkt-mvc-filterAction .filter-index li").each(function(idx,li){var filterName="";var indexLink=$(li).find("a");var filterParams=bkt.deparam(indexLink.attr("href").replace(/.+\?/,""));var cls=$(li).attr("class").split(/\s+/);for(var i in cls){if(cls[i].length>0&&cls[i]!=="selected"){filterName=cls[i];break;}}
indexLinkParams[filterName]=indexLinkParams[filterName]||{};indexLinkParams[filterName]=filterParams;indexLink.attr("href","#").on("click",function(){$(".bkt-mvc-filterAction").hide();$(".filter-lightbox .pending").show();bkt.mvc.progress.fake(".filter-lightbox .progress",".filter-lightbox .progress .percentage",5);$(".filter-lightbox > a.cancel").show();bkt.mvc.renderPartial("filter",{data:indexLinkParams[filterName],callback:bkt.mvc.callbacks.filterAction});});});var facetName=$(".bkt-mvc-filterAction form input[type=checkbox]").attr("name").replace("facets[","").replace("][]","");function updateCounters(){var count=0;if(indexLinkParams[facetName]&&indexLinkParams[facetName].selected&&indexLinkParams[facetName].selected[facetName]){count=indexLinkParams[facetName].selected[facetName].length;}
if(count>0){$(".bkt-mvc-filterAction ."+facetName+" .selected-count .selected-label").getTranslation("selected",{controller:"results"});$(".bkt-mvc-filterAction ."+facetName+" .selected-count .number").html(count);}else{$(".bkt-mvc-filterAction ."+facetName+" .selected-count .number").html("");$(".bkt-mvc-filterAction ."+facetName+" .selected-count .selected-label").html("");}}
$(".bkt-mvc-filterAction form input").on("click",function(){var selected=$.makeArray($(".bkt-mvc-filterAction input:checked").map(function(i,checkbox){return $(this).val();}));if(!indexLinkParams[facetName].selected){indexLinkParams[facetName].selected={};indexLinkParams[facetName].selected[facetName]=selected;}
for(var x in indexLinkParams){for(var sel in indexLinkParams[x].selected){if(sel===facetName){indexLinkParams[x].selected[sel]=selected;}}
for(var fac in indexLinkParams[x].facets){if(fac===facetName){indexLinkParams[x].facets[fac]=selected;}}
if(!indexLinkParams[x].facets[facetName]){indexLinkParams[x].facets[facetName]=selected;}}
updateCounters();});function addExpandObserver(expandLink,filterValue){expandLink.on("click",function(){bkt.fetch("/"+bkt.getLanguage()+"/pres/results/prefixedfilter",{data:$.extend(bkt.mvc.urlparams,{selected:bkt.mvc.urlparams.facets,facets:{'periode':[filterValue]}}),success:function(html){$($(expandLink).parents("div")[0]).append(html);$(expandLink).addClass("collapse").off("click").on("click",function(){var sublist=$(this).siblings("div");if(sublist.is(":visible")){sublist.hide();$(this).removeClass("collapse");}else{sublist.show();$(this).addClass("collapse");}});$(expandLink).siblings("div").find("div").each(function(i,el){addExpandObserver($(el).find("a.expand"),$(el).find("input[type=checkbox]").val());});}});});}
if(facetName==='periode'){$(".bkt-mvc-filterAction form input[type=checkbox]").each(function(i,el){var expandLink=$("<a>").addClass("expand facets-overlay__form__input-checkbox-toggle icon button-icon icon--chevron-down").attr("data-testing-id","filter-lightbox__filter-lists__item--expand");addExpandObserver(expandLink,$(el).val());$(el).before(expandLink);});return;}
if($(".bkt-mvc-filterAction form input[type=checkbox]").length>10){var filterSpec=bkt.mvc.filterizeCheckboxes($(".bkt-mvc-filterAction form input[type=checkbox]"),$(".bkt-mvc-filterAction .filter-lists"),bkt.i18n.lookup("named_contains",{controller:"results","$1":$(".filter-index .selected a").html().trim()}));var listContainer=$(".bkt-mvc-filterAction form .list");var picklist=bkt.mvc.listifyCheckboxes(filterSpec.filterValues,filterSpec.input,listContainer);$(picklist).after($("<div>").addClass(facetName).append($("<div>").addClass("selected-count facets-overlay__count-selected").append($("<span>").addClass("selected-label")).append("&nbsp;").append($("<span>").addClass("number"))));updateCounters();}};
bkt.mvc.callbacks.paginateAction=function(){var lastPage=parseInt($(".bkt-mvc-paginateAction a.page-number").last().html());var step=12;if(bkt.mvc.urlparams.coll&&(bkt.mvc.urlparams.coll==='ddd')){step=2;}
$(".bkt-mvc-paginateAction a").each(function(i,el){var params=bkt.deparam($(el).attr("href"));$(el).removeAttr("href").on("click",function(){bkt.mvc.progress.fake(".progress",".progress .percentage",step);bkt.mvc.renderView(['paginate','results','resultsCount'],params);});if($(el).parents(".search-results__pagination-wrapper--bottom").length>0){$(el).on("click",function(){$(window).scrollTop(0);});}});$(function(){$('.selectize-max-per-page').selectize({hideSelected:true});$('.selectize-max-per-page + .selectize-control .selectize-input input').attr('readonly',true);$('.selectize-max-per-page + .selectize-control .selectize-input input, .selectize-max-per-page + .selectize-control .selectize-input').css('cursor','pointer');$('.selectize-max-per-page + .selectize-control .selectize-input input').on('focus',function(){$(this).trigger('blur');});});$(".bkt-mvc-paginateAction .maxperpage-setter input[type=submit]").hide();$(".bkt-mvc-paginateAction .maxperpage-setter select").on("change",function(){bkt.mvc.progress.fake(".progress",".progress .percentage",step);bkt.mvc.renderView(['paginate','results','facets','breadcrumbs','sortlinks','resultsCount'],{maxperpage:$(this).val(),page:1});bkt.mvc.urlparams.maxperpage=$(this).val();bkt.mvc.recordHistory=1;bkt.setHistoryState(bkt.mvc.urlparams);return false;});$("input[type=number].search-results__pagination__input-search").click(function(){$(this).select();$(".search-results__pagination .button").hide();$(".search-results__pagination .search-results__pagination__submit").show();$(".search-results__pagination .search-results__pagination__close").show();});$("input[type=text].search-results__pagination__input-search").click(function(){document.getElementById("js-search-results__pagination__input-search").selectionStart=0;document.getElementById("js-search-results__pagination__input-search").selectionEnd=999;$(".search-results__pagination .button").hide();$(".search-results__pagination .search-results__pagination__submit").show();$(".search-results__pagination .search-results__pagination__close").show();$('html, body').animate({scrollTop:$(document).height()},0);return false;});$(".search-results__pagination .search-results__pagination__close").click(function(){$(".search-results__pagination .button").show();$(".search-results__pagination .search-results__pagination__submit").hide();$(".search-results__pagination .search-results__pagination__close").hide();});};
bkt.mvc.snippetDelay=20;bkt.mvc.callbacks.resultsAction=function(){$(".progress").hide();if(typeof bkt.mvc.urlparams.page==="undefined"){bkt.mvc.urlparams.page=1;}
bkt.onBackButton(bkt.mvc.urlparams);if(typeof bkt.mvc.recordHistory!=="undefined"&&bkt.mvc.recordHistory===1)
{bkt.setHistoryState(bkt.mvc.urlparams);}
$("article").attr("data-hidden","yes");var tmp=false;if(typeof bkt.mvc.urlparams.cql!=="undefined"){tmp=bkt.mvc.urlparams.cql;}
if(bkt.mvc.urlparams.coll!=="ngvn"){if($("h1[data-no-results-found='true']").length>0){$(".sortlinks").hide();if($("p.diagnostic").length===0&&typeof bkt.mvc.urlparams.query!=='undefined'&&bkt.mvc.urlparams.query.trim().length>0){(function(){"use strict";var colls=["boeken","boeken1","ddd","dts","anp"],pending=4,succeeded=0,params,_digest=function(response){pending--;if(response.trim()!==""){succeeded+=1;}
$(".small-results-counts-placeholder").append(response);if(pending===0){if(succeeded>0){$(".search-results__no-results__text").text(bkt.i18n.lookup("no_results_info",{controller:"results"})).append($("<span class='search-results__no-results__text--keyword'>").html($(".basic-query").val())).append(bkt.i18n.lookup("no_results_extra",{controller:"results"}));}else{$(".no-results-elems p").html(bkt.i18n.lookup("no_results_info_2",{controller:"results"}));}}},i;for(i in colls){if(colls[i]!==bkt.mvc.urlparams.coll){params=$.extend({},bkt.mvc.urlparams);delete params.cql;params.coll=colls[i];bkt.fetch("/"+bkt.mvc.guilang+"/pres/results/smallresultscount",{data:params,success:_digest});}}}());}else{$(".search-results__no-results__text").html(bkt.i18n.lookup("no_results_info_2",{controller:"results"}));}}else{$(".sortlinks").show();}}
bkt.mvc.maxSnippet=5;bkt.mvc.counter=bkt.mvc.maxSnippet;bkt.mvc.scrollStart=0;if(typeof tmp!=="undefined"&&tmp){bkt.mvc.urlparams.cql=tmp;}
(function(){"use strict";var scrollDelay=100,lastTime=new Date().getTime(),pollTimeout=16,snippetDelay=0;function renderThumbnails(){$(".queued-thumbnail[data-src]").each(function(i,img){var src=$(img).attr("data-src"),top=$(img).offset().top,bottom=top+100,scrollTop=$(window).scrollTop(),winHeight=$(window).height();if((top>scrollTop&&top<winHeight+scrollTop)||(bottom>scrollTop&&bottom<winHeight+scrollTop)||bkt.mvc.counter>0){$(img).hide().removeAttr("data-src").attr("src",src).on("load",function(){$(this).fadeIn({complete:function(){if(bkt.mvc.callbacks.progressiveSnippetRendering&&bkt.mvc.counter>0){$(this).parents("article").attr("data-snippet",snippetDelay);snippetDelay+=1;bkt.mvc.counter-=1;}
var x=$(this).parent().next().show();}}).parent("a").addClass("no-placeholder");});}});}
function moveAddFavouritesButton(){if(window.matchMedia("(max-width: 679px)").matches){$(".search-result__metadata .search-result__add-favourite-wrapper").each(function(){$(this).appendTo($(this).parent().siblings(".search-result__thumbnail"));});}else{$(".search-result__thumbnail .search-result__add-favourite-wrapper").each(function(){$(this).appendTo($(this).parent().siblings(".search-result__metadata"));});}}
moveAddFavouritesButton();$(window).on("resize",moveAddFavouritesButton);function renderPoll(){if($(".queued-thumbnail[data-src]").length===0){return;}
if(new Date().getTime()-lastTime>scrollDelay){renderThumbnails();}
window.setTimeout(renderPoll,pollTimeout);}
$(window).on("scroll resize",function(){bkt.mvc.snippetDelay--;snippetDelay=0;if(bkt.mvc.callbacks.progressiveSnippetRendering&&bkt.mvc.snippetDelay===0)
{bkt.mvc.snippetDelay=20;var hidden=$("article[data-hidden='yes']");if(hidden.length>0)
{var i=bkt.mvc.maxSnippet;if(($(window).scrollTop()/ $(window).height())>2)
{i=bkt.mvc.urlparams.maxperpage;}
var i=5;for(var j in hidden)
{$(hidden[j]).attr('data-snippet',1);i--;if(i<=0)
{break;}}}}
lastTime=new Date().getTime();});renderPoll();}());var settings=bkt.mvc.settings.getSettings(),currentSetting=settings.presentationLevel||"normal",observeSnippetHotzones=false,activateTools;$(".js-button-presentation-level").removeClass("active");$(".js-button-presentation-level."+currentSetting).addClass("active");function setSingleResultPresentationlevel(button,presentationLevel,tools){var el=$($(button).parents("tr")[0]),params=bkt.mvc.urlparams,id=$(el).attr("data-identifier");if(!params.page){params.page=1;}
if(params.actions){delete(params.actions);}
if(params.pres){delete(params.pres);}
params.maxperpage=$(".bkt-mvc-paginateAction .maxperpage-setter select").val();bkt.fetch("/"+bkt.mvc.guilang+"/pres/results/singleresult",{data:$.extend(params,{pres:{presentationLevel:presentationLevel,resultid:id}}),success:function(html){function heightWithPadding(el){return el.height()+
parseInt(el.css("padding-top")||0,10)+
parseInt(el.css("padding-bottom")||0,10);}
var mdDiv=$(el).find("td > div"),heightBefore=heightWithPadding(mdDiv),heightAfter;$(el).html(html).removeAttr("data-snippet-done");heightAfter=heightWithPadding($($(el).find("td > div")[1]));function performSlide(){$(el).find("article > div").css({overflow:"hidden",height:heightBefore+"px"}).animate({height:heightAfter+"px"},{easing:heightBefore>heightAfter?"easeOutQuad":"easeInQuad",complete:function(){$(this).css({height:"auto"});}});}
$(el).find(".thumbnail img").attr("src",$(el).find(".thumbnail img").attr("data-src"));performSlide();if(observeSnippetHotzones){observeSnippetHotzones("article[data-identifier='"+id+"'] div.thumbnail,"+"article[data-identifier='"+id+"'] div.metadata");}
if(bkt.mvc.callbacks.progressiveSnippetRendering){$(el).attr("data-snippet","1");}
activateTools(el);if($("article .tools .presentation-level ."+presentationLevel).length===$("article .tools .presentation-level .active."+presentationLevel).length){$(".js-button-presentation-level").removeClass("active");$(".js-button-presentation-level."+presentationLevel).addClass("active");}}});}
activateTools=function(el){var tools=$(el).find(".tools"),favLink=$(el).find(".add-favourite").getTranslation('add_favourite',{attr:'title'});$(el).find(".tools.normal-presentation .minimal").on("click",function(){setSingleResultPresentationlevel(this,'minimal',tools);});$(el).find(".tools.minimal-presentation .normal").on("click",function(){setSingleResultPresentationlevel(this,'normal',tools);});if(bkt.favourites.isFavourite(bkt.mvc.urlparams.coll,$(el).attr('data-identifier'))){favLink.removeClass("icon--zz007-favorieten-off").addClass("active icon--favorieten");}
favLink.on('click',function(e){var id=$(this).parents("article").attr('data-identifier'),metadata;if($(this).hasClass("active")){bkt.favourites.remove(bkt.mvc.urlparams.coll,id);$(this).removeClass("active icon--favorieten").addClass("icon--zz007-favorieten-off").getTranslation("add_favourite",{attr:"title"});}else{metadata=$(this).parents("article").attr('data-metadata');bkt.favourites.add(bkt.mvc.urlparams.coll,id,JSON.parse(metadata));$(this).removeClass("icon--zz007-favorieten-off").addClass("active icon--favorieten").getTranslation("added_to_favourites",{attr:"title"});}
return false;});};$(".searchresults article").each(function(i,el){activateTools(el);});if(!bkt.mvc.urlparams.coll||bkt.mvc.urlparams.coll==="anp"||bkt.mvc.urlparams.coll==="boeken1"||bkt.mvc.urlparams.coll==="dddtitel"){return;}
if(!bkt.mvc.urlparams.query||bkt.mvc.urlparams.coll==="boeken"&&bkt.mvc.urlparams.query===''||bkt.mvc.urlparams.coll==="dts"&&bkt.mvc.urlparams.query===''){return;}
if(bkt.mvc.presentationSettings.presentationLevel==='minimal'){return;}
if(!bkt.mvc.callbacks.progressiveSnippetRendering){observeSnippetHotzones=function(locator){var l=locator||".searchresults article .thumbnail, .searchresults article .metadata";$(l).on("mouseover",function(e){if($(this).parents("article").is("[data-snippet-done]")){return;}
$(this).parents("article").attr("data-snippet","5");}).on("mouseout",function(e){$(this).parents("article").removeAttr("data-snippet");});};}
function fetchSnippet(tr){var id=$(tr).attr("data-identifier"),objectid=id,coll=bkt.mvc.urlparams.coll,params;if($(tr).attr("data-metadata")){var metadata=JSON.parse($(tr).attr("data-metadata"));if(coll==='boeken'){objectid=metadata.bookid;}else if(coll==='dts'){objectid=metadata.dtsid;}}
params={coll:coll,object:objectid};if(bkt.mvc.urlparams.query){params.query=bkt.mvc.urlparams.query;}
if(bkt.mvc.urlparams.cql){params.cql=bkt.mvc.urlparams.cql;}
bkt.fetch("/"+bkt.mvc.guilang+"/pres/results/snippet",{data:params,success:function(html){var tableRow=$("article[data-identifier='"+id+"']");$(tableRow).find(".snippet").html($("<span>").html(html).hide().fadeIn());$(tableRow).find(".snippet").addClass("search-result__metadata__snippet--ellipsis");bkt.mvc.renderZones($(tableRow).find(".thumbnail img"));}});}
function pollForSnippets(){$(".searchresults article").each(function(i,tr){if(!$(tr).is("[data-snippet]")){return;}
var delay=parseInt($(tr).attr("data-snippet"),10);if(delay===0){$(tr).attr("data-snippet-done","yes").removeAttr("data-snippet").removeAttr("data-hidden");fetchSnippet(tr);}else{$(tr).attr("data-snippet",delay-1);}});setTimeout(pollForSnippets,100);}
pollForSnippets();if(typeof observeSnippetHotzones==='function'){observeSnippetHotzones();}
bkt.mvc.checkForEnrichment=true;if(typeof bkt.mvc.checkForEnrichment!=='undefined'){if(bkt.mvc.urlparams.coll==='ddd'||bkt.mvc.urlparams.coll==='anp'){bkt.mvc.callbacks.enrichmentAction();}}};
bkt.mvc.callbacks.sortlinksAction=function(){var $sortLinksAction;var mql;var sortOptions;var currentSortfield;var selectedOptionId;var selectize;$sortLinksAction=$(".sortlinks .bkt-mvc-sortlinksAction");mql=window.matchMedia("(max-width: 745px)");mql.addListener(_onBreakPointChange);currentSortfield=bkt.deparam(window.location.href).sortfield;sortOptions=_getSortOptions();$sortLinksAction.empty();$sortLinksAction.append('<select id="selectize-sort-wrap" class="search-results__lay-out-panel__sort-wrap__select" data-testing-class="search-results__sortfield"></select>');selectize=$("#selectize-sort-wrap").selectize({maxItems:1,valueField:'url',labelField:'label',options:sortOptions,items:[selectedOptionId],hideSelected:(sortOptions.length>1)})[0].selectize;selectize.on("change",_onSortChange);_fixSelectizeQuirks();if(currentSortfield===undefined){$(".sortlinks .info-link").css({display:"block"});}else{$(".sortlinks .info-link").hide();}
function _onBreakPointChange(mql){for(var url in selectize.options){var settings=selectize.options[url];settings.label=(mql.matches?settings.labelShort:settings.labelLong);selectize.updateOption(url,settings);}}
function _onSortChange(){var href=this.getValue();var params=bkt.deparam(href);var step=(bkt.mvc.urlparams.coll&&(bkt.mvc.urlparams.coll==='ddd'))?12:2;if(!params.sortfield){delete(bkt.mvc.urlparams.sortfield);}else{bkt.mvc.recordHistory=1;bkt.setHistoryState(bkt.mvc.urlparams);}
bkt.mvc.progress.fake(".progress",".progress .percentage",step);bkt.mvc.renderView(['paginate','results','sortlinks','facets'],params);bkt.mvc.urlparams=bkt.deparam(href);}
function _fixSelectizeQuirks(){var $controls=$('#selectize-sort-wrap + .selectize-control .selectize-input input');$controls.prop('readonly',true);$controls.on('focus',function(){$(this).trigger('blur');});$('#selectize-sort-wrap + .selectize-control .selectize-input input, .selectize-max-per-page + .selectize-control .selectize-input').css('cursor','pointer');}
function _getSortOptions(){var iconAscending;var iconDescending;var labelAscending;var labelDescending;var options;iconAscending=" \u2191";iconDescending=" \u2193";labelAscending=" ("+bkt.i18n.lookup("ascending")+")";labelDescending=" ("+bkt.i18n.lookup("descending")+")";options=[];$sortLinksAction.children("a").each(function(){var $this;var url;var altUrl;var baseLabel;var sortfield;var altSortfield;var longLabel;var shortLabel;var altLongLabel;var altShortLabel;var params;$this=$(this);url=$this.attr("href");baseLabel=$(this).text().trim();params=bkt.deparam(url);sortfield=params.sortfield;if(sortfield){if(sortfield.match(/desc$/)){shortLabel=baseLabel+iconDescending;longLabel=baseLabel+labelDescending;altShortLabel=baseLabel+iconAscending;altLongLabel=baseLabel+labelAscending;altSortfield=sortfield.replace(/desc$/,"");}else{shortLabel=baseLabel+iconAscending;longLabel=baseLabel+labelAscending;altShortLabel=baseLabel+iconDescending;altLongLabel=baseLabel+labelDescending;altSortfield=sortfield+"desc";}
_addSortOption(url,shortLabel,longLabel);altUrl=_getOptionUrl(params,altSortfield);_addSortOption(altUrl,altShortLabel,altLongLabel);if(sortfield===currentSortfield){selectedOptionId=url;}else if(altSortfield===currentSortfield){selectedOptionId=altUrl;}}else{if(currentSortfield===undefined){selectedOptionId=url;}
_addSortOption(url,baseLabel,baseLabel);}});function _addSortOption(url,labelShort,labelLong){options.push({url:url,label:(mql.matches?labelShort:labelLong),labelShort:labelShort,labelLong:labelLong});}
function _getOptionUrl(params,sortfield){var params=$.extend({},params);params.sortfield=sortfield;return window.location.pathname+"?"+$.param(params);}
return options;}};
bkt.mvc.callbacks.detailsAction=function(){bkt.mvc.viewer.reinitSideblockHeaders();};
bkt.mvc.callbacks.imageAction=function(){var originalImageTag=$(".bkt-mvc-imageAction img");function onCanvasLoad(){$(".pending").hide();$(".object-view-side-bar.viewer").css({"height":bkt.mvc.viewer.getInnerHeight()+"px"});bkt.mvc.viewer.recalibrate();$("canvas#canvas").addClass("unselectable");$("canvas#canvas").trigger("setHighlights",bkt.loadSetting("highlights-are-on"));if(bkt.loadSetting("scroll-lock-viewer")===true){$("canvas#canvas").trigger("setScrollLock",true);}
bkt.deleteSetting("highlights-are-on");var articleZoomLink=$(".bkt-mvc-objectresultsbuttonsAction .zoom-to-article");if(articleZoomLink.length>0){articleZoomLink.attr("stored-href",articleZoomLink.attr("href")).removeAttr("href").on("click",function(){bkt.mvc.viewer.zoomToArticle($(this),true);}).trigger("click");}else if(originalImageTag.is("[data-original-y-pos]")){bkt.mvc.viewer.zoomToArticle(originalImageTag,false);}
if(bkt.isTouchDevice()){canvas.imageviewerTouchHandlers({onswipeleft:function(){if($(canvas).attr("swipable")==="true"){var btn=$(".object-viewer__button--page-next")[0];if(btn){btn.click();}};},onswiperight:function(){if($(canvas).attr("swipable")==="true"){var btn=$(".object-viewer__button--page-prev")[0];if(btn){btn.click();}};},ondoubletap:function(){if(!$('input.toggle-checkbox-radio--header-inner-wrapper--simple-search').is(':checked')){bkt.mvc.viewer.toggleFullScreen();$(canvas).trigger("scaleToFullWidth");$(".toggle-checkbox-radio--header__nav").prop("checked",false);}}});}
bkt.mvc.viewer.reinitSideblockHeaders();}
var step=8;var previewScale=0.4;if(bkt.mvc.urlparams.coll&&bkt.mvc.urlparams.coll==='ddd'){step=1;if(navigator.userAgent.match(/iPad/i)!==null){previewScale=0.3;}}
if(bkt.mvc.urlparams.coll&&bkt.mvc.urlparams.coll==='boeken'){previewScale=0.8;}
if(window.IS_PHONE){previewScale=0.1;}
bkt.mvc.progress.fake(".object-viewer__progress",".object-viewer__progress .percentage",step);var src=$(".bkt-mvc-imageAction img").attr("data-src");var serviceUrl=typeof src!=="undefined"?src.replace(/\?.*/,"",src):'';var params=typeof src!=="undefined"?bkt.deparam(src.replace(/.*\?/,"",src)):{};var canvas=$("<canvas>").attr("height",bkt.mvc.viewer.getInnerHeight()).attr("width",$(".view-content").width()).attr("id","canvas").attr("unselectable","on");delete(params.w);delete(params.h);delete(params.s);if(params.words&&params.words.replace(/\s+/,'')===''){delete(params.words);}
$(".bkt-mvc-imageAction img").replaceWith(canvas);function initCanvas(){if(!window.IS_PHONE&&$(".minimap").length===0){setTimeout(initCanvas,10);}else{$(".minimap").html("");var legacy=false;if(params.useresolver&&params.useresolver==="false"){legacy=true;}
canvas.imageViewerClient(serviceUrl,{params:params,userCallback:onCanvasLoad,previewScale:previewScale,legacy:legacy,initialZoom:"scaleToFullHeight",overlayFill:"rgba(254, 254, 101, 0.4)",minimap:window.IS_PHONE?null:$(".minimap"),minimapOptions:{interactive:true,color:"red",canvas:canvas,onmove:function(movement){canvas.trigger('moveBy',[movement,false,true]);},onup:function(movement){canvas.trigger('moveBy',[movement,true,true]);},ondown:function(pos){canvas.trigger('moveTo',[pos,false,true]);},onout:function(){canvas.trigger('redraw');}},onImageError:bkt.mvc.viewer.handleImageError,onClip:function(url,opts){var preview=$("<img>").attr("src",url);$(".overlay__backdrop").show().on("click",function(){$(this).hide();$(".imageclip-lightbox").fadeOut();});$(".imageclip-lightbox").fadeIn();$(".imageclip-lightbox .preview").html(preview);$(".imageclip-lightbox a.download-image").off("click").on("click",function(){$(".imageclip-lightbox").hide();$(".overlay__backdrop").hide();window.open("/"+bkt.mvc.guilang+"/api/downloadimage?"+$.param(opts));});$(".imageclip-lightbox a.download-text").off("click").on("click",function(){$(".imageclip-lightbox").hide();$(".overlay__backdrop").hide();window.open("/"+bkt.mvc.guilang+"/api/downloadtext?"+$.param(opts));});$(".imageclip-lightbox a.print-image").off("click").on("click",function(){$(".imageclip-lightbox").hide();$(".overlay__backdrop").hide();window.open("/"+bkt.mvc.guilang+"/api/printimage?"+$.param(opts));});bkt.mvc.toggleClip($(".object-view-menu__list__item__link--uitsnede"));canvas.trigger('redraw');},slider:$(".slider")});canvas.imageViewerHandlers({mousewheel:true});}}
initCanvas();};
bkt.mvc.callbacks.imagetoolsAction=function(){$(".bkt-mvc-imagetoolsAction .zoom-in").removeAttr("href").on("click",function(){$("canvas#canvas").trigger('scaleBy',[1.25,true]);});$(".bkt-mvc-imagetoolsAction .zoom-out").removeAttr("href").on("click",function(){$("canvas#canvas").trigger('scaleBy',[0.75,true]);});$(".bkt-mvc-imagetoolsAction .full-scale").removeAttr("href").on("click",function(){$("canvas#canvas").trigger('scaleBy',[1.0,true,false,true]);});$(".bkt-mvc-imagetoolsAction .full-width").removeAttr("href").on("click",function(){$("canvas#canvas").trigger('scaleToFullWidth');});$(".bkt-mvc-imagetoolsAction .full-height").removeAttr("href").on("click",function(){$("canvas#canvas").trigger('scaleToFullHeight');});$(".bkt-mvc-imagetoolsAction .rotate-cw").removeAttr("href").on("click",function(){$("canvas#canvas").trigger('rotateBy',90);});$(".bkt-mvc-imagetoolsAction .rotate-ccw").removeAttr("href").on("click",function(){$("canvas#canvas").trigger('rotateBy',-90);});bkt.mvc.viewer.reinitSideblockHeaders();};
bkt.mvc.callbacks.objectresultsAction=function(){$(".view-content").addClass("scrollable");$(".bkt-mvc-objectresultsAction").addClass("object-viewer-inner-wrapper--is-object-results");if($(".view-content .buffer.prev-page").length>0){$(".view-content").scrollTop($(".view-content .buffer.prev-page").height());}
var scrollTimer=0;var highest=300;function observeThumbnails(){if(--scrollTimer>0){setTimeout(observeThumbnails,100);return;}
scrollTimer=5;var thumbs=$(".bkt-mvc-objectresultsAction .queued-thumbnail[data-src]");var fetched=0;thumbs.each(function(i,img){var top=$(img).offset().top-$(".view-content").offset().top;var bottom=($(img).offset().top+$(img).parents(".both-container").height())-$(".view-content").offset().top;if((top>0&&top<$(".view-content").height())||bottom>0&&bottom<$(".view-content").height()){fetched++;var src=$(img).attr("data-src");bkt.imageQueue.queueImage($(img),src,{fade:true,callback:bkt.mvc.renderZones});$(img).removeAttr("data-src").on("load",function(){if($(this).height()>highest){highest=$(this).height();$(".bkt-mvc-objectresultsAction .thumb-container").css("min-height",highest+"px");}});}});setTimeout(observeThumbnails,100);}
var fetchingBatch=false;function fetchBatch(fromSide,bufferDiv){console.log("fetchBatch");var params=bkt.deparam(bufferDiv.attr("data-page"));params.pres.nobuffer=fromSide;var topThumb=$(".view-content .thumb").get(0);fetchingBatch=true;bkt.fetch("/"+bkt.getLanguage()+"/pres/view/objectresults",{data:params,success:function(html){bufferDiv.replaceWith(html);fetchingBatch=false;$(".bkt-mvc-objectresultsAction .thumb-container").css("min-height",highest+"px");if(fromSide==='bottom'){$(".view-content").scrollTop($(topThumb).offset().top);}
$(".bkt-mvc-objectresultsAction a").off("click").on("click",bkt.mvc.viewer.storeObjectPanelState);}});}
function observePaginationBuffers(){console.log("observePaginationBuffers");if($(".view-content .buffer.prev-page").length>0&&$(".view-content").scrollTop()<$(".view-content .buffer.prev-page").height()&&!fetchingBatch){fetchBatch("bottom",$(".view-content .buffer.prev-page"));}
if($(".view-content .buffer.next-page").length>0&&$(".view-content .buffer.next-page").offset().top<=(parseInt($(".content").height())+1)&&!fetchingBatch){fetchBatch("top",$(".view-content .buffer.next-page"));}}
if(!$(".button.toggle-highlight").hasClass("active")){$(".bkt-mvc-objectresultsAction .hit").addClass("highlight--is-disabled");}
$(".bkt-mvc-objectresultsAction a").on("click",bkt.mvc.viewer.storeObjectPanelState);$(".view-content").scroll(function(){scrollTimer=5;observePaginationBuffers();});observeThumbnails();};
bkt.mvc.callbacks.objectresultsbuttonsAction=function(){$(".bkt-mvc-objectresultsbuttonsAction a.prev, .bkt-mvc-objectresultsbuttonsAction a.next").on("click",bkt.mvc.viewer.storeObjectPanelState);$(".bkt-mvc-objectresultsbuttonsAction form").on("submit",bkt.mvc.viewer.storeObjectPanelState);if(bkt.loadSetting("highlights-are-on")===false){$(".bkt-mvc-objectresultsbuttonsAction .toggle-highlight.button").trigger("click");}
$(".bkt-mvc-objectresultsbuttonsAction a.js-only-hits").attr("data-href",$(".bkt-mvc-objectresultsbuttonsAction a.js-only-hits").attr("href")).removeAttr("href").on("click",function(){var params=bkt.deparam($(".bkt-mvc-objectresultsbuttonsAction a.js-only-hits").attr("data-href"));if($(this).hasClass("active")){delete(params.pres);$(this).removeClass("active").getTranslation("only_hits",{attr:"title"});}else{params.pres={onlyHits:1,page:1};$(this).addClass("active").getTranslation("all_pages",{attr:"title"});}
bkt.mvc.renderPartial("objectresults",{data:params,callback:bkt.mvc.callbacks.objectresultsAction});}).getTranslation("only_hits",{attr:"title"});function checkMouseMove(){var timeoutCheckMouseMove=null;$("#object").on('mousemove',function(){clearTimeout(timeoutCheckMouseMove);timeoutCheckMouseMove=setTimeout(function(){bkt.mvc.viewer.monitorViewButtons();},500);});}
checkMouseMove();function moveMenuItems(){if(window.matchMedia("(max-width: 679px)").matches){if(!$(".object-viewer__button--panel-up").hasClass("object-viewer__button--panel-up--is-hidden")){$(".object-view-menu__list--side-bar-block--is-enabled-movable-items .object-view-menu__list__item--movable").appendTo(".object-view-menu__list--main-menu");$(".object-viewer__button--panel-up").addClass("object-viewer__button--panel-up--is-hidden");$(".object-viewer__button--panel-left").addClass("object-viewer__button--panel-up--is-hidden");$(".object-viewer__ocr-button--text").addClass("object-viewer__ocr-button--text--is-hidden");}}else{if($(".object-viewer__button--panel-up").hasClass("object-viewer__button--panel-up--is-hidden")){$(".object-view-menu__list--main-menu .object-view-menu__list__item--movable").appendTo(".object-view-menu__list--side-bar-block--is-enabled-movable-items");$(".object-viewer__button--panel-up").removeClass("object-viewer__button--panel-up--is-hidden");$(".object-viewer__button--panel-left").removeClass("object-viewer__button--panel-up--is-hidden");$(".object-viewer__ocr-button--text").removeClass("object-viewer__ocr-button--text--is-hidden");}}
var isTouchDevice=$(".device-type--touch-device").length;if(isTouchDevice){$(".object-viewer__button--scroll-wheel-scroll").addClass("object-viewer__button--scroll-wheel-scroll--is-hidden");}}
moveMenuItems();$(window).on("resize",moveMenuItems);};
bkt.mvc.callbacks.ocrAction=function(){bkt.mvc.viewer.reinitSideblockHeaders();if(bkt.loadSetting("highlights-are-on")===false){$(".highlight").addClass("dont-highlight");}};
bkt.mvc.callbacks.pagebuttonsAction=function(){var currentAction=bkt.getAction()==='ocr'?'ocr':'image';var params=$(".thumbnail-view").length!==0?bkt.deparam($(".thumbnail-view").attr("href").replace(/.*\?/,"")):{};var storedAction="";var toggleLocators=".bkt-mvc-imagetoolsAction,"+".toggle-ocr-button";var disableLocators=".bkt-mvc-pagebuttonsAction .object-view-menu__list__item--navigate-results,"+".bkt-mvc-objectresultsbuttonsAction .object-view-menu__list__item--navigate-results";$(".thumbnail-view").removeAttr("href").on("click",function(){if($(this).hasClass("thumbnails-visible")){$(".bkt-mvc-objectresultsAction").removeClass("object-viewer-inner-wrapper--is-object-results");$(toggleLocators).show("slow");$(disableLocators).show("slow");$(".bkt-mvc-pagebuttonsAction .object-view-menu__navigate-results__button").show("slow",function(){$(".bkt-mvc-pagebuttonsAction .object-view-menu__navigate-results__form").fadeIn(200).css("display","table-cell");}).css("display","table-cell");$(".bkt-mvc-objectresultsbuttonsAction .object-view-menu__navigate-results__button").show("slow",function(){$(".bkt-mvc-objectresultsbuttonsAction .object-view-menu__navigate-results__form").fadeIn(200).css("display","table-cell");}).css("display","table-cell");$(".zoom-to-article").show();$(".js-only-hits").removeClass("object-view-menu__list__item__link--only-hits--is-visible");if(currentAction==='image'){bkt.mvc.renderPartial("image",{data:params,callback:bkt.mvc.callbacks.imageAction});$(this).removeClass("thumbnails-visible").addClass("hover-move-css-fix");$(".view-content").removeClass("scrollable");}else{$(".bkt-mvc-"+currentAction+"Action").html(storedAction);$(".view-content").addClass("ocr");bkt.mvc.callbacks.ocrAction();bkt.mvc.callbacks.pageocrAction();}
$(this).removeClass("thumbnails-visible").addClass("hover-move-css-fix");$(this).attr("title",bkt.i18n.lookup("open_thumbnail_overview",{"coll":bkt.getCollForSkin(bkt.getSkin()),"controller":"view"}));}else{if($(window).width()<=bkt.mvc.viewer.widthThreshold){if(!$(".right-panel").hasClass("out")){$(".lo-res-text-toggle.button.lo-res").click();}}
if(!params.pres){params.pres={maxperpage:36};}
storedAction=$(".bkt-mvc-"+currentAction+"Action").html();bkt.mvc.renderPartial("objectresults",{data:params,callback:bkt.mvc.callbacks.objectresultsAction});$(".view-content").removeClass("ocr");$(this).addClass("thumbnails-visible").removeClass("hover-move-css-fix");$(toggleLocators).hide("slow");$(disableLocators).hide("slow");$(".bkt-mvc-pagebuttonsAction .object-view-menu__navigate-results__form").hide();$(".bkt-mvc-objectresultsbuttonsAction .object-view-menu__navigate-results__form").hide();$(".bkt-mvc-pagebuttonsAction .object-view-menu__navigate-results__button").hide("slow");$(".bkt-mvc-objectresultsbuttonsAction .object-view-menu__navigate-results__button").hide("slow");$(".zoom-to-article").hide();$(".js-only-hits").addClass("object-view-menu__list__item__link--only-hits--is-visible");if($(".ocr-toggle").hasClass("active")){bkt.mvc.viewer.toggleOcr($(".ocr-toggle"));}
$(this).attr("title",bkt.i18n.lookup("close_thumbnail_overview",{"coll":bkt.getCollForSkin(bkt.getSkin()),"controller":"view"}));}}).on("mousemove",function(){$(this).removeClass("hover-move-css-fix");});$(".bkt-mvc-pagebuttonsAction form").on("submit",bkt.mvc.viewer.storeObjectPanelState);if(bkt.getAction()==='ocr'){$(".bkt-mvc-pagebuttonsAction a.prev, .bkt-mvc-pagebuttonsAction a.next").each(function(i,el){var link=$(el).attr("href");if(link){$(el).attr("href",link.replace(/\/view\/?/,"/view/ocr"));}});$(".bkt-mvc-pagebuttonsAction form").append($("<input>").attr("type","hidden").attr("name","inOcr").val("1"));}
$(".bkt-mvc-pagebuttonsAction a.prev, .bkt-mvc-pagebuttonsAction a.next").on("click",bkt.mvc.viewer.storeObjectPanelState);bkt.mvc.viewer.reinitSideblockHeaders();};
bkt.mvc.callbacks.pageocrAction=function(){var articleIds=[];function fetchNext(){console.log("PAGEOCR FNEXT");if(articleIds.length===0){return;}
var articleId=articleIds.shift();fetchOcrFor($("a[data-id='"+articleId+"']")[0],fetchNext,true);}
function fetchOcrFor(tag,callback1,force,postcallback1){var callback=callback1||function(){};var postcallback=postcallback1||function(){};var articleId=$(tag).attr("data-id");if($(tag).parents("h3").hasClass("expanded")&&!force){$(tag).parents("h3").removeClass("expanded").addClass("collapsed");$("div[data-for-id='"+articleId+"']").fadeOut();}else{$(tag).parents("h3").removeClass("collapsed").addClass("expanded");bkt.fetch("/"+bkt.getLanguage()+"/pres/view/ocr",{data:{identifier:articleId,coll:'ddd',query:bkt.mvc.urlparams.objectsearch||bkt.mvc.urlparams.query||""},success:function(html){var article=$("div[data-for-id='"+articleId+"']");article.html(html).fadeIn(400,postcallback).addClass("loaded");if(bkt.loadSetting("highlights-are-on")===false){$(".highlight").addClass("dont-highlight");}
setTimeout(callback,25);}});bkt.fetch("/"+bkt.getLanguage()+"/pres/view/cite",{data:{identifier:articleId,coll:'ddd',query:bkt.mvc.urlparams.objectsearch||bkt.mvc.urlparams.query||""},success:function(html){$("#flex-item-2").html(html);}});}}
$(".bkt-mvc-pageocrAction h3 a").removeAttr("href").each(function(i,el){if($(el).attr("data-id")===bkt.mvc.urlparams.identifier){fetchOcrFor(el,null,false,function(){$(".bkt-mvc-pageocrAction").scrollTop($(el).position().top-$(".bkt-mvc-pageocrAction").position().top);});}});$(".bkt-mvc-pageocrAction h3").on("click",function(e){var _self=this;fetchOcrFor($(this).children("a").first(),function(){bkt.mvc.viewer.scrollSideBlock($(_self).children("a").first(),$(_self).next("div"),$(".bkt-mvc-ocrAction"));});var zones=JSON.parse($(this).children("a").first().attr("data-zones"));if(zones.length<1){return;}
($("canvas#canvas").trigger('moveTo',[{x:zones[0].x-20,y:zones[0].y-20},true,true]).trigger("dropOverlays",{id:$(this).children("a").first().attr("data-id")}).trigger("addOverlays",{id:$(this).children("a").first().attr("data-id"),zones:zones}));var persistentIdentifier=$(this).children("a").first().attr("data-persistent-identifier");$('#share-input-i5').val(persistentIdentifier);$('.hidden-input').show();$('.metadata__details-persistent--input-i4').val(persistentIdentifier).show();var canonicalLink=$(this).children("a").first().attr("data-canonical-link");$("head link[rel='canonical']").attr("href",canonicalLink);}).on("mouseover",function(e){$("canvas#canvas").trigger("addOverlays",{id:$(this).children("a").first().attr("data-id"),zones:JSON.parse($(this).children("a").first().attr("data-zones"))});}).on("mouseout",function(e){$("canvas#canvas").trigger("dropOverlays",{id:$(this).children("a").first().attr("data-id")});});$(".bkt-mvc-pageocrAction div.text").on("mouseover",function(){$("canvas#canvas").trigger("addOverlays",{id:$(this).attr("data-for-id"),zones:JSON.parse($(this).prev().children("a").attr("data-zones"))});}).on("mouseout",function(){$("canvas#canvas").trigger("dropOverlays",{id:$(this).attr("data-for-id")});});if($(window).width()<768){$(".bkt-mvc-pageocrAction .expand-collapse-all").hide();}
$(".bkt-mvc-pageocrAction .expand-all").on("click",function(e){articleIds=$.map($(".bkt-mvc-pageocrAction h3 a"),function(el){return $(el).attr("data-id");});fetchNext();});$(".bkt-mvc-pageocrAction .collapse-all").on("click",function(e){$(".bkt-mvc-pageocrAction h3").removeClass("expanded").addClass("collapsed");$(".bkt-mvc-pageocrAction div.text").fadeOut();});};
bkt.mvc.callbacks.prevnextAction=function(){$(".bkt-mvc-prevnextAction a").on("click",bkt.mvc.viewer.storeHorizontalPanelState);};
bkt.mvc.advancedSearch={noSlide:false,slideDuration:0,slideDurationIn:0,slideDurationOut:0,easingOut:"easeOutQuad",easingIn:"easeInQuad"};bkt.mvc.advancedSearch.removeField=function(el){$(el).parent("div").remove();};bkt.mvc.advancedSearch.showPPNInfo=function(infoLink,ppn){bkt.fetch("/"+bkt.getLanguage()+"/pres/search/ppninfo",{data:{ppn:ppn,fields:'title,issued,publisher,rights,spatial,spatialCreation,ppn',coll:'dddtitel'},success:function(html){bkt.dialogs.informationBox(html,{title:bkt.i18n.lookup("title_info",{controller:"advancedsearch"}),near:infoLink});}});};bkt.mvc.advancedSearch.performUpSlide=function(){$(".bkt-mvc-advancedsearchAction form").css("visibility","hidden");$(".bkt-mvc-advancedsearchAction").slideUp({duration:bkt.mvc.advancedSearch.slideDuration,complete:function(){if($(".view-content").length>0){bkt.mvc.viewer.recalibrate();$("body, html").css({height:"100%",overflow:"hidden"});}
$("#content").css({paddingTop:$(".layout-top-block").height()});},easing:bkt.mvc.advancedSearch.easingOut});};
bkt.cms={};bkt.cms.edit=function(opts){function closeAll(){$(".overlay__backdrop").hide();$(".edit-cms").remove();if(bkt.cms.addPage){bkt.cms.addPage=false;$.ajax('/nl/cms/getlastupdateddate',{success:function(lastNode){console.log("STATUS:"+lastNode.status);console.log("NODE:"+opts.node);}});}else{window.location.reload();}
if(typeof opts.servicemessage!=='undefined'){if(opts.servicemessage){$.ajax('/nl/cms/cachenotices',{success:function(){console.log("OKOKOKOKOKK");}});}else{$.ajax('/nl/cms/cachenotice',{success:function(){console.log("OKOKOKOKOKK");}});}}else{$.ajax('/nl/cms/cachenotice',{success:function(){console.log("OKOKOKOKOKK");}});}}
$(".overlay__backdrop").show().on("click",closeAll);var src=opts.url+"/node/"+opts.node+"/edit";if(opts.action==='add')
{src=opts.url+"/node/add";}
var frame=$("<iframe>").attr("src",src).attr("width",1100).attr("height",900).attr('id','editFrame');var div=$("<div>").attr("class","edit-cms").css({position:"fixed",top:"10px",zIndex:"999"});$("main").append(div.append(frame));};bkt.cms.checkLastUpdatedDate=function(pageUpdatedNotLive){if(pageUpdatedNotLive===1){$("#wphistory").css('background','#faa').append('<br/><span style="color:#f00;">(deze pagina is aangepast maar nog niet live gezet)</span>');}};bkt.cms.refresh=function(opts){var url='/nl/cms/refreshwebpage?nid='+opts.node+'&production_url='+opts.production_url;var ok=false;$.ajax(url,{success:function(){ok=true;setTimeout(function(){if(ok){bkt.dialogs.flashMessage(bkt.i18n.lookup('webpage_live'));window.location.reload();}},200);}});};bkt.cms.addPage=false;bkt.cms.add=function(opts){bkt.cms.addPage=true;bkt.cms.edit(opts);};bkt.cms.notice={};bkt.cms.noticeStatus=false;bkt.cms.checkForNotice=function(){var url='/nl/cms/checknotice';if(typeof ngvn!=="undefined"){url="/"+bkt.getLanguage()+"/cms/checknotices";}
bkt.cms.noticeStatus=setTimeout(function(){console.log("UNHIDE");bkt.cms.unhideNotice();},3600000);$.ajax(url,{success:function(data){if(!$.isEmptyObject(data)){bkt.cms.notice=data;bkt.cms.setDuration(data);if(bkt.cms.noticeWasUpdated(data)){bkt.cms.showNotice(data);$("#notice .close-button").click(function(){bkt.cms.hideNotice();});}}else{bkt.cms.notice={};}}});};bkt.cms.setDuration=function(data){if(typeof data.duration!=="undefined"){clearTimeout(bkt.cms.noticeStatus);bkt.cms.noticeStatus=setTimeout(function(){bkt.cms.unhideNotice();},data.duration*60000);}};bkt.cms.decodeEntities=function(value){value=value.replace("<a","[a");var htmlFragment=$('<div/>').html(value).text();return htmlFragment.replace("[a","<a class='notification__content'");};bkt.cms.showNotice=function(data){var $notice=$("#notice");var $content=$("#content");var body="";if(typeof data.Body!=="undefined")
{body=data.Body;}
else if(typeof data.body!=="undefined")
{body=data.body;}
var decodedBody=bkt.cms.decodeEntities(data.title==='Service Message'?data.message:body.trim());$("#notice > .text").html(decodedBody);if(!$.isEmptyObject(bkt.mvc.urlparams))
{var h=$notice.height();$("div.header-options").css('top',parseInt(h+12)+'px');$("div.header-logo-wrapper").css('top',parseInt(h+26)+'px');}
$("#notice").fadeIn();};bkt.cms.hideNotice=function(){var $notice=$("#notice");bkt.storeSetting('lastNotice',bkt.cms.notice);$notice.hide();};bkt.cms.unhideNotice=function(){bkt.deleteSetting('lastNotice');bkt.cms.checkForNotice();};bkt.cms.noticeWasUpdated=function(data){var lastNotice=bkt.loadSetting('lastNotice');if($.isEmptyObject(lastNotice)||lastNotice===''){return true;}else{if(parseInt(data.updated_date)>(parseInt(lastNotice.updated_date)+3600))
{return true;}else{return false;}}};$(document).ready(function(e){$(".uitklap").click(function(e){var para=$(this).next();if(para.length===0){para=$(this).parent("p").next("p");}
if(para.is(":visible")){para.slideUp("fast");$(this).removeClass("open");}
else{para.slideDown("fast");$(this).addClass("open");}});var path=location.href.replace(/http:\/\/[^\/]+/,"").replace(/\/?\?title=/,"/");var path1=path.replace("/platform","").replace(/\/?\?title=/,"/");$("ul#menu a").each(function(i,el){var href=$(el).attr("href").replace(/\/?\?title=/,"/");if(href===path||href===path1){$(el).addClass("selected");}});bkt.cms.checkForNotice();});
bkt.mvc.favourites={};bkt.mvc.favourites.metadata={};bkt.mvc.favourites.identifier="";bkt.mvc.favourites.init=function(){if(bkt.getController()==='favourites'){bkt.mvc.storable.show('favourites');}
if(bkt.getController()==='view'||bkt.getController()==='gview'){bkt.mvc.favourites.metadata=JSON.parse($("#object").attr("data-metadata"));bkt.mvc.favourites.identifier=bkt.mvc.favourites.metadata.objectlevelId;if(bkt.favourites.isFavourite(bkt.mvc.urlparams.coll,bkt.mvc.favourites.identifier)){$(".js-add-to-favourites").addClass("active").getTranslation("added_to_favourites",{attr:"title"});}}};bkt.mvc.favourites.addFromView=function(el){if(!bkt.mvc.favourites.identifier||!bkt.mvc.urlparams.coll){return;}
if($(el).hasClass("active")){bkt.favourites.remove(bkt.mvc.urlparams.coll,bkt.mvc.favourites.identifier);$(el).removeClass("active").getTranslation("add_favourite",{attr:"title"});}else{bkt.favourites.add(bkt.mvc.urlparams.coll,bkt.mvc.favourites.identifier,bkt.mvc.favourites.metadata);$(el).addClass("active").getTranslation("added_to_favourites",{attr:"title"});}};bkt.mvc.favourites.import=function(fav){for(var i in fav){bkt.favourites.add(fav[i].coll,fav[i].identifier,fav[i].metadata,{suppressNotice:true,dateAdded:fav[i].extra.dateAdded});}
bkt.mvc.favourites.showImportButtons();};bkt.mvc.favourites.hideImportButtons=function(){$(".js-import-favourites-box").fadeOut({complete:function(){$(".overlay__backdrop").hide();}});};bkt.mvc.favourites.showImportButtons=function(){$(".overlay__backdrop").show().off("click").on("click",bkt.mvc.favourites.hideImportButtons);$(".js-import-favourites-box").fadeIn();var ref="?import_favourites_to_ref="+encodeURIComponent(location.href.replace(/\?.*$/,""));var urls=["http://kranten.delpher.nl/import_favourites.php"+ref,"http://boeken.delpher.nl/import_favourites.php"+ref,"http://boeken1.delpher.nl/import_favourites.php"+ref,"http://tijdschriften.delpher.nl/import_favourites.php"+ref,"http://radiobulletins.delpher.nl/import_favourites.php"+ref];$(".import-favourites-container").html("");for(var i in urls){var iframe=$("<iframe>").attr("src",urls[i]).attr("sandbox","allow-same-origin allow-scripts allow-forms allow-top-navigation");$(".import-favourites-container").append(iframe);}};$(document).ready(function(e){bkt.mvc.favourites.init();});
bkt.mvc.lexicon={};bkt.mvc.lexicon.show=false;bkt.mvc.lexicon.fetching=false;bkt.mvc.lexicon.typeDelay=-1;bkt.mvc.lexicon.datasetChanged=false;bkt.mvc.lexicon.variants={};bkt.mvc.lexicon.currentWord=false;bkt.mvc.lexicon.serviceKilled=false;bkt.mvc.lexicon.init=function(){bkt.mvc.lexicon.show=true;$(".field[data-name='content'] input").on("keyup",function(){bkt.mvc.lexicon.typeDelay=40;bkt.mvc.lexicon.updateVariantSelect($(this).val());}).on("focus",function(){bkt.mvc.lexicon.typeDelay=0;bkt.mvc.lexicon.updateVariantSelect($(this).val());}).attr("autocomplete","off");$(".field[data-name='content']").append($("<div id='inl-label'>").addClass("header__form__inl-variants-label-wrapper").getTranslation("header__form__inl-variants-label-wrapper")).append($("<div>").addClass("header__form__inl-variants-list-wrapper").addClass("list"));$(".header__form__inl-variants-label-wrapper").append("<a class='info-link icon icon--zz005-info'></a>");$(".header__form__inl-variants-label-wrapper a.info-link").on("click",bkt.mvc.lexicon.info);bkt.mvc.lexicon.observeQuery();bkt.mvc.lexicon.updateList();};bkt.mvc.lexicon.removeInl=function(){bkt.mvc.lexicon.show=false;$(".header__form__inl-variants-label-wrapper").remove();$(".header__form__inl-variants-list-wrapper").remove();bkt.mvc.lexicon.observeQuery();bkt.mvc.lexicon.updateList();};bkt.mvc.lexicon.info=function(){bkt.dialogs.informationBox(bkt.i18n.lookup("lexicon_info"),{title:bkt.i18n.lookup("lexicon_title"),near:this});};bkt.mvc.lexicon.query2words=function(val,len){var maxlen=len||3;var words=$.grep(val.replace(/[\(\)]/g,"").split(/\s+/),function(v){return v.length>maxlen;});return words;};bkt.mvc.lexicon.updateVariantSelect=function(value){bkt.mvc.lexicon.datasetChanged=false;var words=bkt.mvc.lexicon.query2words(value);if(words.length===0){bkt.mvc.lexicon.currentWord=false;}else{bkt.mvc.lexicon.currentWord=words[0];}};bkt.mvc.lexicon.killService=function(){bkt.mvc.lexicon.serviceKilled=true;};bkt.mvc.lexicon.processVariants=function(data){if(data.exception){bkt.dialogs.flashMessage("Er is een fout opgetreden in de spellingsvarianten service van het INL. probeer het later nog eens",{"title":"Fout in lexicon service",near:$("input[name='search[content][value][0]']")});bkt.mvc.lexicon.killService();}
bkt.mvc.lexicon.datasetChanged=true;if(typeof data.wordforms_list!=='undefined'&&data.wordforms_list.length>=1&&typeof data.wordforms_list[0].found_wordforms!=='undefined'){bkt.mvc.lexicon.variants[bkt.mvc.lexicon.currentWord]=data.wordforms_list[0].found_wordforms;}else{bkt.mvc.lexicon.variants[bkt.mvc.lexicon.currentWord]=[];}};bkt.mvc.lexicon.fetch=function(){if(!bkt.mvc.lexicon.currentWord){return;}
bkt.mvc.lexicon.fetching=true;bkt.fetch("/nl/api/lexicon",{data:{wordform:bkt.mvc.lexicon.currentWord},success:function(data){bkt.mvc.lexicon.fetching=false;bkt.mvc.lexicon.processVariants(data);}});};bkt.mvc.lexicon.addVariant=function(){var container=$(".field[data-name='content']");var inputs=$.makeArray(container.find("input[type=text]"));var variant=$(this).text().trim();if($(this).parents(".header__form__inl-variants-list-wrapper").children("div").length===1){$(".header__form__inl-variants-label-wrapper").hide();}
$(this).parent("div").remove();if(inputs.length===1){var operatorInput=$("<input>").attr("type","hidden").attr("name","search[content][operator][1]").val("or");var valueInput=$("<input>").attr("type","hidden").attr("name","search[content][value][1]").val(variant);container.append(operatorInput).append(valueInput);container.find(".expand-collapse").trigger("click");}else{for(var i in inputs){if($(inputs[i]).val().trim()===""){$(inputs[i]).val(variant).parent("div").prev("select").val("or");return;}}
var newSelect=$(inputs[inputs.length-1]).parent("div").prev("select").clone().attr("name","search[content][operator]["+inputs.length+"]").val("or");var newInput=$("<input class='header__form__input-text header__form__input-text--content'>").attr("type","text").attr("name","search[content][value]["+inputs.length+"]").val(variant).on("keyup",function(){bkt.mvc.lexicon.typeDelay=40;bkt.mvc.lexicon.updateVariantSelect($(this).val());}).on("focus",function(){bkt.mvc.lexicon.typeDelay=0;bkt.mvc.lexicon.updateVariantSelect($(this).val());});bkt.mvc.lexicon.show=false;var newRemoveButton=false;if(inputs.length>3){bkt.mvc.lexicon.show=true;newRemoveButton=$("<button>").attr("name","removefield[content]").val(inputs.length).addClass("remove-button header__form__button-remove icon button-icon icon--zz003-min").attr("type","submit").attr("title",bkt.i18n.lookup("remove_field",{"controller":"advancedsearch"})).on("click",bkt.mvc.callbacks.onAdvancedSearchButtonClick);}
var newInnerDiv0=$("<div>").addClass("header__form__input-wrapper");var newInnerDiv1=$("<div>").addClass("header__form__input-text-wrapper");var newDiv=$("<div>").addClass("header__form__section-inner-wrapper");newInnerDiv1.append(newInput);newInnerDiv0.append(newSelect).append(newInnerDiv1);newDiv.append(newInnerDiv0);if(newRemoveButton){newDiv.append(newRemoveButton);}
$(inputs[inputs.length-1]).parent("div").parent("div").parent("div").after(newDiv);}};bkt.mvc.lexicon.updateList=function(){var listDiv=$(".field[data-name='content']").find(".header__form__inl-variants-list-wrapper");listDiv.html("");if(!bkt.mvc.lexicon.currentWord||typeof bkt.mvc.lexicon.variants[bkt.mvc.lexicon.currentWord]==="undefined"||bkt.mvc.lexicon.variants[bkt.mvc.lexicon.currentWord].length===0){$(".header__form__inl-variants-label-wrapper").hide();return;}
var inputs=$.makeArray($(".field[data-name='content']").find("input[type=text]"));var words=[];for(var j in inputs){var q=$(inputs[j]).val().trim();var ww=bkt.mvc.lexicon.query2words(q,1);for(var k in ww){words.push(ww[k]);}}
var listEmpty=true;for(var i in bkt.mvc.lexicon.variants[bkt.mvc.lexicon.currentWord]){if($.inArray(bkt.mvc.lexicon.variants[bkt.mvc.lexicon.currentWord][i],words)>-1){continue;}
listEmpty=false;var variant=$("<div class='inl-variants__list-label icon icon--zz002-plus'>").html(bkt.mvc.lexicon.variants[bkt.mvc.lexicon.currentWord][i]).on("click",bkt.mvc.lexicon.addVariant);listDiv.append($("<div class='header__form__inl-variants-list-item'>").append(variant));}
if(listEmpty){$(".header__form__inl-variants-label-wrapper").hide();}else{$(".header__form__inl-variants-label-wrapper").css("display","block");}};bkt.mvc.lexicon.observeQuery=function(){if(bkt.mvc.lexicon.serviceKilled){return;}
if(bkt.mvc.lexicon.fetching){console.log("fetching...");}else if(bkt.mvc.lexicon.typeDelay===0){bkt.mvc.lexicon.fetch();bkt.mvc.lexicon.typeDelay=-1;}else{bkt.mvc.lexicon.typeDelay--;}
if(bkt.mvc.lexicon.datasetChanged){bkt.mvc.lexicon.updateList();bkt.mvc.lexicon.datasetChanged=false;}
setTimeout(bkt.mvc.lexicon.observeQuery,20);};
bkt.mvc.results={};bkt.mvc.results.showGoogleResultsInformation=function(element){bkt.dialogs.informationBox(bkt.i18n.lookup("google_results_information",{controller:"results",coll:"boeken1"}),{title:bkt.i18n.lookup("google_results_information_title",{controller:"results",coll:"boeken1"}),near:element});};
bkt.mvc.settings={};bkt.mvc.settings.init=function(){var userSettings=bkt.mvc.settings.getUserSettings();if($.isEmptyObject(userSettings)){$("form.bkt-settings .fieldset").each(function(){var input=$(this).find("input:checked");bkt.mvc.settings.set(input.attr("name"),input.val());});}else{for(var i in userSettings){var input=$("form.bkt-settings .fieldset input[name='"+i+"']");console.log(i);if(isNaN(bkt.mvc.settings.get(i))){input.parents(".fieldset").children(".currentvalue").getTranslation(bkt.mvc.settings.get(i),{controller:"settings"});}else{input.parents(".fieldset").children(".currentvalue").text(bkt.mvc.settings.get(i));}
input.val([bkt.mvc.settings.get(i)]);}}
$("form.bkt-settings .fieldset .setting__category__value-input").change(bkt.mvc.settings.submit);$("form.bkt-settings button.close").click(function(){history.go(-1);});if(window.location.hash.length>0){bkt.mvc.settings.showSetting(window.location.hash);}};bkt.mvc.settings.confirmations={storeViewedPages:{value:"off",msg:bkt.i18n.lookup("confirm_remove_visited_list_from_settings")},presentationLevel:false,spellingVariants:false,resultsPerPage:false};bkt.mvc.settings.onConfirm=function(key,value,callback){if(bkt.mvc.settings.confirmations[key]&&bkt.mvc.settings.confirmations[key].value===value&&bkt.mvc.settings.checkBeforeConfirm(key)){bkt.dialogs.confirm(bkt.mvc.settings.confirmations[key].msg,{onConfirm:callback,showBackdrop:true});}else{callback();}};bkt.mvc.settings.checkBeforeConfirm=function(key){if(key!=='storeViewedPages'){return true;}
var colls=['ddd','anp','dts','boeken','boeken1'];for(var i in colls){var coll=colls[i];if(bkt.visited.count(coll)>0){return true;}}
return false;};bkt.mvc.settings.submit=function(){var el=this;var input=$(el).parent().children("input:checked");bkt.mvc.settings.onConfirm(input.attr("name"),input.val(),function(){bkt.mvc.settings.set(input.attr("name"),input.val());$(el).parents().children(".currentvalue").html(input.next("label").html().trim());$(el).parents().children(".toggle-checkbox-radio--setting__category").attr('checked',false);bkt.mvc.settings.activateOnChange();});};bkt.mvc.settings.activateOnChange=function(){var settings=bkt.loadSetting('settings');if(settings&&settings.storeViewedPages==='on'){$(".layout-top-block .options .storables-context-menu a.visited").removeClass("header__nav__list__item__link--disabled").attr("href",$(".layout-top-block .options .storables-context-menu a.visited").attr("data-href"));}else{bkt.deleteSetting("visited");$(".layout-top-block .options .storables-context-menu a.visited").addClass("header__nav__list__item__link--disabled").removeAttr("href");}};bkt.mvc.settings.getUserSettings=function(){return bkt.loadSetting("settings");};bkt.mvc.settings.getSettings=function(){return bkt.mvc.settings.getUserSettings();};bkt.mvc.settings.get=function(key){var settings=bkt.mvc.settings.getUserSettings();return settings[key];};bkt.mvc.settings.set=function(key,value){var settings=bkt.loadSetting('settings');settings[key]=value;bkt.storeSetting('settings',settings);};bkt.mvc.settings.showSetting=function(setting){switch(setting){case"#spellingVariants":$("form.bkt-settings .fieldset[data-field='spellingVariants'] a.change").click();break;}};$(document).ready(function(e){bkt.mvc.settings.init();});
var addthis_share;var addthis_config;bkt.mvc.share={};bkt.mvc.share.persistentID=location.href;bkt.mvc.share.addThisLoaded=false;bkt.mvc.share.toggleShareLinks=function(button){bkt.mvc.share.persistentID=$('.sharelinks-toolbox .object-view-menu__share-links-wrapper__details__items--input').last().val();};bkt.mvc.onShareClick=function(id){bkt.dialogs.informationBox(bkt.i18n.lookup("persistent_info"),{title:bkt.i18n.lookup("persistent_id"),near:id,width:$(".sharelinks-toolbox").width()});};bkt.mvc.downloadAnticlickDone=false;bkt.mvc.toggleDownloads=function(button){if(!bkt.mvc.downloadAnticlickDone){$(".downloads").onAntiClick(function(){$(".downloads").slideUp();$(button).removeClass("active");},{excludedElements:[button]});bkt.mvc.downloadAnticlickDone=true;}
if($(button).hasClass("active")){$(button).removeClass("active");$(".downloads").slideUp();}else{$(button).addClass("active");$(".downloads").css({top:0,right:$(window).width()-
($(button).offset().left+$(button).width())}).slideDown();}};
bkt.mvc.storable={};bkt.mvc.storable.showDownloadListOptions=function(link,namespace){var $link=$(link);var $linkWrapper=$link.parent();if($linkWrapper.hasClass("opened")){return;}
var $container=$("<div>").addClass("favourites__sortwrap__tools__infobox").addClass("narrowest");var $downloadLink=$("<a>").addClass("txt").getTranslation(namespace+"_download_list|txt",{attr:"title"});$container.append($downloadLink);$linkWrapper.addClass("opened");$linkWrapper.parent("div").append($container).removeAntiClick();window.setTimeout(function(){$container.onAntiClick(function(){$linkWrapper.removeClass("opened");$container.removeAntiClick().remove();});},10);$downloadLink.on('touchstart click',function(e){e.stopPropagation();bkt.mvc.storable.downloadList(namespace);});};bkt.mvc.storable.downloadList=function(namespace){var currentSelection=$("select.coll-filter").val();var colls=currentSelection==='.no-filter'?["all"]:currentSelection.split(",").map(function(item){return $.trim(item.replace(".",""));});var data=$.makeArray($(".favourites__results."+namespace+" div.favourites__results__item:visible")).map(function(el){return $(el).attr("data-metadata");});$("<form>").attr("action","/nl/"+bkt.getSkin()+"/"+bkt.getController()+"/download").attr("method","POST").append($("<input>").attr("type","hidden").attr("name","coll").val(colls[0])).append($("<input>").attr("type","hidden").attr("name","data").val(JSON.stringify(data))).appendTo("body").submit();};bkt.mvc.storable.showDownloads=function(link){var $row=$($(link).parents("div").parents("div").parents("div")[0]);var $container=$("<div>").addClass("favourites__sortwrap__tools__infobox");var $link=$(link);var $linkWrapper=$link.parent();var translateOpts={controller:"storable",coll:$row.attr("data-coll"),attr:"title"};var txtLink=$("<a>").addClass("txt").getTranslation("download|txt",translateOpts);var pdfLink=$("<a>").addClass("pdf").attr("target","_blank").getTranslation("download|pdf",translateOpts);var baseParams={identifier:$row.attr("data-identifier"),operation:"download",coll:$row.attr("data-coll")};if($linkWrapper.hasClass("opened")){return;}
txtLink.attr("href","/nl/api/resource?"+$.param($.extend(baseParams,{type:'objectocr'})));pdfLink.attr("href","/nl/api/resource?"+$.param($.extend(baseParams,{type:'pdf'})));if(!$('.favourites__results__item__tools').children('div').hasClass('favourites__sortwrap__tools__infobox')){$(link).parent("span").addClass("opened").parent("div").append($container).removeAntiClick();}
var isDddtitel=($row.attr("data-coll")==='ddd'&&$row.attr('data-identifier').match(/mpeg21$/));if($row.attr("data-coll")!=='boeken1'&&!isDddtitel){$container.append(txtLink);}
if($row.attr("data-coll")!=='anp'){$container.append(pdfLink);}
if($row.attr("data-coll")==='anp'||$row.attr("data-coll")==='boeken1'||isDddtitel){$container.addClass("narrow");}
window.setTimeout(function(){$container.onAntiClick(function(){$linkWrapper.removeClass("opened");$container.removeAntiClick().remove();});},10);};bkt.mvc.storable.showDenied=function(link){var text=bkt.i18n.lookup("not_available");bkt.dialogs.informationBox(text,{title:'Geen toegang',left:'30%',top:'30%'});};bkt.mvc.storable.makeTools=function(row,namespace,options){var toolsCell=$("<div>").addClass("tools favourites__results__item__tools-wrapper");var tools=$("<div>").addClass("favourites__results__item__tools");var removeLink=$("<a>").addClass("remove favourites__sortwrap__tools--remove icon icon--zz042-verwijderen").attr("data-testing-class","favourites__results__item__remove--link").getTranslation("remove",{controller:namespace,attr:"title",coll:row.attr("data-coll")});var downloadLink=$("<a>").addClass("download favourites__sortwrap__tools--download icon icon--zz006-download").getTranslation("download",{controller:"storable",coll:row.attr("data-coll"),attr:"title"}).attr("data-testing-class","favourites__results__item__download--link").on("click",function(){bkt.mvc.storable.showDownloads(this);});var deniedLink=$("<a>").addClass("favourites__sortwrap__tools--denied icon icon--zz039-locked").attr("data-testing-class","favourites__results__item__denied--link").on("click",function(){bkt.mvc.storable.showDenied(this);});removeLink.on("click",function(){bkt.storable.remove(row.attr("data-coll"),row.attr("data-identifier"),namespace);row.fadeOut({complete:function(){row.remove();}});bkt.mvc.storable.reinitCollFilter(namespace);location.reload();});if(typeof options.doNotDownload==="undefined")
{tools.append($("<span>").addClass("favourites__results__item__tools__link").append(downloadLink));}else
if(typeof options.iconClass!=="undefined")
{var externalLink=false;if(options.coll==='regio')
{externalLink=bkt.mvc.storable.createLink(options,'zb');}else
{externalLink=bkt.mvc.storable.createLink(options,'dbnl');}
tools.append($("<span>").addClass("favourites__results__item__tools__link").append(externalLink));}else{tools.append($("<span>").addClass("favourites__results__item__tools__link").append(deniedLink));}
tools.append($("<span>").addClass("favourites__results__item__tools__link").append(removeLink));toolsCell.append(tools);return toolsCell;};bkt.mvc.storable.createLink=function(options,type){var title=bkt.i18n.lookup(type+"_title");var link=$("<a target='_blank' title='"+title+"'>").addClass(options.iconClass).on("click",function(){var text=bkt.i18n.lookup(type+"_info").replace("[[LINK]]",options.link);bkt.dialogs.informationBox(text,{title:'',left:parseInt($(this).offset().left)+10,top:parseInt($(this).offset().top)+10});$('#'+type+'link').click(function(){$('#invisible-backdrop').hide();});});return link;};bkt.mvc.storable.sortByDateAdded=function(dir){var rows=[];$(".favourites__results.storable div[data-date-added]").each(function(i,row){rows.push({value:parseInt($(row).attr("data-date-added")),node:$(row).get(0)});});if(dir==='desc'){rows=rows.sort(function(a,b){return a.value-b.value;});}else{rows=rows.sort(function(a,b){return b.value-a.value;});}
for(var i in rows){$(".favourites__results.storable").prepend(rows[i].node);}};bkt.mvc.storable.sortByColumn=function(col,dir){var sortRows=[];$(".col-"+col).each(function(i,cell){sortRows.push({value:$(cell).text().trim(),node:$(cell).parent()[0]});});if(col==='2'){sortRows=sortRows.sort(function(a,b){return a.value.replace(/^\D+\d/,"").split("-").reverse().join("-").localeCompare(b.value.replace(/^\D+\d/,"").split("-").reverse().join("-"));});}else{sortRows=sortRows.sort(function(a,b){return a.value.toLowerCase().localeCompare(b.value.toLowerCase());});}
if(dir==='asc'){sortRows=sortRows.reverse();}
for(var i in sortRows){$(".favourites__results.storable").prepend(sortRows[i].node);}};bkt.mvc.storable.sortBy=function(select){var sort=$(select).val().split("-");var dir=sort[1];var field=sort[0];if(field==='dateadded'){bkt.mvc.storable.sortByDateAdded(dir);}else{bkt.mvc.storable.sortByColumn(sort[2],sort[3]);}};bkt.mvc.storable.reinitSortSelect=function(namespace){var coll=$("select.coll-filter").val();var select=$("select.sort-select");var currentSortation=select.val();select.find("option").remove();select.append($("<option>").val("dateadded-asc").attr("selected",currentSortation==="dateadded-asc").getTranslation(namespace+"_date_added_asc"));select.append($("<option>").val("dateadded-desc").attr("selected",currentSortation==="dateadded-desc").getTranslation(namespace+"_date_added_desc"));if(coll!=='.no-filter'){var colsWithValue=[];$(coll).each(function(){$(this).children(".favourites__results__item__title, .favourites__results__item__metadata").each(function(index){if($(this).text().trim()!==''&&colsWithValue.indexOf(index)===-1){colsWithValue.push(index);}});});for(var x in colsWithValue){var dirs=["asc","desc"];for(var y in dirs){var val=coll+"-col-"+colsWithValue[x]+"-"+dirs[y];select.append($("<option>").val(val).attr("selected",currentSortation===val).getTranslation("col_"+colsWithValue[x]+"_"+dirs[y],{controller:"storable",coll:coll.replace(".","").replace(/,.*$/,"")}));}}}
bkt.mvc.storable.sortBy(select);};bkt.mvc.storable.filterByColl=function(select,namespace){var list=$(".favourites__results."+namespace);list.find("div.favourites__results__item").hide();list.find($(select).val()).show().children().show().children().show().children().show();bkt.mvc.storable.reinitSortSelect(namespace);};bkt.mvc.storable.reinitCollFilter=function(namespace){var collFilter=$("select.coll-filter");var currentSelection=collFilter.val();var colls=["ddd","boeken","boeken1","dts","anp","regio"];var cnt={ddd:0,boeken:0,dts:0,anp:0,regio:0};collFilter.find("option").remove();var totalAmt=0;for(var i in colls){var coll=colls[i];var k=coll==='boeken1'?'boeken':coll;cnt[k]+=bkt.storable.count(coll,namespace);totalAmt+=bkt.storable.count(coll,namespace);}
collFilter.append($("<option>").attr("value",".no-filter").addClass("no-filter-option").html(bkt.i18n.lookup("favourites_coll_filter_all")+" ("+totalAmt+")"));for(var key in cnt){if(cnt[key]===0){continue;}
var val="."+key+(key==='boeken'?", .boeken1":"");collFilter.append($("<option>").attr("value",val).addClass("no-filter-option").attr("selected",currentSelection===val).html(bkt.i18n.lookup("favourites_coll_filter_"+key)+" ("+cnt[key]+")"));}
bkt.mvc.storable.filterByColl(collFilter,namespace);if(totalAmt===0){$(".favourites__results__empty-row").show();$("div.storables select").prop('disabled','disabled');$(".tools").hide();}};bkt.mvc.storable.show=function(namespace){var colls=["ddd","boeken","boeken1","dts","anp","regio"];var collMap={ddd:"kranten",boeken:"boeken",boeken1:"boeken1",dts:"tijdschriften",anp:"radiobulletins",regio:"regio"};var sortFields={};var totalAmt=0;var list=$(".favourites__results."+namespace);for(var i in colls){var coll=colls[i];var storables=bkt.storable.fetch(coll,namespace);totalAmt+=bkt.storable.count(coll,namespace);sortFields.title={dir:"no",selected:false};sortFields.date={dir:"asc",selected:true};for(var id in storables){var skin=collMap[coll];var params=bkt.mvc.urlparams,link;params.coll=coll;params.identifier=id;if(id.match(/dbnl/))
{link='http://resolver.kb.nl/resolve?urn='+id;}else
{link="/"+bkt.mvc.guilang+"/"+skin+"/view?"+$.param(params);}
if(coll==='regio'&&storables[id].objectlink!=undefined)
{link=storables[id].objectlink;}
var fields=[];fields.push(storables[id].title);if(storables[id].caption){fields.push(storables[id].caption);}
if(coll==='boeken'&&storables[id].seq){fields.push(storables[id].seq);}
if(coll==='dts'&&storables[id].volumeRemark){fields.push(storables[id].volumeRemark);}
if(storables[id].creator){sortFields.creator={dir:"no",selected:false};fields.push(storables[id].creator);}else{fields.push("");}
if(storables[id].subtitle){fields.push(storables[id].subtitle);}
var row=$("<div>").attr("data-identifier",id).attr("data-coll",coll).attr("data-date-added",storables[id].dateAdded).attr("data-metadata",JSON.stringify($.extend(storables[id],{coll:coll,skin:collMap[coll],id:id}))).addClass(coll).addClass("no-filter favourites__results__item");for(var j in fields){var cell=$("<div>").addClass("favourites__results__item__metadata").addClass("col-"+j);var value=parseInt(j)>0?fields[j]:(fields[j]||bkt.i18n.lookup("nullfield",{controller:"storable",coll:coll.replace(".","")}));var field=$("<div>").html(value).attr("title",value).addClass("favourites__results__item__text").attr("data-testing-id","favourites__results__item__metadata--col-"+j);if(parseInt(j)===0){cell=$("<div>").addClass("favourites__results__item__title").addClass("col-"+j);var ahref=$("<a>").addClass("favourites__results__item__title__link").attr("href",link).attr("data-testing-class","favourites__results__title--link").append($("<span>").addClass("favourites__results__item__icon icon icon--materiaal-"+(coll)).getTranslation("icon_title",{controller:"storable",coll:coll.replace(".",""),attr:"title"})).append(field);if(id.match(/dbnl/)||coll==="regio")
{$(ahref).attr("target","_blank");}
cell.append(ahref);}else{cell.html(field);}
row.append(cell);}
var options={};if(typeof storables[id]['id']!=="undefined"&&typeof storables[id]['bookid']!=='undefined'&&storables[id]['bookid'].match(/dbnl/)||storables[id]['coll']==='regio')
{options={"doNotDownload":"true","iconClass":"favourites__sortwrap__tools--external icon icon--zz041-external-link","link":link,"id":id,"coll":storables[id]['coll']};}else if((namespace==='favourites'||namespace==='visited')&&typeof storables[id]['donotdownload']!=='undefined')
{options={"doNotDownload":"true","coll":storables[id]['coll']};}
var tools=bkt.mvc.storable.makeTools(row,namespace,options);row.append(tools);list.append(row);}}
$("#content").on("click",function(){$("favourites__sortwrap__tools__link").removeClass("opened");});bkt.mvc.storable.reinitCollFilter(namespace);bkt.mvc.storable.reinitSortSelect(namespace);};bkt.mvc.storable.removeAll=function(ns){bkt.dialogs.confirm(bkt.i18n.lookup(ns+"_remove_all"),{onConfirm:function(){var currentSelection=$("select.coll-filter").val();var colls=currentSelection==='.no-filter'?["ddd","boeken","boeken1","dts","anp","regio"]:currentSelection.split(",").map(function(item){return $.trim(item.replace(".",""));});for(var i in colls){var storables=bkt[ns].fetch(colls[i]);for(var id in storables){bkt[ns].remove(colls[i],id);$("div[data-identifier='"+id+"']").remove();}}
bkt.mvc.storable.reinitCollFilter(ns);bkt.mvc.storable.reinitSortSelect(ns);},showBackdrop:true});};
bkt.mvc.setPresentationLevel=function(lvl){bkt.mvc.presentationSettings.presentationLevel=lvl;bkt.mvc.settings.set('presentationLevel',lvl);bkt.mvc.renderView(['results']);};bkt.mvc.progress={current:0,locator:false,percentageLocator:false,delay:0.7,step:1,fake:function(locator,percentageLocator,step){function fakeProgress(){if(bkt.mvc.progress.current+bkt.mvc.progress.step<100){var timeout=parseInt(bkt.mvc.progress.current*bkt.mvc.progress.delay);setTimeout(fakeProgress,timeout<10?10:timeout);bkt.mvc.progress.current+=bkt.mvc.progress.step;}
$(bkt.mvc.progress.locator).css({backgroundSize:bkt.mvc.progress.current+"% 100%"});$(bkt.mvc.progress.percentageLocator).html(bkt.mvc.progress.current+"%");}
$(locator).show();bkt.mvc.progress.locator=locator;bkt.mvc.progress.percentageLocator=percentageLocator;bkt.mvc.progress.current=0;bkt.mvc.progress.step=step;fakeProgress();}};bkt.mvc.filterizeCheckboxes=function(checkboxes,beforeNode,placeholder1,useLabels,before){var input=$("<input>").attr("type","text").addClass("facets-overlay__form__input-text").attr("data-testing-id","filter-lightbox--input");var placeholder=placeholder1||"TODO: i18n-ized placeholder";var aCheck=$.makeArray(checkboxes);var filterValues=[];for(var i in aCheck){var el=aCheck[i];filterValues.push({value:(useLabels?$(el).next().html().toLowerCase():el.value.toLowerCase()),node:$(el).parents()[0],box:el});}
function applyFilter(){for(var i=0;i<filterValues.length;i++){if(filterValues[i].value.indexOf(this.value)!==-1){$(filterValues[i].node).show();}else if(!filterValues[i].box.checked){$(filterValues[i].node).hide();}}}
if(!bkt.isTouchDevice()){input.on("keyup",applyFilter);}else{input.on("change",applyFilter);}
input.attr("placeholder",placeholder);if(before){$(beforeNode).before(input);}else{$(beforeNode).prepend(input);}
return{filterValues:filterValues,input:input};};bkt.mvc.listifyCheckboxes=function(filterValues,afterNode,listContainer){function sortedInsert(list,node){var position=parseInt($(node).attr("class").replace("value-",""));var nodes=$.makeArray($(list).find("div"));var nodeBefore=false;for(var i in nodes){var curPos=parseInt($(nodes[i]).attr("class").replace("value-",""));if(curPos>position){nodeBefore=nodes[i];break;}}
if(nodeBefore){$(nodeBefore).before(node);}else{list.append(node);}}
var picklist=$("<div>").addClass("picklist facets-overlay__facets-list-wrapper");var selectedList=listContainer.removeClass("list").addClass("picklist header__form__checkbox-list-checked-wrapper");for(var i in filterValues){if(!filterValues[i].box.checked){picklist.append(filterValues[i].node);}
$(filterValues[i].box).on("click",function(){if(this.checked){sortedInsert(selectedList,$(this).parents()[0]);}else{sortedInsert(picklist,$(this).parents()[0]);}
if(selectedList.find("div").length>0){selectedList.show();}else{selectedList.hide();}});}
if(afterNode){$(afterNode).after(picklist);}else{$(selectedList).before(picklist);}
if(selectedList.find("div").length>0){selectedList.show();}else{selectedList.hide();}
return picklist;};bkt.mvc.renderZones=function(img){var zones=img.attr("data-zones");var imghead=img.attr("data-imghead");if(typeof zones==="undefined"||typeof imghead==="undefined"){return;}
zones=$.parseJSON(zones);if(zones.length<2){return;}
function execute(_self){bkt.fetch(imghead,{success:function(data){if(data&&data.width&&_self.width>0&&_self.height>0&&zones.length>1){var canvas=$("<canvas>").attr("width",_self.width).attr("height",_self.height).get(0);var ctx=canvas.getContext('2d');var ratio=_self.width / data.width;$(_self).after(canvas).addClass("canvasized-thumbnail").removeAttr("style");ctx.fillStyle="rgba(254, 254, 86, 0.5)";ctx.drawImage(_self,0,0);var params=bkt.deparam(_self.src);if(typeof params.id==='undefined')
return;var imagePage=params.id.replace(/.*p(\d{3}):.*/,"$1");for(var i=0;i<zones.length-1&&i<20;i++){var zonePage=(zones[i].image||"").replace(/.*_(\d{3})_.*/,"$1");if(zonePage!==imagePage){continue;}
var x=parseInt(Math.ceil(zones[i].x*ratio));var y=parseInt(Math.ceil(zones[i].y*ratio));var w=parseInt(Math.floor(zones[i].w*ratio));var h=parseInt(Math.floor(zones[i].h*ratio));ctx.fillRect(x,y,w,h);}}}});}
if(img[0]&&img[0].complete){execute(this);}};bkt.mvc.slideAdvancedSearch=function(coll,link){var params={};if(bkt.mvc.isMobile){params.isMobile=bkt.mvc.isMobile;}
params.query=$(".simple-search form input[name='query']").val();if(bkt.mvc.urlparams.cql){params.cql=bkt.mvc.urlparams.cql;}
if(bkt.mvc.urlparams.facets){params.facets=bkt.mvc.urlparams.facets;}
if(coll){bkt.mvc.urlparams.coll=coll;}
bkt.mvc.renderPartial("advancedsearch",{callback:bkt.mvc.callbacks.advancedsearchAction,controller:"search",data:params,coll:coll});if($("#content").hasClass("has-top-panel-moved-down")){$("#content").css({paddingTop:0});};};bkt.mvc.toggleClip=function(button){var $btn=$(button);if($btn.hasClass("active")){$btn.removeClass("active");$("canvas#canvas").trigger("setState","default");}else{$btn.addClass("active");$("canvas#canvas").trigger("setState","clipping");}};$(document).ready(function(e){var $advancedSearch=false;bkt.mvc.isMobile=false;if($(window).width()<680&((typeof bkt.mvc.urlparams.coll!=='undefined'&&bkt.mvc.urlparams.coll==='anp')||(typeof bkt.mvc.skin!=='undefined'&&bkt.mvc.skin==='radiobulletins')))
{bkt.mvc.isMobile=true;}
if(bkt.mvc.urlparams.advancedSearch){bkt.mvc.advancedSearch.noSlide=true;bkt.mvc.slideAdvancedSearch(bkt.mvc.urlparams.coll);}
var step=12;if(bkt.mvc.urlparams.coll&&(bkt.mvc.urlparams.coll==='ddd'||bkt.mvc.urlparams.coll==='platform')){step=2;}
bkt.mvc.progress.fake(".progress",".progress .percentage",step);$('.basic-query[name="query"]').keyup(function(){bkt.storeSetting('query',this.value);});$("body").on("click","#share-i",function(){bkt.mvc.share.toggleShareLinks("#share-i");});$(".object-view-side-bar-wrapper").on("click",".js-share-i2",function(){bkt.mvc.onShareClick(".js-share-i2");});$(".object-view-menu__share-links-wrapper").on("click","#share-i3",function(){bkt.mvc.onShareClick("#share-i3");});$(".object-view-top-block__detail-menu__metadata").on("click",".js-share-i2",function(){bkt.mvc.onShareClick(".js-share-i2");})
$('.object-view-top-block input.toggle-checkbox-radio').on('click',function(e){var wasChecked=this.checked;$('.object-view-top-block input.toggle-checkbox-radio:checked').prop("checked",false);this.checked=wasChecked;});if($(window).width()>679){$('.object-view-menu__share-links-wrapper').on('click',function(e){e.stopPropagation();});$('.object-view-menu__citation-wrapper').on('click',function(e){e.stopPropagation();});$('.object-view-menu__downloads-wrapper').on('click',function(e){e.stopPropagation();});$("body").click(function(e){if($('.object-view-menu__list__item__link').filter(e.target).length===0&&$(e.target).attr("type")!=="checkbox"){$('.object-view-top-block input.toggle-checkbox-radio').prop("checked",false);}});}
$('.overlay__box--info').on('click',function(e){e.stopPropagation();});$("#toggle-checkbox-radio--header__nav").on("change",function(){$(".toggle-checkbox-radio--detail-menu__nav").prop("checked",false);$(".object-view-top-block__detail-menu--label").text("Details").removeClass("icon--sluiten").addClass("icon--chevron-down");});$("#toggle--header-inner-wrapper--simple-search").on("click",function(){$(".toggle-checkbox-radio--detail-menu__nav").prop("checked",false);$(".object-view-top-block__detail-menu--label").text("Details").removeClass("icon--sluiten").addClass("icon--chevron-down");});var query=bkt.loadSetting('query');if(typeof query==="string"&&query!=='')
{if(bkt.mvc.urlparams.advancedSearch)
{setTimeout(function(){var fieldType=$("form > div.cc12 > div.field.text").attr('data-name');var advInput='input[name="search['+fieldType+'][value][0]"]';$(advInput).attr('value',query);},800);}else
{$('.basic-query[name="query"]').attr('value',query);}
bkt.storeSetting('query','');}
bkt.mvc.toastForMobile=function(e,toastMessage){if(e.originalEvent){$(".object-view-menu__toast p").html(toastMessage);$(".object-view-menu__toast").show("fast");if(bkt.toastTimeoutID){clearTimeout(bkt.toastTimeoutID);}
bkt.toastTimeoutID=window.setTimeout(function(){$(".object-view-menu__toast").hide("fast");},2000);}};toastMessage="Het gevonden artikel wordt getoond";$("body").on("click","#ga-naar-treffer",function(e){bkt.mvc.toastForMobile(e,toastMessage);});$(".toggle--header-inner-wrapper--advanced-search").click(function(){bkt.mvc.slideAdvancedSearch(bkt.mvc.urlparams.coll);$("#toggle-checkbox-radio--header-inner-wrapper--advanced-search").prop("checked",true);bkt.mvc.addResizeForPlaceholder(true);$advancedSearch=true;setRegioText();$("html, body").animate({scrollTop:0},0);return false;});if(bkt.isTouchDevice()){$('#toggle--header-inner-wrapper--simple-search').click(function(){$("#js-simple-search-inputfield").toggleClass("simple-search__focus");if($('#js-simple-search-inputfield').hasClass('simple-search__focus')){$("#js-simple-search-inputfield").trigger("select");}else{$('#js-simple-search-inputfield').blur();}});};function setPlaceholderText(){var $attributeValue;var $inputField=$("#js-simple-search-inputfield");if($("#homepage-content").length){if(window.matchMedia("(max-width: 499px)").matches){$attributeValue=$inputField.attr("data-placeholder-medium");}else if(window.matchMedia("(min-width: 500px) and (max-width: 679px)").matches){$attributeValue=$inputField.attr("data-placeholder-long");}else if(window.matchMedia("(min-width: 680px) and (max-width: 724px)").matches){$attributeValue=$inputField.attr("data-placeholder-medium");}else{$attributeValue=$inputField.attr("data-placeholder-long");}}else{if(window.matchMedia("(max-width: 479px)").matches){$attributeValue=$inputField.attr("data-placeholder-short");}else if(window.matchMedia("(min-width: 680px) and (max-width: 899px)").matches){$attributeValue=$inputField.attr("data-placeholder-short");}else if(window.matchMedia("(min-width: 900px) and (max-width: 1199px)").matches){$attributeValue=$inputField.attr("data-placeholder-medium");}else if(window.matchMedia("(min-width: 1200px)").matches){$attributeValue=$inputField.attr("data-placeholder-long");}else{$attributeValue=$inputField.attr("data-placeholder-medium");}}
$inputField.attr("placeholder",$attributeValue);};function setRegioText(){var $collectionField=$(".icon--header__collection-select-list--materiaal-regio");if($advancedSearch===true){if(window.matchMedia("(max-width: 679px)").matches){$collectionField.text(bkt.i18n.lookup("tab|regio_small"));}else if(window.matchMedia("(min-width: 1340px) and (max-width: 1469px)").matches){$collectionField.text(bkt.i18n.lookup("tab|regio_small"));}else{$collectionField.text(bkt.i18n.lookup("tab|regio"));}}else if($("#homepage-content").length){if(window.matchMedia("(max-width: 889px)").matches){$collectionField.text(bkt.i18n.lookup("tab|regio_small"));}else{$collectionField.text(bkt.i18n.lookup("tab|regio"));}}else{if(window.matchMedia("(max-width: 1239px)").matches){$collectionField.text(bkt.i18n.lookup("tab|regio_small"));}else{$collectionField.text(bkt.i18n.lookup("tab|regio"));}}};bkt.mvc.addResizeForPlaceholder=function(data){$(window).on("resize",setRegioText);if(data===false){$(window).on("resize",setPlaceholderText);}else{$(window).off("resize",setPlaceholderText);}};setPlaceholderText();setRegioText();bkt.mvc.popUpNewsletter=function(){var _countVisits=bkt.loadSetting("pop-up-newsletter__count-visits");var _tresholdVisits=3;var _days=30;var _now=new Date().getTime();var _setupTime=bkt.loadSetting("pop-up-newsletter__set-up-time");var _expirationPeriod=1000*60*60*24*_days;var _urlHTML="/nl/platform/index/getnewsletterpopup";var _urlHref="https://formulieren.kb.nl/delpher_aanmelden";if(isNaN(_countVisits)){_countVisits=1;}else if(_countVisits<_tresholdVisits){_countVisits++;if(_countVisits===_tresholdVisits){bkt.storeSetting("pop-up-newsletter__show",true);}}
bkt.storeSetting("pop-up-newsletter__count-visits",_countVisits);if(_setupTime!==null&&_now-_setupTime>_expirationPeriod){bkt.deleteSetting("pop-up-newsletter__set-up-time");bkt.storeSetting("pop-up-newsletter__show",true);}
if((_countVisits>=3)&&(bkt.loadSetting("pop-up-newsletter__show")===true)){$("body").append("<section id='pop-up-newsletter' class='pop-up pop-up--newsletter'></section>");$("#pop-up-newsletter").load(_urlHTML,function(){$("#pop-up-newsletter__cta").click(function(){bkt.storeSetting("pop-up-newsletter__show","never");window.location.href=_urlHref;});$(".pop-up").on("click",".pop-up__button-close",function(){bkt.storeSetting("pop-up-newsletter__show",false);bkt.storeSetting("pop-up-newsletter__set-up-time",_now);$(this).parent().parent().remove();});});}};});
bkt.mvc.viewer={};bkt.mvc.viewer.blockedByNotice=false;bkt.mvc.viewer.panelsUp=false;bkt.mvc.viewer.panelsSliding=false;bkt.mvc.viewer.verticalPanelsDocked=false;bkt.mvc.viewer.panelsOut=false;bkt.mvc.viewer.horizontalPanelsDocked=false;bkt.mvc.viewer.ocrTogglePixelTweak=navigator.userAgent.toLowerCase().indexOf('firefox')>-1?9:8;bkt.mvc.viewer.sideblockStates=[];bkt.mvc.viewer.widthThreshold=200;bkt.mvc.viewer.heightThreshold=250;bkt.mvc.viewer.articlePersistentIdentifier=false;bkt.mvc.viewer.orientationchange=false;bkt.mvc.viewer.getInnerHeight=function(){var innerHeight,borderHeight=2;var buttonsContainerHeight=0;if(window.matchMedia("(max-width: 679px)").matches){buttonsContainerHeight=$(".buttons-container").outerHeight();}
if(bkt.mvc.viewer.panelsUp){innerHeight=$(window).height();}else{if(window.matchMedia("(max-width: 679px)").matches){innerHeight=$(window).height()-
$(".object-view-top-block").outerHeight()-
$(".footer").outerHeight()-
$(".layout-top-block").outerHeight()-
buttonsContainerHeight;}else{innerHeight=$(window).height()-
$(".object-view-top-block").outerHeight()-
$(".footer").outerHeight()-
$(".layout-top-block").outerHeight();}}
return innerHeight;};bkt.mvc.viewer.getInnerWidth=function(){var sidePanelWidth=0;if(window.matchMedia("(max-width: 679px)").matches){sidePanelWidth=0;}else{sidePanelWidth=$(".object-view-side-bar.viewer").width()-parseInt($(".object-view-side-bar.viewer").css("padding-left"));}
if(bkt.mvc.viewer.panelsOut){return $(window).width()-
$(".right-panel:visible:not(.out)").width();}else{return $(window).width()-
sidePanelWidth-
$(".right-panel:visible:not(.out)").width();}};bkt.mvc.viewer.recalibrate=function(){if(!$('input.toggle-checkbox-radio--header-inner-wrapper--simple-search').is(':checked')){$(".view-content, .object-view-side-bar.viewer").css("height",bkt.mvc.viewer.getInnerHeight()+"px");}
$(".view-content").css("width",bkt.mvc.viewer.getInnerWidth()+"px");if(!bkt.mvc.viewer.panelsOut&&$(window).width()>679){$(".view-content").css("width",bkt.mvc.viewer.getInnerWidth()-40+"px");}
$("canvas#canvas").attr("height",$(".view-content").height()).attr("width",$(".view-content").width()).trigger("recalibrate");if(imageviewerClientCurrentScaleFactor===imageviewerClientInitialScaleFactor){$("#canvas").trigger("scaleToFullPage",[$(".view-content").height(),$(".view-content").width()]);}else{}
$(".right-panel").css({height:bkt.mvc.viewer.getInnerHeight()+"px",top:$(".view-content").offset().top});$(".right-panel .bkt-mvc-ocrAction").css({height:$(".right-panel").height()-
$(".ocr-disclaimer:visible").height()-
parseInt($(".ocr-disclaimer:visible").css("padding-top"))-
parseInt($(".ocr-disclaimer:visible").css("padding-bottom"))-6});if($(window).width()<=bkt.mvc.viewer.widthThreshold){$(".object-viewer__ocr-button").hide();$(".view-content a.button").addClass("lo-res");$(".button.lo-res-text-toggle").show();}else{$(".view-content a.button").removeClass("lo-res");$(".button.lo-res-text-toggle").hide();$(".object-viewer__ocr-button").show();$(".fs-link").show();$(".scroll-lock").show();$("#js-button-zoom--in").show();$("#js-button-zoom--out").show();}
if(typeof gview!=='undefined'&&gview.init){if(!$("#gview input").is(":focus")){gview.init();}}
$(".object-viewer__button--page-next").css({right:"24px"});if(!$(".thumbnail-view").hasClass("thumbnails-visible")){if(bkt.mvc.viewer.panelsUp){$(".object-viewer__button--page-prev, .object-viewer__button--page-next").css({"margin-bottom":($(document).height()/ 2)+"px"});}else{$(".object-viewer__button--page-prev, .object-viewer__button--page-next").css({"margin-bottom":($(".view-content").height()/ 2)+"px"});}
$(".object-viewer__button--page-prev, .object-viewer__button--page-next").show();}
$(".dock-horizontal-panel, .dock-vertical-panels").show();if($(window).height()<440){$(".header__nav__list").css({"columns":"2"});$(".header__nav__list__item__link").css({"overflow":"visible"});$(".object-view-menu").css({"z-index":"2"});$(".header__nav__list__item:last-of-type").css({"border-bottom":".0625em solid #d8eceb"});}else{$(".header__nav__list").css({"columns":"1"});$(".header__nav__list__item__link").css({"overflow":"hidden"});$(".object-view-menu").css({"z-index":"3"});$(".header__nav__list__item:last-of-type").css({"border-bottom":"none"});}
if($(".fs-link").hasClass("vert-up")&&$(".fs-link").hasClass("horiz-out")){if(window.matchMedia("(max-width: 679px)").matches){$(".fs-link").attr("title",bkt.i18n.lookup("close_fullscreen_link_small-screen"));}else{$(".fs-link").attr("title",bkt.i18n.lookup("close_fullscreen_link"));}
$("#content").addClass("is-full-screen");$("#content").removeClass("has-top-panel-moved-down");}
else{$(".fs-link").attr("title",bkt.i18n.lookup("open_fullscreen_link"));$("#content").removeClass("is-full-screen");if(!$(".fs-link").hasClass("vert-up")){$("#content").addClass("has-top-panel-moved-down");}}};bkt.mvc.viewer.scrollSideBlock=function(sideBlockHeader,sideBlock,sidePanel,options){var lastTop=-1;var panelBottomExtra=0;if(sidePanel.hasClass("bkt-mvc-ocrAction")&&$(".ocr-disclaimer").is(":visible")){panelBottomExtra=$(".ocr-disclaimer").height()+
parseInt($(".ocr-disclaimer").css("padding-top"))+
parseInt($(".ocr-disclaimer").css("margin-bottom"));}
var panelBottom=sidePanel.position().top+sidePanel.height();function slidingScroll(){var currentTop=$(sideBlockHeader).position().top;var currentBottom=sideBlock.position().top+sideBlock.height()+
parseInt(sideBlock.css('padding-top'))+parseInt(sideBlock.css('padding-bottom'));if(currentBottom>panelBottom-panelBottomExtra&&currentTop>sidePanel.position().top+20&&lastTop!==sidePanel.scrollTop()){lastTop=sidePanel.scrollTop();sidePanel.scrollTop(sidePanel.scrollTop()+20);setTimeout(slidingScroll,10);}}
slidingScroll();};bkt.mvc.viewer.reinitSideblockHeaders=function(){$(".js-object-view-side-bar__heading").off("click").on("click",function(){var transitionDuration=400;var dataLocator=$(this).attr("data-locator");if(dataLocator==="h3.pagebuttons-header"){transitionDuration=0;};if($(this).hasClass("collapsed")){var _self=this;$(this).siblings().slideDown(transitionDuration);setTimeout(function(){bkt.mvc.viewer.scrollSideBlock(_self,$(_self).parent("div"),$(".object-view-side-bar .object-view-side-bar-inner"));},250);$(this).removeClass("collapsed");}else{$(this).siblings().slideUp(transitionDuration);$(this).addClass("collapsed");}
$(this).addClass("changed-after-pageload");});for(var i in bkt.mvc.viewer.sideblockStates){if(!bkt.mvc.viewer.sideblockStates[i].locator){continue;}
var datalocator_tag='h3[data-locator="'+bkt.mvc.viewer.sideblockStates[i].locator+'"]';if($(bkt.mvc.viewer.sideblockStates[i].locator).hasClass("changed-after-pageload")){continue;}
if(bkt.mvc.viewer.sideblockStates[i].collapsed){$(datalocator_tag).addClass('collapsed').next().hide();}else{$(datalocator_tag).removeClass('collapsed').next().show();}}
$(".right-panel").addClass("out");};bkt.mvc.viewer.startTopPanelUp=function(callback1){var callback=callback1||function(){};$("#content").css({paddingTop:"0px"});$("#content").css({marginTop:"0px"});$(".fs-link").addClass("vert-up");$(".layout-top-block").css({position:"fixed",zIndex:3,top:0-$(".layout-top-block").outerHeight()-$(".object-view-top-block").outerHeight()});$(".object-view-top-block").addClass("sliding").css({top:0-$(".layout-top-block").outerHeight()-$(".object-view-top-block").outerHeight()});$(".footer").hide();bkt.mvc.viewer.panelsUp=true;callback();};bkt.mvc.viewer.slideTopPanelUp=function(callback1){if(bkt.mvc.viewer.panelsSliding||bkt.mvc.viewer.panelsUp||bkt.mvc.viewer.verticalPanelsDocked){return;}
bkt.mvc.viewer.panelsSliding=true;var callback=callback1||function(){};var canvasTopOffset=$(".view-content").offset().top;$(".layout-top-block").css({position:"fixed",zIndex:3}).animate({top:-canvasTopOffset-$(".layout-top-block").outerHeight()},{duration:800});$(".object-view-top-block").addClass("sliding").css({top:$(".layout-top-block").outerHeight()}).animate({top:-canvasTopOffset},{duration:800,complete:function(){bkt.mvc.viewer.panelsSliding=false;}});$("#content").css({paddingTop:canvasTopOffset}).css({marginTop:0}).removeClass("has-top-panel-moved-down").animate({paddingTop:0},{duration:800,complete:function(){bkt.mvc.viewer.recalibrate();}});$(".fs-link").addClass("vert-up");bkt.mvc.viewer.panelsUp=true;callback();};bkt.mvc.viewer.slideTopPanelDown=function(callback1){if(bkt.mvc.viewer.panelsSliding||!bkt.mvc.viewer.panelsUp){return;}
bkt.mvc.viewer.panelsSliding=true;var callback=callback1||function(){};$(".layout-top-block").css({zIndex:3}).show().animate({top:0},{complete:function(){bkt.mvc.viewer.panelsSliding=false;if($("body").hasClass("is-active-advanced-search")){$(this).css({position:"relative"});}
callback();},duration:800});$(".object-view-top-block").css({top:0-$(".object-view-top-block").outerHeight()}).animate({top:$(".layout-top-block").outerHeight()},{duration:800,complete:function(){$(this).css({marginTop:0});$(".object-viewer__button--page-prev, .object-viewer__button--page-next").css({"margin-bottom":($(".view-content").outerHeight()/ 2)+"px"});}});var canvasTopOffset;canvasTopOffset=$(".layout-top-block").outerHeight()+$(".object-view-top-block").outerHeight();$("#content").css({marginTop:0}).addClass("has-top-panel-moved-down").removeClass("is-full-screen").animate({paddingTop:canvasTopOffset},{duration:800,complete:function(){if($("body").hasClass("is-active-advanced-search")){$(this).css({paddingTop:0});}else if($('input.toggle-checkbox-radio--header-inner-wrapper--advanced-search').is(':checked')){$(this).css({paddingTop:0});}else{$(this).css({paddingTop:$(".layout-top-block").outerHeight()});}
bkt.mvc.viewer.recalibrate();}});bkt.mvc.viewer.panelsUp=false;};bkt.mvc.viewer.dockVerticalPanels=function(){if(bkt.mvc.viewer.verticalPanelsDocked){bkt.mvc.viewer.verticalPanelsDocked=false;bkt.mvc.viewer.slideTopPanelUp(bkt.mvc.viewer.recalibrate);$(".dock-vertical-panels").removeClass("docked").getTranslation("open_vertical_panel",{attr:"title"});$(".object-view-page").css({height:"100%"});}else if(bkt.mvc.viewer.panelsUp){bkt.mvc.viewer.slideTopPanelDown(bkt.mvc.viewer.dockVerticalPanels);}else{bkt.mvc.viewer.verticalPanelsDocked=true;$(".fs-link").removeClass("vert-up");$(".dock-vertical-panels").addClass("docked").getTranslation("close_vertical_panel",{attr:"title"});$(".footer, .object-view-top-block").removeClass("sliding");$(".layout-top-block, .object-view-top-block").css({position:"default"});$("#content > .viewer, #content > .viewer").css({marginTop:0});bkt.mvc.viewer.recalibrate();}};bkt.mvc.viewer.slideHorizontalPanels=function(duration){duration=duration===undefined?800:duration;if(bkt.mvc.viewer.panelsOut){bkt.mvc.viewer.panelsOut=false;$(".dock-horizontal-panel").removeClass("docked").getTranslation("close_horizontal_panel",{attr:"title"});$(".fs-link").removeClass("horiz-out");if($(window).width()<=bkt.mvc.viewer.widthThreshold&&$(".right-panel").css("display")!=="none"&&!$(".right-panel").hasClass("out")){$(".right-panel").css({position:"absolute",right:"0px"}).animate({left:$(".object-view-side-bar").width()+"px"},{duration:duration,complete:function(){$(this).width($(window).width()-$(this).offset().left);}});}
$(".object-view-side-bar.viewer").removeClass("docked").addClass("sliding").animate({left:0},{duration:duration,complete:function(){$(this).removeClass("sliding");bkt.mvc.viewer.recalibrate();}}).find(".object-view-side-bar-inner").show();}else{bkt.mvc.viewer.panelsOut=true;$(".dock-horizontal-panel").addClass("docked").getTranslation("open_horizontal_panel",{attr:"title"});$(".fs-link").addClass("horiz-out");$(".object-view-side-bar.viewer").addClass("sliding").animate({left:-$(".object-view-side-bar.viewer").width()-parseInt($(".object-view-side-bar.viewer").css("padding-left"))},{duration:duration,complete:function(){$(this).removeClass("sliding").addClass("docked").find(".object-view-side-bar-inner").hide();}});if($(window).width()<=bkt.mvc.viewer.widthThreshold&&!$(".right-panel").hasClass("out")){$("#canvas").hide();if($(window).width()-$(".right-panel").width()>1&&$(".right-panel").css("right")==="0px"){$(".right-panel").width($(window).width());$(".right-panel").css({left:""}).animate({right:($(window).width()-$(".right-panel").width()-1)+"px"},{duration:duration,complete:function(){}});}else{$(".right-panel").animate({left:"0px"},{duration:800});}}
bkt.mvc.viewer.recalibrate();}
if($(".object-viewer__ocr-button").hasClass("active")){if(bkt.mvc.viewer.panelsOut){$(".right-panel").css({width:"40%"});}else{$(".right-panel").width((window.innerWidth-$(".object-view-side-bar").width())*0.4);}
$(".object-viewer__ocr-button").css({right:$(".right-panel").width()});$("div.ocr-disclaimer").width($(".right-panel").width()-40);}
if(!bkt.isTouchDevice()){$(".button.dock-horizontal-panel, .button.dock-vertical-panels, .button.lo-res-text-toggle, .object-viewer__button--page-prev, .object-viewer__button--page-next").hide();}};bkt.mvc.viewer.startHorizontalPanelOut=function(){$(".dock-horizontal-panel").addClass("docked").getTranslation("open_horizontal_panel",{attr:"title"});bkt.mvc.viewer.panelsOut=true;$(".fs-link").addClass("horiz-out");$(".object-view-side-bar.viewer").addClass("docked").css({left:-$(".object-view-side-bar.viewer").width()-parseInt($(".object-view-side-bar.viewer").css("padding-left"))}).find(".object-view-side-bar-inner").hide();bkt.mvc.viewer.recalibrate();};bkt.mvc.viewer.getViewportPercentage=function(){return parseInt(($(".view-content").outerHeight()*$(".view-content").width())/
($(window).height()*$(window).width())*100);};bkt.mvc.viewer.lastMovement=new Date().getTime();bkt.mvc.viewer.mouseCanvasPos={x:0,y:0,overButton:false};$(document).ready(function(){$(".fs-link, .dock-vertical-panels, .dock-horizontal-panel, .scroll-lock, .page-prev, .page-next, .ocr-toggle, #js-button-zoom--in, #js-button-zoom--out").on({mouseover:function(){$(this).addClass("hover");},mouseup:function(){$(this).removeClass("hover");},mouseleave:function(){$(this).removeClass("hover");}});$(".view-content .object-viewer__ocr-button, .view-content .button, .object-viewer__button--page-prev, .object-viewer__button--page-next, #js-button-zoom--in, #js-button-zoom--out").on({mouseover:function(){bkt.mvc.viewer.mouseCanvasPos.overButton=true;},mouseup:function(){bkt.mvc.viewer.mouseCanvasPos.overButton=false;},mouseleave:function(){bkt.mvc.viewer.mouseCanvasPos.overButton=false;}});$(".object-viewer__button--page-prev, .object-viewer__button--page-next").on("click",bkt.mvc.viewer.storeObjectPanelState);});bkt.mvc.viewer.updateCursorPos=function(e){bkt.mvc.viewer.lastMovement=new Date().getTime();bkt.mvc.viewer.mouseCanvasPos.x=e.clientX;bkt.mvc.viewer.mouseCanvasPos.y=e.clientY;if(bkt.mvc.viewer.mouseCanvasPos.y>$(".view-content").offset().top&&bkt.mvc.viewer.mouseCanvasPos.x>$(".view-content").offset().left){$(".view-content .button:not(.lo-res-text-toggle)").show();if(!$(".thumbnail-view").hasClass("thumbnails-visible")){if(bkt.mvc.viewer.panelsUp){$(".object-viewer__button--page-prev, .object-viewer__button--page-next").css({"margin-bottom":($(document).height()/ 2)+"px"});}else{$(".object-viewer__button--page-prev, .object-viewer__button--page-next").css({"margin-bottom":($(".view-content").height()/ 2)+"px"});}
if($(window).width()>bkt.mvc.viewer.widthThreshold){$(".view-content .button:not(.lo-res-text-toggle), .view-content .object-viewer__ocr-button, .object-viewer__button--page-prev, .object-viewer__button--page-next").fadeIn();}else{$(".view-content .button.lo-res-text-toggle, .object-viewer__button--page-prev, .object-viewer__button--page-next").show();}
if($(window).width()<=bkt.mvc.viewer.widthThreshold&&!$(".right-panel").hasClass("out")){$(".object-viewer__button--page-prev, .object-viewer__button--page-next").hide();}}}};bkt.mvc.viewer.monitorViewButtons=function(){var timeout=null;var isTouchDevice=$(".device-type--touch-device").length;clearTimeout(timeout);timeout=setTimeout(function(){if(!bkt.mvc.viewer.mouseCanvasPos.overButton&&!isTouchDevice){$(".view-content .button, .object-viewer__button--page-prev, .object-viewer__button--page-next").stop(true,true).fadeOut();if(!$(".object-viewer__ocr-button").hasClass("active")){$(".view-content .object-viewer__ocr-button").stop(true,true).fadeOut();}}},500);};bkt.mvc.viewer.toggleFullScreen=function(){var isPhone=$(".is-phone").length;if(bkt.mvc.viewer.panelsOut){if(bkt.mvc.viewer.panelsUp&&bkt.mvc.urlparams.viewmode!=="geboortedag"){bkt.mvc.viewer.slideHorizontalPanels();}
bkt.mvc.viewer.slideTopPanelDown(bkt.mvc.viewer.dockVerticalPanels);$(this).attr("title",bkt.i18n.lookup("open_fullscreen_link"));}else if(bkt.mvc.urlparams.viewmode!=="geboortedag"){bkt.mvc.viewer.slideHorizontalPanels();}
if(!bkt.mvc.viewer.panelsUp){bkt.mvc.viewer.verticalPanelsDocked=false;$(".view-content .button.dock-vertical-panels").removeClass("docked").getTranslation("open_vertical_panel",{attr:"title"});bkt.mvc.viewer.slideTopPanelUp(bkt.mvc.viewer.recalibrate);$(".object-view-page").css({height:"auto"});}
if($(".object-viewer__ocr-button").hasClass("active")){bkt.mvc.viewer.toggleOcr($(".object-viewer__ocr-button"));}
$(this).attr("title",bkt.i18n.lookup("close_fullscreen_link"));};bkt.mvc.viewer.replaceBreadcrumbPPNs=function(){$(".back-to-list span[data-field='ppn']").each(function(idx,el){var matches=$(el).html().trim().match(/[0-9X]{9}/g);for(var i in matches){var ppn=matches[i];bkt.fetch("/"+bkt.getLanguage()+"/api/dddtitle",{data:{ppn:ppn,fields:"title"},success:function(data){if(data.length>0&&data[0].title){$(el).html($(el).html().replace(data[0].ppn,data[0].title));$(el).parents("a").attr("title",$(el).parents("a").attr("title").replace(data[0].ppn,data[0].title));}}});}});};bkt.mvc.viewer.storeHorizontalPanelState=function(){bkt.storeSetting("dock-horizontal-panel",$(".dock-horizontal-panel.button").hasClass("docked"));};bkt.mvc.viewer.storeObjectPanelState=function(){bkt.storeSetting("dock-vertical-panels",$(".dock-vertical-panels.button").hasClass("docked"));var collapsedSideblocks=$.makeArray($(".toggle-sideblock")).map(function(el,i){return{locator:$(el).attr("data-locator"),collapsed:$(el).hasClass("collapsed")};});bkt.storeSetting("collapsed-sideblocks",collapsedSideblocks);bkt.storeSetting("highlights-are-on",$(".toggle-highlight.button").hasClass("active"));bkt.mvc.viewer.storeHorizontalPanelState();};bkt.mvc.viewer.toggleHighlights=function(button){if($(button).hasClass("active")){$(button).removeClass("active");$("canvas#canvas").trigger("setHighlights",false);$("em.highlight, .hit").addClass("highlight--is-disabled");$(button).attr("title",bkt.i18n.lookup("enable_highlight",{"coll":bkt.getCollForSkin(bkt.getSkin()),"controller":"view"}));}else{$(button).addClass("active");$("canvas#canvas").trigger("setHighlights",true);$("em.highlight, .hit").removeClass("highlight--is-disabled");$(button).attr("title",bkt.i18n.lookup("disable_highlight",{"coll":bkt.getCollForSkin(bkt.getSkin()),"controller":"view"}));}};bkt.mvc.viewer.closeOcrForResize=function(){if($(".right-panel").hasClass("out")){return;}
$(".right-panel").addClass("out").css({position:"fixed",right:-($(".right-panel").width()+3)+"px"});$(".object-viewer__ocr-button").css({right:0}).removeClass("active");if($(".object-viewer__ocr-button").length>0){$(".object-viewer__ocr-button").attr("src",$(".object-viewer__ocr-button").attr("src").replace("close","open"));}
$(".button.lo-res-text-toggle").removeClass("active");};bkt.mvc.viewer.toggleOcr=function(button){if($(button).hasClass("active")){$(".object-viewer__button--page-next").css({right:$(".right-panel").width()+24+"px"});$(button).removeClass("active");$(".right-panel").css({left:"",position:"fixed"}).addClass("out").animate({right:-($(".right-panel").width()+3)+"px"},{duration:650});if($(button).hasClass("object-viewer__ocr-button")){console.log("let's animate: to the right");console.log("right-panel.width = "+$(".right-panel").width());$(button).animate({right:0},{duration:650});}
$(".bkt-mvc-objectresultsbuttonsAction .zoom-to-article").trigger("click");if($(window).width()<=bkt.mvc.viewer.widthThreshold){$(".bkt-mvc-imagetoolsAction, .imageclip.button, .zoom-to-article.button").show();$(button).attr("title",bkt.i18n.lookup("show_text"));}else{$(".object-viewer__button--page-next").animate({right:"24px"},{duration:650});}
bkt.mvc.viewer.recalibrate();}else{$(button).addClass("active");if($(window).width()<=bkt.mvc.viewer.widthThreshold){$(".right-panel").css({width:$(".view-content").width()+"px"});$(".bkt-mvc-imagetoolsAction, .imageclip.button, .zoom-to-article.button, .ocr-disclaimer").hide();$(button).attr("title",bkt.i18n.lookup("show_image"));}else{$(".ocr-disclaimer").show();if(bkt.mvc.viewer.panelsOut){$(".right-panel").css({width:"40%"});}else{$(".right-panel").css({width:((window.innerWidth-$(".object-view-side-bar").width())*0.4)+"px"});}
$(".object-viewer__button--page-next").animate({right:$(".right-panel").width()+24+"px"},{duration:650});$(".object-viewer__button--page-next").animate({right:"24px"},{duration:0});}
$(".right-panel").css({display:"block",position:"fixed",top:$(".view-content").offset().top+"px",height:$(".view-content").outerHeight()+"px"}).animate({right:"0"},{duration:650,complete:function(){$(".right-panel").removeClass("out").css("position","absolute");bkt.mvc.viewer.recalibrate();$(".bkt-mvc-objectresultsbuttonsAction .zoom-to-article").trigger("click");}});if($(button).hasClass("object-viewer__ocr-button")){console.log("let's animate: to the left");$(button).animate({right:$(".right-panel").width()+"px"},{duration:650});}
bkt.mvc.renderPartial(bkt.mvc.urlparams.coll==='ddd'?'pageocr':'ocr',{controller:'view',data:bkt.mvc.urlparams,callback:bkt.mvc.urlparams.coll==='ddd'?bkt.mvc.callbacks.pageocrAction:bkt.mvc.callbacks.ocrAction});$("div.ocr-disclaimer").width($(".right-panel").width()-40);}
if($("#canvas").css("display")==="none"){$("#canvas").show();}};bkt.mvc.viewer.zoomToArticle=function(articleZoomLink,recalibrateY){var preparams=bkt.deparam(articleZoomLink.attr("stored-href").replace(/.*\?(.*)#.*/,"$1"));if(!preparams.pres){return;}
var params=preparams.pres.imageviewer;var resiz=($("canvas#canvas").width()/ parseFloat(params.w));$("canvas#canvas").trigger('scaleBy',[parseFloat(params.s)*resiz,false,false,true,{callback:function(scale){var before=parseFloat(params.s)*resiz;var newResiz=resiz;if(before!==scale){newResiz=scale / parseFloat(params.s);}
for(var p in params){params[p]*=newResiz;}
if(articleZoomLink.is("[data-original-y-pos]")){if(recalibrateY){params.y=parseInt(articleZoomLink.attr("data-original-y-pos")*scale)-parseInt($("canvas#canvas").outerHeight()/ 2);}else{params.y=parseInt((parseInt(articleZoomLink.attr("data-original-y-pos")))*parseFloat(params.s)-20);}}
$("canvas#canvas").trigger('moveTo',[{x:parseInt(params.x),y:parseInt(params.y)},false,false]);if(parseFloat(scale)>1.0&&recalibrateY){$("canvas#canvas").trigger('scaleBy',[1.0,false,false,true]);}
$("canvas#canvas").trigger('paint');}}]);};bkt.mvc.viewer.showGoogleDisclaimerInfo=function(el){bkt.dialogs.informationBox(bkt.i18n.lookup("google_disclaimer_text",{controller:"view",coll:"boeken1"}),{title:bkt.i18n.lookup("google_disclaimer_context",{controller:"view",coll:"boeken1"}),near:el});};bkt.mvc.viewer.checkForEmptyQuery=function(event){var val=$("#objectsearch-value").val();if(val===''){event.preventDefault();bkt.dialogs.flashMessage(bkt.i18n.lookup("empty_query_message"),{delay:2.5});return false;}};bkt.mvc.viewer.initialize=function(){$(".footer").remove();if(!bkt.isTouchDevice()){$(document).on("mousemove",bkt.mvc.viewer.updateCursorPos);}
$(".dock-horizontal-panel").getTranslation("close_horizontal_panel",{attr:"title"});$(".dock-vertical-panels").getTranslation("close_vertical_panel",{attr:"title"});$(".scroll-lock").getTranslation("scroll_lock_on",{attr:"title"});if(bkt.isTouchDevice()){$(window).on("resize",function(){bkt.mvc.viewer.closeOcrForResize();bkt.mvc.viewer.recalibrate();$(".view-content, .object-view-side-bar.viewer").css("height",bkt.mvc.viewer.getInnerHeight()+$(".layout-top-block").outerHeight()-50+"px");if($('input.toggle-checkbox-radio--header-inner-wrapper--simple-search').is(':checked')){$("canvas#canvas").attr("height",$(".view-content").height()).attr("width",$(".view-content").width()).trigger("recalibrate");}});$(window).on("orientationchange",function(e){bkt.mvc.viewer.closeOcrForResize();bkt.mvc.viewer.recalibrate();$(".view-content, .object-view-side-bar.viewer").css("height",bkt.mvc.viewer.getInnerHeight()+$(".layout-top-block").outerHeight()-50+"px");if($('input.toggle-checkbox-radio--header-inner-wrapper--simple-search').is(':checked')){$("canvas#canvas").attr("height",$(".view-content").height()).attr("width",$(".view-content").width()).trigger("recalibrate");}});}else{$(window).on("resize",function(){bkt.mvc.viewer.closeOcrForResize();bkt.mvc.viewer.recalibrate();bkt.mvc.resizeDelay=10;});}
if($(window).width()<=bkt.mvc.viewer.widthThreshold||$(window).height()<=bkt.mvc.viewer.heightThreshold||bkt.loadSetting("dock-vertical-panels")===false){bkt.mvc.viewer.startTopPanelUp(bkt.mvc.viewer.recalibrate);if(window.matchMedia("(max-width: 679px)").matches){$(".fs-link").attr("title",bkt.i18n.lookup("close_fullscreen_link_small-screen"));}else{$(".fs-link").attr("title",bkt.i18n.lookup("close_fullscreen_link"));}
$("#content").addClass("is-full-screen");$("#content").removeClass("has-top-panel-moved-down");}else{bkt.mvc.viewer.dockVerticalPanels();$(".fs-link").attr("title",bkt.i18n.lookup("open_fullscreen_link"));}
bkt.deleteSetting("dock-vertical-panels");if(bkt.loadSetting("collapsed-sideblocks")){bkt.mvc.viewer.sideblockStates=bkt.loadSetting("collapsed-sideblocks");bkt.mvc.viewer.reinitSideblockHeaders();bkt.deleteSetting("collapsed-sideblocks");}
$(".dock-vertical-panels").on("click",bkt.mvc.viewer.dockVerticalPanels);if(!location.href.match(/#info/)&&bkt.loadSetting("dock-horizontal-panel")!==false&&($(window).width()<=bkt.mvc.viewer.widthThreshold||$(window).height()<=bkt.mvc.viewer.heightThreshold||bkt.loadSetting("dock-horizontal-panel")===true)){bkt.mvc.viewer.startHorizontalPanelOut();bkt.deleteSetting("dock-horizontal-panel");}
if($(window).width()<=bkt.mvc.viewer.widthThreshold){$(".button.lo-res-text-toggle").show();}
$(".dock-horizontal-panel").on("click",bkt.mvc.viewer.slideHorizontalPanels);$(".fs-link").on("click",bkt.mvc.viewer.toggleFullScreen);$(".toggle-ocr a").on("click",bkt.mvc.viewer.storeObjectPanelState);$("#object-search").submit(function(e){bkt.mvc.viewer.checkForEmptyQuery(e);bkt.mvc.viewer.storeObjectPanelState();});$(".scroll-lock").on("click",function(){if($(this).hasClass("active")){$(this).removeClass("active").getTranslation("scroll_lock_on",{attr:"title"});$("canvas#canvas").trigger("setScrollLock",false);bkt.storeSetting("scroll-lock-viewer",false);}else{$(this).addClass("active").getTranslation("scroll_lock_off",{attr:"title"});$("canvas#canvas").trigger("setScrollLock",true);bkt.storeSetting("scroll-lock-viewer",true);}});if(bkt.loadSetting("scroll-lock-viewer")===true){$(".scroll-lock").addClass("active").getTranslation("scroll_lock_off",{attr:"title"});}
$(".object-viewer__ocr-button, .lo-res-text-toggle").on("click",function(){bkt.mvc.viewer.toggleOcr(this);});if(location.href.match(/#info/)){$(".details-header.collapsed").trigger("click");}
if(location.href.match(/#ocr/)){$(".object-viewer__ocr-button").trigger("click");}};bkt.mvc.viewer.handleImageError=function(){$(".progress, .progress-container").hide();if($(".image-error-message").length===0){var errorDiv=$("<div>").addClass(".image-error-message").css({paddingTop:"10%"}).append($("<h1>").getTranslation("sorry").css({width:"50%",margin:"20px auto"})).append($("<p>").getTranslation("image_error").css({width:"50%",margin:"0 auto",color:"#333"})).css({height:$("canvas#canvas").attr("height")+"px"}).css({width:$("canvas#canvas").attr("width")+"px"}).css({backgroundColor:$("canvas#canvas").css("background-color")});$("canvas#canvas").before(errorDiv).hide();$("h3.imagetools-header").parent("div").hide();}};$(document).on("ready",function(e){bkt.mvc.viewer.replaceBreadcrumbPPNs();if($(".view-content").length===0||bkt.mvc.viewer.blockedByNotice){bkt.deleteSetting("dock-horizontal-panel");return;}
$(".object-view-top-block__detail-menu--label").text("Details");$(".object-view-top-block__detail-menu--label").click(function(){if($(this).hasClass("icon--chevron-down")){$(this).text("Sluiten");$(this).removeClass("icon--chevron-down");$(this).addClass("icon--sluiten");}else if($(this).hasClass("icon--sluiten")){$(this).text("Details");$(this).removeClass("icon--sluiten");$(this).addClass("icon--chevron-down");}});$('.toggle-checkbox-radio--header-inner-wrapper--advanced-search').on('click',function(e){if(!$('input.toggle-checkbox-radio--header-inner-wrapper--advanced-search').is(':checked')){bkt.mvc.viewer.recalibrate();}});$(window).on("orientationchange",function(e){bkt.mvc.viewer.orientationchange=true;if(bkt.isTouchDevice()&&$(window).width()>679&&$('input.toggle-checkbox-radio--header-inner-wrapper--advanced-search').is(':checked')){bkt.mvc.viewer.recalibrate();}});bkt.mvc.viewer.initialize();});
bkt.mvc.visited={};bkt.mvc.visited.init=function(){var settings=bkt.loadSetting('settings');if(settings&&settings.storeViewedPages!=='on'){return;}
$(".layout-top-block .options .storables-context-menu a.visited").removeClass("header__nav__list__item__link--disabled").attr("href",$(".layout-top-block .options .storables-context-menu a.visited").attr("data-href"));if(bkt.getController()==='visited'){bkt.mvc.storable.show('visited');}
if(bkt.getController()==='view'||bkt.getController()==='gview'){bkt.mvc.visited.addFromView();}};bkt.mvc.visited.addFromView=function(){if(!bkt.mvc.urlparams.coll){return;}
var metadata=JSON.parse($("#object").attr("data-metadata"));bkt.visited.add(bkt.mvc.urlparams.coll,metadata.objectlevelId,metadata);};bkt.mvc.visited.addDBNL=function(article)
{var metadata=JSON.parse($(article).attr('data-metadata'));bkt.visited.add('boeken',metadata.objectlevelId,metadata);};bkt.mvc.visited.addRegio=function(article)
{var metadata=JSON.parse($(article).attr('data-metadata'));bkt.visited.add('regio',metadata.objectlevelId,metadata);};$(document).ready(function(e){bkt.mvc.visited.init();});
bkt.dialogs=bkt.dialogs||{};bkt.dialogs.confirm=function(msg,options){var opts=options||{},confirmText=opts.confirmText||bkt.i18n.lookup("yes"),cancelText=opts.confirmText||bkt.i18n.lookup("no"),onConfirm=opts.onConfirm||function(){},onCancel=opts.onCancel||function(){},showBackdrop=opts.showBackdrop||false;function hideDialog(){$("#confirm, .overlay__backdrop, .overlay__backdrop-invisible").fadeOut();}
$("#confirm .message").html(msg);$("#confirm button.confirm").html(confirmText).off("click").on("click",function(){hideDialog();onConfirm();});$("#confirm button.cancel, #confirm a.close-link").html(confirmText).off("click").on("click",function(){hideDialog();onCancel();});$("#confirm button.cancel").html(cancelText);$("#confirm").fadeIn();if(showBackdrop){$(".overlay__backdrop").show().off("click").on("click",function(){hideDialog();onCancel();});}else{$(".overlay__backdrop-invisible").show().off("click").on("click",function(){hideDialog();onCancel();});}};
bkt.dialogs=bkt.dialogs||{};bkt.dialogs.mouseOverFlash=false;bkt.dialogs.flashMonitorUp=false;bkt.dialogs.flashMonitorTimeout=100;bkt.dialogs.flashMonitorSec2Interval=parseInt(1000 / bkt.dialogs.flashMonitorTimeout,10);bkt.dialogs.flashDelay=50;bkt.dialogs.monitorFlashMessage=function(){if(!bkt.dialogs.mouseOverFlash){if(bkt.dialogs.flashDelay>0){bkt.dialogs.flashDelay-=1;}else{$("#flash").fadeOut();}}
setTimeout(bkt.dialogs.monitorFlashMessage,bkt.dialogs.flashMonitorTimeout);};bkt.dialogs.flashMessage=function(text,options){var opts=options||{};bkt.dialogs.flashDelay=(opts.delay||5)*bkt.dialogs.flashMonitorSec2Interval;bkt.dialogs.flashDelayAfterMouseOut=(opts.delayAfterMouseOut||1)*bkt.dialogs.flashMonitorSec2Interval;$("#flash .text").html(text);$("#flash").removeClass("with-close-link");$("#flash").off("mouseover").on("mouseover",function(){$(this).addClass("with-close-link");bkt.dialogs.mouseOverFlash=true;}).off("mouseout").on("mouseout",function(){bkt.dialogs.mouseOverFlash=false;bkt.dialogs.flashDelay=bkt.dialogs.flashDelayAfterMouseOut;}).fadeIn();if(!bkt.dialogs.flashMonitorUp){$("#flash").on("click",function(){$(this).fadeOut();});bkt.dialogs.monitorFlashMessage();bkt.dialogs.flashMonitorUp=true;}};
bkt.dialogs=bkt.dialogs||{};bkt.dialogs.getInfoboxBounds=function(){return{x:$(".overlay__box--info").offset().left,y:$(".overlay__box--info").offset().top,w:$(".overlay__box--info").width()+
parseInt($(".overlay__box--info").css("padding-left"),10)+
parseInt($(".overlay__box--info").css("padding-right"),10)+2,h:$(".overlay__box--info").height()+
parseInt($(".overlay__box--info").css("padding-top"),10)+
parseInt($(".overlay__box--info").css("padding-bottom"),10)+2};};bkt.dialogs.correctInfoboxPosition=function(){if(!$(".overlay__box--info").is(":visible")){return;}
var bounds=bkt.dialogs.getInfoboxBounds(),diffX=bounds.x+bounds.w-$(window).width(),diffY=bounds.y+bounds.h-($(window).scrollTop()+$(window).height());if(diffX>0){$(".overlay__box--info").css("left",(parseInt($(".overlay__box--info").css("left"),10)-diffX)+"px");}
if(diffY>0){$(".overlay__box--info").css("top",(parseInt($(".overlay__box--info").css("top"),10)-diffY)+"px");}
bounds=bkt.dialogs.getInfoboxBounds();if(bounds.x<0){$(".overlay__box--info").css("left",0);if($(".overlay__box--info").width()+
parseInt($(".overlay__box--info").css("padding-left"),10)+
parseInt($(".overlay__box--info").css("padding-right"),10)>$(window).width()){$(".overlay__box--info").css("width",$(window).width());}}
if(bounds.y<0){$(".overlay__box--info").css("top",0);if($(".overlay__box--info").height()+
parseInt($(".overlay__box--info").css("padding-top"),10)+
parseInt($(".overlay__box--info").css("padding-bottom"),10)>$(window).height()){$(".overlay__box--info").css("height",$(window).height());}}};bkt.dialogs.informationBox=function(msg,options){var opts=options||{},useOverlay=opts.useOverlay===false?false:true;$(".overlay__box--info .text").html(msg);$(".overlay__box--info .title").html(opts.title||"");$(".overlay__box--info .close-link").off("click").on("click",function(){$(".overlay__box--info").fadeOut();$(".overlay__backdrop-invisible").hide();});$(".overlay__box--info").fadeIn();if(opts.near){$(".overlay__box--info").css({left:$(opts.near).offset().left+
$(opts.near).width()-
$(".overlay__box--info").width()-
parseInt($(".overlay__box--info").css("padding-left"),10)-
parseInt($(".overlay__box--info").css("padding-right"),10)});$(".overlay__box--info").css({top:$(opts.near).offset().top+
$(opts.near).height()});}else{if(opts.top){$(".overlay__box--info").css('top',opts.top);}
if(opts.left){$(".overlay__box--info").css('left',opts.left);}}
if(opts.width){$(".overlay__box--info").css('width',opts.width);}else{$(".overlay__box--info").css('width','');}
if(opts.height){$(".overlay__box--info").css('height',opts.height);}else{$(".overlay__box--info").css('height','');}
if(useOverlay){$(".overlay__backdrop-invisible").show().off("click").on("click",function(){$(this).hide();$(".overlay__box--info").fadeOut();});}
$(".overlay__box--info a").on("click",function(){$(".overlay__box--info").fadeOut();});bkt.dialogs.correctInfoboxPosition();};$(window).on("resize",bkt.dialogs.correctInfoboxPosition);var ngvn=ngvn||{};ngvn.favourites={};ngvn.favourites.inOverview=false;ngvn.favourites.list=[];ngvn.favourites.template="";ngvn.favourites.sortField="title";ngvn.favourites.sortDirection="";ngvn.favourites.toggle=function(resultDiv){if(bkt.favourites.isFavourite("ngvn",resultDiv.attr("data-identifier"))){bkt.favourites.remove("ngvn",resultDiv.attr("data-identifier"));resultDiv.removeClass("is-favourite");if(ngvn.favourites.inOverview){ngvn.favourites.removeFromList(resultDiv);}
var controlElement="button.button-icon-favourites";var languageResourceElementLabel="favourite-control-tooltip";$(".storables-notice .link").html(bkt.i18n.lookup("show_your_favourites")+" ("+bkt.favourites.countAll()+")");}else{bkt.favourites.add("ngvn",resultDiv.attr("data-identifier"),JSON.parse(resultDiv.attr("data-metadata")));resultDiv.addClass("is-favourite");var controlElement="button.button-icon-favourites";var languageResourceElementLabel="favourite-control-next-tooltip";}
var languageResourceElement={coll:"ngvn",controller:"results"};var text=bkt.i18n.lookup(languageResourceElementLabel,languageResourceElement);var control=resultDiv.find(controlElement);control.attr("title",text);control.attr("aria-label",text);$(".favourites-notice a.icon").focus().keyup(function(event){if(event.keyCode===27)
{$(this).click();}});};ngvn.favourites.highlightSelected=function(identifier){if(bkt.favourites.isFavourite("ngvn",identifier)){$("[data-identifier='"+identifier+"']").addClass("is-favourite");$("[data-identifier='"+identifier+"'] button").attr("title",bkt.i18n.lookup("favourite-control-next-tooltip",{coll:"ngvn",controller:"results"}));$(".bkt-mvc-viewAction").addClass("is-favourite");}};ngvn.favourites.initSortlinks=function(){$("#sortfields input").off("change").on("change",function(){var params=bkt.deparam($(this).val()),text=$("[for='"+this.id+"']").html();$("#sortfields input.selected").removeClass("selected");$("#sortfields").removeClass("visible");ngvn.favourites.sortField=params.sortfield.replace(/desc$/,"");ngvn.favourites.sortDirection=params.sortfield.replace(ngvn.favourites.sortField,"");ngvn.favourites.sortField=ngvn.favourites.sortField.replace("collectionnl","collectionStringNL").replace("collectionen","collectionStringEN").replace(/^date$/,"startDate");$("[for='sortfield']").html(text);ngvn.favourites.list=ngvn.favourites.list.sort(ngvn.favourites.sortCompare);ngvn.favourites.renderList(0,36);});};ngvn.favourites.removeFromList=function(resultDiv){var id=resultDiv.attr("data-identifier");resultDiv.css({overflow:"hidden"}).animate({width:"0",height:"0"},{complete:function(){$(this).remove()}});for(var i in ngvn.favourites.list){if(ngvn.favourites.list[i].id===id){ngvn.favourites.list.splice(i,1);break;}}
ngvn.favourites.updateFavouriteCount();};ngvn.favourites.renderList=function(){for(var i=0;i<ngvn.favourites.list.length;i++){var id=ngvn.favourites.list[i].id;if(typeof ngvn.favourites.list[i].recordNode==="undefined"){var record=$(ngvn.favourites.template),favourite=ngvn.favourites.list[i].favourite;record.attr("data-identifier",id);record.attr("data-metadata",JSON.stringify(favourite));record.find(".thumbnail .bg-thumb").attr("style","background-image: url("+favourite.thumbnail+")");record.find(".title").html(favourite.title);if(!favourite.creator||favourite.creator===""){var field=record.find("[data-field-name='creator']");field.prev().remove();field.remove();}else{record.find("[data-field-name='creator']").html(favourite.creator);}
if(!favourite.created||favourite.created===""){var field=record.find("[data-field-name='created']")
field.prev().remove();field.remove();}else{record.find("[data-field-name='created']").html(favourite.created);}
record.find("[data-field-name='collectionStringNL']").html(favourite.collectionStringNL);record.find("[data-field-name='collectionStringEN']").html(favourite.collectionStringEN);var identifier=id;if(typeof ngvn.favourites.list[i].favourite.identifier!=='undefined'){identifier=ngvn.favourites.list[i].favourite.identifier;}
var imageIndex=ngvn.favourites.list[i].favourite.imageindex;if(typeof imageIndex==='undefined'||imageIndex==0){imageIndex='';}else{imageIndex="&pres[imageindex]="+imageIndex;}
record.find("a").attr("href","/"+bkt.getLanguage()+"/geheugen/view?identifier="+encodeURIComponent(identifier)+imageIndex);ngvn.favourites.list[i].recordNode=record;}
console.info(ngvn.favourites.list[i].favourite.title);console.info(ngvn.favourites.list[i].favourite.originalStartDate);$("#favourites").append(ngvn.favourites.list[i].recordNode);ngvn.favourites.highlightSelected(id);}
var timerIdentifier=setInterval(function(){$(".results.progress").hide();clearInterval(timerIdentifier);},1);};ngvn.favourites.sortCompare=function(a,b){var fieldA=a.favourite[ngvn.favourites.sortField]||"",fieldB=b.favourite[ngvn.favourites.sortField]||"";fieldA=fieldA.toString();fieldB=fieldB.toString();if(ngvn.favourites.sortDirection==="desc"){return fieldB.toLowerCase().localeCompare(fieldA.toLowerCase());}
return fieldA.toLowerCase().localeCompare(fieldB.toLowerCase());};ngvn.favourites.initializeList=function(){var favourites=bkt.favourites.fetch("ngvn");bkt.mvc.callbacks.sortlinksAction();ngvn.favourites.initSortlinks();ngvn.favourites.inOverview=true;$("#favourites").html("");for(var id in favourites){ngvn.favourites.list.push({id:id,favourite:favourites[id]});}
ngvn.favourites.list=ngvn.favourites.list.sort(ngvn.favourites.sortCompare);ngvn.favourites.renderList();ngvn.favourites.updateFavouriteCount();$(".bkt-mvc-resultsAction > article:first-of-type .result__thumbnail__link").attr("id","accessibility-skip-target-from-header");var containerSkipLinks=".bkt-mvc-resultsAction";addEventHandlerToSkipLinks(containerSkipLinks);};ngvn.favourites.updateFavouriteCount=function(){switch(ngvn.favourites.list.length){case 0:$(".bkt-mvc-breadcrumbsAction").html(bkt.i18n.lookup("empty-favourites-list",{coll:"ngvn"}));break;case 1:$(".bkt-mvc-breadcrumbsAction").html(ngvn.favourites.list.length+" "+bkt.i18n.lookup("populated-favourites-list",{coll:"ngvn"}));break;default:$(".bkt-mvc-breadcrumbsAction").html(ngvn.favourites.list.length+" "+bkt.i18n.lookup("populated-favourites-list",{coll:"ngvn",sgpl:"pl"}));}};
var ngvn=ngvn||{};ngvn.header={};function scrollMonitor(){var checkbox=$("#menu-button");var menuItem=$(".menu__list__item__link");var breakPoint=null;if(checkbox.prop("checked")){checkbox.attr("checked",false);setTabIndexByState(checkbox,menuItem,breakPoint);}};var debounceScrollMonitor=debounce(function(){scrollMonitor();},250);$(document).on("scroll",debounceScrollMonitor);$(document).on("ready",function(){ngvn.setQueryPlaceholder();$("#menu-button").on("focus",function(){$("#menu-button-label").addClass("focused");}).on("blur",function(){$("#menu-button-label").removeClass("focused");});setMenuAndMainAnimation();setMenuSearchBox();setMenuItemContent();var containerSkipLinks="#top-bar";addEventHandlerToSkipLinks(containerSkipLinks);closeFavouritesNotification();});ngvn.setQueryPlaceholder=function(){if($(window).width()>1320){$("#query-input").attr("placeholder",bkt.i18n.lookup("search_hint",{coll:"ngvn"}));}else{$("#query-input").attr("placeholder",bkt.i18n.lookup("search_hint_short",{coll:"ngvn"}));}};$(window).on("resize",ngvn.setQueryPlaceholder);var focusEnabled=0;var focusDisabled=-1;function setTabIndexByScreenWidth(item,subitem,breakpoint){console.log("setTabIndexByScreenWidth");if(breakpoint!==null){if(window.matchMedia(breakpoint).matches){item.attr("tabindex",focusEnabled);}
else{item.attr("tabindex",focusDisabled);}}};function setTabIndexByState(item,subitem,breakpoint){if(item.prop("checked")){subitem.attr("tabindex",focusEnabled);}
else{subitem.attr("tabindex",focusDisabled);}};function setMenuAndMainAnimation(){'use strict';var sEvent='click touchstart';var kEvent='keydown';var main=$('#content-body');var menu=$('#menu');var resultsNavigation=$('.results-navigation');var filterboxResultsKeywords=$('.filterbox__plain-text--results-keywords');var filterboxFeedback=$('.filterbox__feedback-wrapper');var indexNav=$('.content-header-index-nav');var checkbox=$("#menu-button");var label=$("#menu-button-label");var menuItem=$(".menu__list__item__link");setTabIndexByState(checkbox,menuItem);function addClassesAndSetTabs(){if(!menu.hasClass("menu-has-animation"))
{menu.addClass("menu-has-animation");}
if(!main.hasClass("main-has-animation"))
{main.addClass("main-has-animation");}
if(!filterboxFeedback.hasClass("filterbox__feedback-wrapper-has-animation"))
{filterboxFeedback.addClass("filterbox__feedback-wrapper-has-animation");}
if(!resultsNavigation.hasClass("results-navigation-has-animation"))
{resultsNavigation.addClass("results-navigation-has-animation");}
if(!filterboxResultsKeywords.hasClass("filterbox__plain-text--results-keywords-has-animation"))
{filterboxResultsKeywords.addClass("filterbox__plain-text--results-keywords-has-animation");}
if(!indexNav.hasClass("content-header-index-nav-has-animation"))
{indexNav.addClass("content-header-index-nav-has-animation");}
setTabIndexByState(checkbox,menuItem);};function setTitlesAndAriaLabels(){checkbox.prop('checked',!checkbox.prop("checked"));if(checkbox[0].checked){var languageResourceElementLabel="menu-control-next-tooltip";}else{var languageResourceElementLabel="menu-control-tooltip";}
var languageResourceElement={coll:"ngvn"};var text=bkt.i18n.lookup(languageResourceElementLabel,languageResourceElement);var control=window["menu-button-label"];control.title=text;console.log(text);control.setAttribute("aria-label",text);addClassesAndSetTabs();}
label.on(sEvent,function(e){console.log("sEvent addClassesAndSetTabs");e.preventDefault();setTitlesAndAriaLabels();});label.on(kEvent,function(e){console.log("kEvent addClassesAndSetTabs");if(e.keyCode===13||e.keyCode===32){e.preventDefault();setTitlesAndAriaLabels();}});$(window).resize(function(){if(menu.hasClass("menu-has-animation"))
{menu.removeClass("menu-has-animation");}
if(main.hasClass("main-has-animation"))
{main.removeClass("main-has-animation");}
if(filterboxFeedback.hasClass("filterbox__feedback-wrapper-has-animation"))
{filterboxFeedback.removeClass("filterbox__feedback-wrapper-has-animation");}
if(filterboxResultsKeywords.hasClass("filterbox__plain-text--results-keywords-has-animation"))
{filterboxResultsKeywords.removeClass("filterbox__plain-text--results-keywords-has-animation");}
if(indexNav.hasClass("content-header-index-nav-has-animation"))
{indexNav.removeClass("content-header-index-nav-has-animation");}});}
function setMenuSearchBox(){'use strict';var sEvent='click touchstart';var kEvent='keydown';var checkbox=$("#search-box-toggle");var label=$("#label-for-search-box-toggle");checkbox.on(sEvent,function(){if(checkbox.prop('checked')){$('#query-input').focus();}});label.on(kEvent,function(e){console.log("kevent");console.log("e.keycode = "+e.keyCode);if(e.keyCode===13){checkbox.prop('checked',!checkbox.prop("checked"));e.preventDefault();if(checkbox.prop('checked')){$('#query-input').focus();}}});}
function setMenuItemContent(){var $menuItemContent;var $menuItem=$("#menu .menu__list .menu__list__item:last-child .menu__list__item__link");if(window.matchMedia("(max-width: 799px)").matches){$menuItemContent=$menuItem.attr("data-menuitem-content-short");}else{$menuItemContent=$menuItem.attr("data-menuitem-content");}
$menuItem.html($menuItemContent);}
function closeFavouritesNotification(){var sEvent='click touchstart';var kEvent='keydown';var element='.close-link';$(element).on(sEvent,function(e){e.preventDefault();bkt.favourites.closeNotice();});$(element).on(kEvent,function(e){if(e.keyCode===13){e.preventDefault();bkt.favourites.closeNotice();}});}
$(window).on("resize",setMenuItemContent);function debounce(func,wait){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;func.apply(context,args);};var callNow=!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args);};};
$(document).on("ready",function(){$(".page-wrapper .collection-preview").each(function(i,div){bkt.fetch($(div).attr("data-href"),{success:function(html){$(div).html(html);$(div).find(".pending").removeClass("pending");$(div).find("article").addClass("collection-preview-result");$(div).find("article img.thumbnail__image.browse-result__thumbnail__image").each(function(){$(this).attr("src",$(this).attr("src").replace("maxw=264","maxw=301"));});}});});var labelsContainer=".main-theme-overview-wrapper";var labelElement=".theme-overview-section__sub-heading-toggle";addEventHandlerToLabels(labelsContainer,labelElement);function handleTabindex(){var mql=window.matchMedia("(max-width: 819px)");mql.addListener(_injectProperTabindex);var checkboxInstance=$(".main-theme-overview-wrapper .theme-overview-section__sub-heading-toggle"),tabIndexTrue=0,tabIndexFalse=-1;function _injectProperTabindex(){var tabIndexValue=(mql.matches?tabIndexTrue:tabIndexFalse);checkboxInstance.prop("tabindex",tabIndexValue);}
_injectProperTabindex();};handleTabindex();$(".page-content .content-header .content-header__heading").attr("id","accessibility-skip-target-from-header");$("a.accessibility-skip-link").on("keydown",function(event){if(event.keyCode==13||event.keyCode==32){event.preventDefault();$("#accessibility-skip-target-from-header, section.overview-item a").first().focus();}});});$(window).on("load",function(event){var fragmentIdentifier=window.location.hash;if(fragmentIdentifier&&window.location.pathname.indexOf("/collectie/")>0)
{$(document).scrollTop($(fragmentIdentifier).offset().top-$("header").height());}});$(window).on("hashchange",function(event){var fragmentIdentifier=window.location.hash;if(fragmentIdentifier&&window.location.pathname.indexOf("/collectie/")>0)
{$(document).scrollTop($(fragmentIdentifier).offset().top-$("header").height());}});
$(document).on("ready",function(){$(".theme-preview").each(function(i,div){bkt.fetch($(div).attr("data-href"),{success:function(html){$(div).html(html);$(div).find(".pending").removeClass("pending");}});});});
bkt.mvc.callbacks.breadcrumbsAction=function(){function rerender(){var params=bkt.deparam($(this).attr("data-href"));delete(params.page);if(!params.facets){params.facets={};}
bkt.mvc.renderView(['paginate','results','resultsCount','facets','breadcrumbs','sortlinks'],params);}
$(".bkt-mvc-breadcrumbsAction a").each(function(i,el){var href=$(el).attr("href");$(el).removeAttr("href").attr("data-href",href).on("click",rerender);});};
bkt.mvc.callbacks.ngvn=bkt.mvc.callbacks.ngvn||{};bkt.mvc.callbacks.browseAction=function(){var amountOfCols,resizeDelay=-1,imagesLoading=$(".bkt-mvc-browseAction .result.pending .thumbnail img").toArray(),redestributing=false,loading=true,batchMax=60,maxPages=Math.ceil(parseInt($("input[name='numberOfRecords']").val())/ 36),batchCount=0;$(window).scrollTop(0);$("#content-body .bkt-mvc-browseAction").on("click",function(event){var element=event.target;var href;if(element.hasAttribute("href")){href=element.getAttribute("href");}else if(element.parentElement.hasAttribute("href")){href=element.parentElement.getAttribute("href");}
if(href){var publicationObjectParameters=bkt.deparam(href);var parameters=bkt.deparam(location.search);parameters.page=publicationObjectParameters.page;parameters.identifier=publicationObjectParameters.identifier;history.replaceState(null,null,'?'+$.param(parameters));}});function pollImagesLoaded(callback){$("#pending-overlay").fadeIn("slow");for(var x in imagesLoading){if(imagesLoading[x].complete){imagesLoading.splice(x,1);}}
if(imagesLoading.length>0){setTimeout(function(){pollImagesLoaded(callback)},10);}else{callback();}}
function getAmountOfCols(){var referenceWidth=parseInt(bkt.cssProp("width","result-column")),viewportWidth=$(".bkt-mvc-browseAction").width(),colAmount=parseInt(Math.ceil(viewportWidth / referenceWidth));resizeDelay=-1;return colAmount;}
function getLowestCol(){var cols=$(".result-column").toArray(),lowestHeight=-1,lowestIdx=0;for(var i in cols){if(lowestHeight===-1||lowestHeight>$(cols[i]).position().top+$(cols[i]).height()){lowestIdx=i;lowestHeight=$(cols[i]).position().top+$(cols[i]).height();}}
return parseInt(lowestIdx);}
function sharpenWideImage(result){var image=$(result).find(".thumbnail img");image.attr("src",image.attr("src").replace("maxw=264","maxw=545"));}
function appendImages(currentResults){var resultColumns=$(".result-column").toArray();for(var i in currentResults){if($(".bkt-mvc-browseAction .result").length===0&&resultColumns.length>2){$(".wide-column").prepend($(currentResults[i]).removeClass("pending"));sharpenWideImage(currentResults[i]);}else{$(resultColumns[getLowestCol()]).append($(currentResults[i]).removeClass("pending"));}}
loading=false;$("#pending-overlay").fadeOut("slow");if(window.location.search){var parameters=bkt.deparam(window.location.search);if(parameters.identifier){window.location.hash=parameters.identifier;}}}
function redestributeImages(){var results=$(".bkt-mvc-browseAction .result").removeClass("pending").detach().toArray(),wideColumn=$("<div id='result-column-0' class='wide-column'>");redestributing=true;amountOfCols=getAmountOfCols();$(".bkt-mvc-browseAction").html(wideColumn);for(var i=0;i<amountOfCols;i++){var newDiv=$("<div>").addClass("result-column").attr('id','result-column-'+i);if(i===0||i===1){wideColumn.append(newDiv);}else{$(".bkt-mvc-browseAction").append(newDiv);}
var nextColumnId;if(amountOfCols!==(i+1)){nextColumnId="#top-of-column-"+(i+1);}else{nextColumnId="#accessibility-skip-target-from-header";}
if(i!==0){$(".bkt-mvc-browseAction #result-column-"+i).prepend("<div class='accessibility-skip-link-wrapper'><a href='"+nextColumnId+"' id='top-of-column-"+(i)+"' class='accessibility-skip-link accessibility-skip-link--browse-results'></a></div>");}}
appendImages(results);$("#result-column-0").prepend("<div class='accessibility-skip-link-wrapper'><a href='#top-of-column-1' id='accessibility-skip-target-from-header' class='accessibility-skip-link accessibility-skip-link--browse-results'></a></div>");var containerSkipLinks=".bkt-mvc-browseAction";addEventHandlerToSkipLinks(containerSkipLinks);$(".accessibility-skip-link--browse-results").text(bkt.i18n.lookup("accessibility-next-column"));redestributing=false;}
function loadBatch(){loading=true;$("#pending-overlay").fadeIn("slow");bkt.mvc.urlparams.page=parseInt(bkt.mvc.urlparams.page)+1;if(bkt.mvc.urlparams.page>maxPages){bkt.mvc.urlparams.page=1;}
bkt.fetch("/"+bkt.mvc.guilang+"/pres/results/browse",{data:$.extend(bkt.mvc.urlparams,{ts:new Date().getTime()}),success:function(html){$(".bkt-mvc-browseAction").append(html);var currentResults=$(".bkt-mvc-browseAction").find(".result.pending").detach().toArray(),historyObject={scrollTop:$(window).scrollTop()};history.pushState(historyObject,"hist","http://"+location.hostname+location.pathname+"?page="+bkt.mvc.urlparams.page);batchCount++;imagesLoading=$(html).find(".thumbnail img").toArray();appendImages(currentResults);}});}
function eventPoll(){if(resizeDelay>0){resizeDelay--;}
if(resizeDelay===0&&!redestributing&&getAmountOfCols()!==amountOfCols){redestributeImages();resizeDelay=-1;}else if(!loading&&batchCount<batchMax&&$(window).scrollTop()+$(window).height()>$(".bkt-mvc-browseAction").height()-200){loadBatch();}
setTimeout(eventPoll,20);}
$(window).on("resize",function(){resizeDelay=3;});redestributeImages();eventPoll();$("#surprise-link").on("click",function(){batchCount=0;if(bkt.mvc.urlparams.page>maxPages){bkt.mvc.urlparams.page=1;}
$(".bkt-mvc-browseAction .result").remove();loadBatch();});$("#surprise-link").parent("form").on("submit",function(){return false;});};
function addEventHandlerToLabels(container,element){var kEvent='keydown';var label=$(container+" "+element).attr("tabindex","0");label.each(function(){var checkboxID=$(this).attr("for");checkboxID=checkboxID.replace(/[\]{}()*+!?&. ':;,\\^$|#\s]/g,"\\$&");var checkbox=$("#"+checkboxID);console.log("added");$(this).on(kEvent,function(e){if(e.keyCode===13){checkbox.prop('checked',!checkbox.prop("checked"));}});});}
function addEventHandlerToSkipLinks(containerSkipLinks){var kEvent='keydown';var staticContent=$("#top-bar").attr("data-accessibility-content-type")==="static"?true:false;var staticContentThemes=$(".main-theme-overview-wrapper").length;$(containerSkipLinks+" .accessibility-skip-link").on(kEvent,function(e){if(e.keyCode===13){e.preventDefault();var eTarget=$(this).attr("href");if(staticContent||staticContentThemes){$(eTarget).attr("tabindex","0");}
$(eTarget).focus();if(staticContent||staticContentThemes){$(eTarget).attr("tabindex","-1");}}});var fEvent='focus';$(containerSkipLinks+" .accessibility-skip-link").on(fEvent,function(e){e.preventDefault();console.log("focussed");$(this).addClass("accessibility-skip-link--has-animation");var headerHeight=$("#top-bar").height();var menuHeight=$("#menu").height();var footerHeight=$(".page-footer").height();var docViewTop=$(window).scrollTop();var docViewBottom=docViewTop+$(window).height();var elemTop=$(this).offset().top+$(this).height();var elemBottom=elemTop+$(this).height();var scrollTargetPoint=elemTop-headerHeight-menuHeight;if((elemTop<(headerHeight+menuHeight))||(elemBottom>docViewBottom-(footerHeight+menuHeight))){$("html,body").animate({scrollTop:(scrollTargetPoint)},0);}});};
bkt.mvc.ngvn=bkt.mvc.ngvn||{};bkt.mvc.ngvn.thumbnailsLoaded=false;bkt.mvc.callbacks.objectbrowseAction=function(){bkt.mvc.ngvn.thumbnailsLoaded=true;var sEvent='click touchstart';var kEvent='keydown';$(".bkt-mvc-objectbrowseAction ol li a").each(function(i,el){$(el).attr("data-href",$(el).attr("href")).removeAttr("href");function handleObjectbrowseEvent(){$(".indicator-load-wrapper").fadeIn();bkt.mvc.renderPartial("view",{data:bkt.deparam($(el).attr("data-href")),callback:bkt.mvc.callbacks.viewAction});bkt.mvc.renderPartial("objectbrowse",{data:bkt.deparam($(el).attr("data-href")),callback:bkt.mvc.callbacks.objectbrowseAction});window.history.pushState(null,null,$(this).attr("data-href"));}
$(el).on(sEvent,function(){handleObjectbrowseEvent();});$(el).on(kEvent,function(e){if(e.keyCode===13){handleObjectbrowseEvent();}});});var animateThumbs,animMS,thumbBar,leftButton,rightButton,minPos,maxPos;thumbBar=$("ol.object-view__browser__thumbnails");leftButton=$("button.button-icon-previous-bracket");rightButton=$("button.button-icon-next-bracket");minPos=0;animMS=10;disableButton(leftButton);enableButton(rightButton);function disableButton(button){if(!button.hasClass("is-disabled")){button.addClass("is-disabled");}}
function enableButton(button){if(button.hasClass("is-disabled")){button.removeClass("is-disabled");}}
function paginationScrollRight(){thumbBarPos=thumbBar.scrollLeft();enableButton(leftButton);maxPos=(thumbBar[0].scrollWidth-thumbBar.width()-1);if(thumbBarPos<maxPos){thumbBar.scrollLeft(thumbBarPos+10);animateThumbs=setTimeout(paginationScrollRight,animMS);}else{clearTimeout(animateThumbs);disableButton(rightButton);}}
function paginationScrollLeft(){thumbBarPos=thumbBar.scrollLeft();enableButton(rightButton);if(thumbBarPos>minPos){thumbBar.scrollLeft(thumbBarPos-10);animateThumbs=setTimeout(paginationScrollLeft,animMS);}else{clearTimeout(animateThumbs);disableButton(leftButton);}}
thumbBar.on("scroll",function(){thumbBarPos=thumbBar.scrollLeft();maxPos=(thumbBar[0].scrollWidth-thumbBar.width()-1);if(thumbBarPos===minPos){disableButton(leftButton);}else{enableButton(leftButton);};if(thumbBarPos>=maxPos){disableButton(rightButton);}else{enableButton(rightButton);};});leftButton.on("mousedown touchstart",function(){paginationScrollLeft();});rightButton.on("mousedown touchstart",function(){paginationScrollRight();});leftButton.on("mouseup touchend",function(){stopScroll();});rightButton.on("mouseup touchend",function(){stopScroll();});function stopScroll(){clearTimeout(animateThumbs);}
window.onpopstate=function(){$(".indicator-load-wrapper").fadeIn();bkt.mvc.renderPartial("view",{data:bkt.deparam(window.location.href),callback:bkt.mvc.callbacks.viewAction});bkt.mvc.renderPartial("objectbrowse",{data:bkt.deparam(window.location.href),callback:bkt.mvc.callbacks.objectbrowseAction});};if($(".bkt-mvc-objectbrowseAction ol").length>0){$(".bkt-mvc-objectbrowseAction ol").scrollLeft($(".bkt-mvc-objectbrowseAction ol li").eq($(".bkt-mvc-objectbrowseAction ol").attr("data-current-index")).offset().left-$(".bkt-mvc-objectbrowseAction ol").offset().left+$(".bkt-mvc-objectbrowseAction ol").scrollLeft()-($(".bkt-mvc-objectbrowseAction ol").width()/ 2));};$(window).on("resize",function(){toggleRightScrollbarControl();});function toggleRightScrollbarControl(){if(typeof thumbBar[0]!=="undefined"){if(thumbBar.scrollLeft()>=thumbBar[0].scrollWidth-thumbBar.width()-1){disableButton(rightButton);}else{enableButton(rightButton);}}}
var timeoutIdentifier=setTimeout(setThumbnailsLoaded,100);function setThumbnailsLoaded(){if($(".bkt-mvc-objectbrowseAction ol li").length>0){toggleRightScrollbarControl();ngvn.viewControls();ngvn.updateMetadata();}else{timeoutIdentifier=setTimeout(setThumbnailsLoaded,100);}}
$(".object-view__browser__thumbnails__link-current").focus();};ngvn.viewControls=function(){if($("body").hasClass("is-fullscreen")){var index=$(".object-view__browser ol").attr("data-current-index");if(index==0){$("nav.object-view__nav-next-prev-image button.object-view__nav-next-prev-image__button-prev").hide();}else{$("nav.object-view__nav-next-prev-image button.object-view__nav-next-prev-image__button-prev").show();}
if(index==$(".object-view__browser ol li").length-1){$("nav.object-view__nav-next-prev-image button.object-view__nav-next-prev-image__button-next").hide();}else{$("nav.object-view__nav-next-prev-image button.object-view__nav-next-prev-image__button-next").show();}}};ngvn.updateMetadata=function(){var currentIndex=$(".bkt-mvc-objectbrowseAction ol").attr("data-current-index");var publicationIdentifier=$(".bkt-mvc-viewAction").attr("data-publication-identifier");if(currentIndex==0){$(".bkt-mvc-viewAction").attr("data-identifier",publicationIdentifier);}else{$(".bkt-mvc-viewAction").attr("data-identifier",publicationIdentifier+':'+currentIndex);}}
var ngvnPaginate={originalCallback:bkt.mvc.callbacks.paginateAction};bkt.mvc.callbacks.paginateAction=function(){$("#current-result-page-number").fadeIn();ngvnPaginate.originalCallback();$(".bkt-mvc-paginateAction a").attr("href","javascript:undefined");var pageNumber=$(".bkt-mvc-paginateAction a.selected").text().trim();var languageControl=$("#top-bar .language-select-list a[href]");languageControl.attr("href",languageControl.attr("href").replace(/&page=\d+/,"&page="+pageNumber));};
var ngvnResults={originalCallback:bkt.mvc.callbacks.resultsAction,scrollDelay:100,lastScrollTop:0,initialPageLoad:true};bkt.mvc.resultEventPoll=false;bkt.mvc.callbacks.resultsAction=function(){$("body").removeClass("is-start-search-request");ngvnResults.originalCallback();var loading=true,batchMax=60,imagesLoading=$(".bkt-mvc-resultsAction .result.pending .thumbnail img").toArray(),maxPages=Math.ceil(parseInt($("input[name='numberOfRecords']:last-of-type").val())/ 36),batchCount=0,pagePositions={},bottomReached=false,atVeryLastPage=false;if(!bkt.mvc.urlparams.page){bkt.mvc.urlparams.page=1;}
if(bkt.mvc.urlparams.page==maxPages){$("body").removeClass("is-hidden-page-footer");}else{$("body").addClass("is-hidden-page-footer");}
setCurrentPageIndicator();function setCurrentPageIndicator(){highestTop=$(window).scrollTop()+200;pagePositions[highestTop]=bkt.mvc.urlparams.page;$("#current-page-indicator").html(bkt.mvc.urlparams.page);}
function updatePageIndicator(){if($(window).scrollTop()<50){$("#current-result-page-namber").fadeOut();}else{$("#current-result-page-number").fadeIn();}
var found=false;for(var top in pagePositions){if($(window).scrollTop()<parseInt(top)){$("#current-page-indicator").html(pagePositions[top]);var params=$.extend(bkt.mvc.urlparams,{page:pagePositions[top]});bkt.setHistoryState(params,true);found=true;break;}}
if(bottomReached&&!found&&!atVeryLastPage){var params=bkt.deparam(location.href),href="?"+$.param($.extend(params,{page:parseInt(params.page)+1}));$("#current-page-continuation-link").attr("href",href).show();}else{$("#current-page-continuation-link").hide();}}
function onResultClick(){var params=bkt.deparam($(this).find(".thumbnail a").attr("href"));params["recordoffset"]=Math.floor(($(this).index()-1)/ 2)%bkt.mvc.urlparams.maxperpage;bkt.setHistoryState(params,true);}
function onImagesLoaded(){loading=false;$(".bkt-mvc-resultsAction .result").removeClass("pending").on("click",onResultClick);$(".results.progress").hide();$(".bkt-mvc-resultsAction > article:first-of-type .result__thumbnail__link").attr("id","accessibility-skip-target-from-header");var containerSkipLinks=".bkt-mvc-resultsAction";addEventHandlerToSkipLinks(containerSkipLinks);}
function pollImagesLoaded(callback){for(var x in imagesLoading){if(imagesLoading[x].complete){imagesLoading.splice(x,1);}}
if(imagesLoading.length>0){setTimeout(function(){pollImagesLoaded(callback)},10);}else{callback();}}
function loadBatch(pageNumber){loading=true;bkt.mvc.urlparams.page=pageNumber;if(bkt.mvc.urlparams.page>maxPages){batchCount=batchMax;atVeryLastPage=true;return;}
$(".results.progress").show();bkt.fetch("/"+bkt.mvc.guilang+"/pres/results/results",{data:bkt.mvc.urlparams,success:function(html){$(".bkt-mvc-resultsAction").append(html);batchCount++;onImagesLoaded();}});}
var firstPage=parseInt(bkt.parseParams().page);$(window).off("scroll").on("scroll",function(){var recordCountPerPage=bkt.parseParams().maxperpage;var recordCountPerRow=Math.floor(document.getElementsByClassName("generic-results").item(0).offsetWidth /(document.getElementsByClassName("generic-results").item(0).getElementsByTagName("article").item(0).offsetWidth+(document.getElementsByClassName("generic-results").item(0).getElementsByTagName("article").item(0).offsetLeft / 2)));for(var i=0;;i=i+recordCountPerRow){if(document.getElementsByClassName("generic-results").item(0).getElementsByTagName("article").item(i).getBoundingClientRect().top>0){break;}}
var newPageNumber=firstPage+Math.floor(i / recordCountPerPage);maxPages=Math.ceil(parseInt($("input[name='numberOfRecords']:last-of-type").val())/ 36);if($("#current-page-indicator").html()!=newPageNumber){$("#current-page-indicator").html(newPageNumber);var newParameters=bkt.deparam(window.location.href);newParameters.page=newPageNumber;bkt.mvc.renderView(["paginate"],newParameters);if(newPageNumber==maxPages){$("body").removeClass("is-hidden-page-footer");}else{$("body").addClass("is-hidden-page-footer");}
bkt.setHistoryState(bkt.mvc.urlparams,true);}
$("#current-result-page-number").fadeIn();if(!loading&&batchCount<batchMax&&maxPages>1&&$(window).scrollTop()+$(window).height()>$(".bkt-mvc-resultsAction").height()-50){loadBatch(newPageNumber+1);}else if(batchCount>=batchMax){bottomReached=true;}
ngvnResults.scrollDelay=100;});onImagesLoaded();var parameters=bkt.parseParams();parameters.page=1;bkt.mvc.renderView(["platformresults"],parameters);$(window).scrollTop(0);if(parameters.recordoffset){$("#results .bkt-mvc-resultsAction article").eq(parameters.recordoffset).attr("id","selected-record");var distance=$("#selected-record").offset().top-$("#results .bkt-mvc-resultsAction").offset().top*2;$("html, body").animate({scrollTop:distance},"slow");}};setInterval(function(){$("#current-result-page-number").fadeOut();},2000);$(document).on("scroll",function(event){if(ngvnResults.initialPageLoad){ngvnResults.initialPageLoad=false;ngvnResults.lastScrollTop=$(window).scrollTop();return;}
var resultsHeight=window.innerHeight-$("#top-bar").height()-$(".page-footer").height();var facetsHeight=$(".filterbox-wrapper").height();var facetsDefaultTop=120;var facetsTop=facetsDefaultTop;if(facetsHeight>resultsHeight){var facetsCurrentTop=parseInt($(".filterbox-wrapper").css("top"));var facetsLastTop=resultsHeight-facetsHeight;var scrollingDistance=Math.abs(ngvnResults.lastScrollTop-$(window).scrollTop());if(ngvnResults.lastScrollTop>$(window).scrollTop()){facetsTop=facetsCurrentTop+(scrollingDistance / 2);if(facetsTop>facetsDefaultTop){facetsTop=facetsDefaultTop;}}else{facetsTop=facetsCurrentTop-(scrollingDistance / 2);if(facetsTop<facetsLastTop){facetsTop=facetsLastTop;}}
ngvnResults.lastScrollTop=scrollingDistance;}
if($(".results-navigation-pagination").length){if($("#top-bar").outerHeight()>$("#content-body")[0].getBoundingClientRect().top){$("#results").addClass("is-active-sticky-results-navigation");}else{$("#results").removeClass("is-active-sticky-results-navigation");}}
ngvnResults.lastScrollTop=$(window).scrollTop();});
bkt.mvc.callbacks.sortlinksAction=function(){$(".bkt-mvc-sortlinksAction a").each(function(i,el){var label=$("<label>").html($(el).html()).addClass("sort-selector__link").attr("for",$(el).attr("data-for-label"));$(el).replaceWith(label);});$("#sortfields input").on("change",function(){var params=bkt.deparam($(this).val());$("#sortfields input.selected").removeClass("selected");bkt.mvc.renderView(['paginate','results','sortlinks','facets'],params);});}
$(window).on("click",function(e){if($(e.target).attr("for")==="sortfield"){if($("#sortfield").is(":checked")){$("#sortfield").prop("checked",false);$("#sortfields").removeClass("visible");e.stopPropagation();return false;}}else if($(e.target).attr("for")!=="sortfield"&&$(e.target).attr("id")!=="sortfield"){$("#sortfield").prop("checked",false);$("#sortfields").removeClass("visible");}});$(window).on("keydown",function(e){if($("#sortfield").is(":focus")&&e.keyCode===40){$("#sortfields").addClass("visible");if($("#sortfields input.selected").length>0){$("#sortfields input.selected").parent("li").next().find("input").addClass("selected");$("#sortfields input.selected").first().removeClass("selected");}else{$("#sortfields input").not(".selected").first().addClass("selected");}
e.stopPropagation();return e.preventDefault();}else if($("#sortfield").is(":focus")&&e.keyCode===38){if($("#sortfields input.selected").length>0){$("#sortfields input.selected").parent("li").prev().find("input").addClass("selected");$("#sortfields input.selected").last().removeClass("selected");}else{$("#sortfields input").not(".selected").first().addClass("selected");}
e.stopPropagation();return e.preventDefault();}
if((e.keyCode===13||e.keyCode===32)){if($("#sortfields input.selected").length>0&&$("#sortfield").is(":focus")){$("#sortfields input.selected").prop("checked",true).trigger("change");}else if($("#sortfield").is(":focus")){$("#sortfields").addClass("visible");}}
if(e.keyCode===27){$("#sortfields").removeClass("visible");$("#sortfield").prop("checked",false);}});
$(document).ready(function(){$("#page-top-control").on("click",function(){$(window).scrollTop(0);});var timeout;$(document).on("scroll",function(){clearTimeout(timeout);if(window.innerHeight>248){if($(window).scrollTop()!==0){$("#page-top-control").fadeIn();timeout=setTimeout(function(){$("#page-top-control").fadeOut();},3000);}else{$("#page-top-control").fadeOut();}}});$(document).on("mousemove",function(event){var windowHeight=window.innerHeight;if(windowHeight>480){var windowWidth=window.innerWidth;var rightCornerLeftPosition=windowWidth-100;var rightCornerTopPosition=windowHeight-100;var mouseLeftPosition=event.clientX;var mouseTopPosition=event.clientY;if((rightCornerLeftPosition<mouseLeftPosition)&&(mouseLeftPosition<windowWidth)&&(rightCornerTopPosition<mouseTopPosition)&&(mouseTopPosition<windowHeight)){clearTimeout(timeout);$("#page-top-control").fadeIn();timeout=setTimeout(function(){$("#page-top-control").fadeOut();},3000);}}});});
bkt.mvc.callbacks.viewAction=function(){var src=$("#image").attr("data-src"),resizeDelay=-1;var sEvent='click touchstart';var kEvent='keydown';toggleAnimation();function responsiveSettings(){'use strict';var C_WIDTH_LARGE=1024;if(window.matchMedia("(min-width: "+C_WIDTH_LARGE+"px)").matches){activateInfoCheckbox();}}
responsiveSettings();function activateInfoCheckbox(){var infoCheck=$("#info-block-toggle-checkbox-radio");infoCheck.attr("checked","checked");infoCheck.checked=true;toggleTooltip(document.querySelector("li label.button-icon-info"),"show-information-next-tooltip");}
function recalibrateViewport(){if($("body").hasClass("is-fullscreen")){$("#image").attr("width",$(window).width()).attr("height",$(window).height()).trigger("recalibrate");if(imageviewerClientCurrentScaleFactor===imageviewerClientInitialScaleFactor){$("#image").trigger("scaleToFullPage",[getScaledHeight(),$(window).width()]);}else{}
ngvn.viewControls();}else{$("#image").attr("width",window.innerWidth).attr("height",getInnerHeight()).trigger("recalibrate");if(imageviewerClientCurrentScaleFactor===imageviewerClientInitialScaleFactor){var imageMarginHeight=180;var imageMarginWidth=80;if($(".header-controls-wrapper").css("display")==="block"){imageMarginHeight=0;imageMarginWidth=0;}
$("#image").trigger("scaleToFullPage",[getScaledHeight(),$(window).width()-imageMarginWidth]);}else{}}}
function getInnerHeight(){var h=$(window).height();if(!$("body").hasClass("is-fullscreen")&&h<500&&$(window).width()<670){h=h-$(".bkt-mvc-objectbrowseAction").height();}else if(!$("body").hasClass("is-fullscreen")){h=h-$("#top-bar").height()-
parseInt($("#top-bar").css("padding-top"))-
parseInt($("#top-bar").css("padding-bottom"))-
$(".bkt-mvc-objectbrowseAction").height();if($(".bkt-mvc-themerelatedpublicationsAction").css("display")==="none"){h-=($(".header-controls-wrapper").height()+parseInt($(".header-controls-wrapper").css("padding-bottom")));}}
return h;}
function pollForResize(){if(resizeDelay>0){resizeDelay--;}
if(resizeDelay===0){recalibrateViewport();resizeDelay=-1;}
setTimeout(pollForResize,20);}
$(window).on("resize",function(){resizeDelay=10;});pollForResize();$(".ngvn-imagetools .zoom-in").removeAttr("href").on("click",function(){$("#image").trigger('scaleBy',[1.25,true]);}).on("keydown",function(e){if(e.keyCode===13||e.keyCode===32){e.preventDefault();$(this).click();}});$(".ngvn-imagetools .zoom-out").removeAttr("href").on("click",function(){if(imageviewerClientCurrentScaleFactor*0.75>imageviewerClientInitialScaleFactor){$("#image").trigger('scaleBy',[0.75,true]);}else{$("#image").trigger('scaleBy',[imageviewerClientInitialScaleFactor,true,null,true]);}}).on("keydown",function(e){if(e.keyCode===13||e.keyCode===32){e.preventDefault();$(this).click();}});function getScaledHeight(){var imageActualSize=JSON.parse($("#image").attr("data-image-actual-size"));var canvasDrawingAreaHeight=getInnerHeight();return canvasDrawingAreaHeight>imageActualSize.height?imageActualSize.height:canvasDrawingAreaHeight;}
function pollThumbnails(){if(bkt.mvc.ngvn.thumbnailsLoaded){var imageMarginHeight=180;var imageMarginWidth=80;if($(".header-controls-wrapper").css("display")==="block"||$("body").hasClass("is-fullscreen")){imageMarginHeight=0;imageMarginWidth=0;}
$("#image").attr("width",$(window).width()).attr("height",getInnerHeight()).imageViewerClient("http://imageviewer.kb.nl/ImagingService/imagingService",{params:{id:src,useresolver:false,canvasMaximumHeight:getScaledHeight(),canvasMaximumWidth:$(window).width()-imageMarginWidth},previewScale:0.4,minScale:0.1,legacy:true,initialZoom:"scaleToFullPage",allowYCentering:true,userCallback:function(){},minimap:$(".ngvn-minimap"),minimapOptions:{interactive:true,color:"red",canvas:$("#image"),image:$(".ngvn-minimap").attr("data-src"),onmove:function(movement){$("#image").trigger('moveBy',[movement,false,true]);},onup:function(movement){$("#image").trigger('moveBy',[movement,true,true]);},ondown:function(pos){$("#image").trigger('moveTo',[pos,false,true]);},onout:function(){$("#image").trigger('redraw');}}}).imageViewerHandlers({mousewheel:true,zoomWithinBounds:true,initialScaleFactor:true});new SimpleBar($('.object-view__metadata-panel__tab-info-block')[0]);if(bkt.isTouchDevice()){$("#image").imageviewerTouchHandlers({initialScaleFactor:true,ondoubletap:function(){$("#image").trigger("scaleToFullWidth");},onswipeleft:function(){showNextImage(getNextImage());},onswiperight:function(){showNextImage(getPreviousImage());},ontap:function(){if($("body").hasClass("is-header-animation-slide-in")){$("body").removeClass("is-header-animation-slide-in").addClass("is-header-animation-slide-out");}else{$("body").removeClass("is-header-animation-slide-out").addClass("is-header-animation-slide-in");}}});}
else
{var mousedown=mousemove=false;$("#image").on("mousedown",function(event)
{mousedown=true;}).on("mousemove",function(event)
{if(mousedown)
{mousemove=true;}}).on("mouseup",function(event)
{mousedown=false;if(mousemove)
{mousemove=false;}
else
{if($("body").hasClass("is-header-animation-slide-in")){$("body").removeClass("is-header-animation-slide-in").addClass("is-header-animation-slide-out");}else{$("body").removeClass("is-header-animation-slide-out").addClass("is-header-animation-slide-in");}}});}
$(".bkt-mvc-themerelatedpublicationsAction article").removeClass("pending");$(".bkt-mvc-collectionrelatedpublicationsAction article").removeClass("pending");if($(".object-view__browser ol li").length>0){$("nav.object-view__nav-next-prev-image button.object-view__nav-next-prev-image__button-prev").on("click",function(){showNextImage(getPreviousImage());});$("nav.object-view__nav-next-prev-image button.object-view__nav-next-prev-image__button-next").on("click",function(){showNextImage(getNextImage());});ngvn.viewControls();}else{$("nav.object-view__nav-next-prev-image").hide();}}else{setTimeout(pollThumbnails,10);}}
pollThumbnails();var initialScaleFactor;$(".button-icon-fullscreen").on("click touchstart",function(){if($("body").hasClass("is-fullscreen")){exitFullscreen();}else{initialScaleFactor=imageviewerClientInitialScaleFactor;$("body").addClass("is-fullscreen");recalibrateViewport();$(document).bind("keyup.fullscreen",function(event){if(event.keyCode==27){exitFullscreen();}});}}).on("keydown",function(e){if(e.keyCode===13||e.keyCode===32){e.preventDefault();$(this).click();}});function exitFullscreen(){$("body").removeClass("is-fullscreen");var tabsLeft=$('.ngvn-imagetools');var tabsRight=$('.ngvn-object-metadata');if(tabsLeft.hasClass("object-view__tools-panel-has-animation")){tabsLeft.removeClass("object-view__tools-panel-has-animation");tabsLeft.addClass("object-view__tools-panel-has-no-animation");}
if(tabsRight.hasClass("object-view__metadata-panel-has-animation")){tabsRight.removeClass("object-view__metadata-panel-has-animation");tabsRight.addClass("object-view__metadata-panel-has-no-animation");}
if(imageviewerClientCurrentScaleFactor===imageviewerClientInitialScaleFactor){}else{imageviewerClientInitialScaleFactor=initialScaleFactor;}
recalibrateViewport();$(document).unbind("keyup.fullscreen");if($(".object-view__browser ol li").length>0){bkt.mvc.renderPartial("objectbrowse",{data:bkt.deparam($(".object-view__browser ol li:nth-child("+(parseInt($(".object-view__browser ol").attr("data-current-index"))+1)+") a").attr("data-href")),callback:bkt.mvc.callbacks.objectbrowseAction});}}
function getPreviousImage(){var element=false;if(imageviewerClientCurrentScaleFactor===imageviewerClientInitialScaleFactor){if($(".object-view__browser ol li").length>0){var currentIndex=$(".object-view__browser ol").attr("data-current-index");var index=parseInt(currentIndex);element=currentIndex>0?$(".object-view__browser ol li:nth-child("+index+") a"):false;}else if($("nav.object-view__nav-next-prev-object a.object-view__nav-next-prev-object__button-next")&&!$("body").hasClass("is-fullscreen")){if($("nav.object-view__nav-next-prev-object a.object-view__nav-next-prev-object__button-prev").length>0){window.location.href=$("nav.object-view__nav-next-prev-object a.object-view__nav-next-prev-object__button-prev").attr("href");}}}
return element;}
function getNextImage(){var element=false;if(imageviewerClientCurrentScaleFactor===imageviewerClientInitialScaleFactor){if($(".object-view__browser ol li").length>0){var currentIndex=$(".object-view__browser ol").attr("data-current-index");var index=parseInt(currentIndex)+2;element=currentIndex<$(".object-view__browser ol li").length-1?$(".object-view__browser ol li:nth-child("+index+") a"):false;}else if($("nav.object-view__nav-next-prev-object a.object-view__nav-next-prev-object__button-next")&&!$("body").hasClass("is-fullscreen")){if($("nav.object-view__nav-next-prev-object a.object-view__nav-next-prev-object__button-next").length>0){window.location.href=$("nav.object-view__nav-next-prev-object a.object-view__nav-next-prev-object__button-next").attr("href");}}}
return element;}
function showNextImage(element){if(element!==false){$(".indicator-load-wrapper").fadeIn();bkt.mvc.renderPartial("objectbrowse",{data:bkt.deparam(element.attr("data-href")),callback:bkt.mvc.callbacks.objectbrowseAction});bkt.mvc.renderPartial("view",{data:bkt.deparam(element.attr("data-href")),callback:bkt.mvc.callbacks.viewAction});window.history.pushState(null,null,element.attr("data-href"));}}
$("nav.object-view__nav label.object-view__button-icon").on("click",function(event){event.preventDefault();var id=$(this).attr("for");id=document.getElementById(id);id.checked=!id.checked;id.focus();toggleMetadataBlockTooltips();});$("#info-block-toggle-checkbox-radio, #download-block-toggle-checkbox-radio").on("keyup",function(event){if(event.keyCode==13||event.keyCode==32){event.preventDefault();this.checked=!this.checked;toggleMetadataBlockTooltips();}});function toggleMetadataBlockTooltips(){var checkboxes=["info-block-toggle-checkbox-radio","download-block-toggle-checkbox-radio"];var tooltips=["information","download"];for(var i=0;i<2;i++){var label=document.querySelector("nav.object-view__nav label.object-view__button-icon[for='"+checkboxes[i]+"']");if(document.getElementById(checkboxes[i]).checked){toggleTooltip(label,"show-"+tooltips[i]+"-next-tooltip");}else{toggleTooltip(label,"show-"+tooltips[i]+"-tooltip");}}}
$("a.accessibility-skip-link").on("keydown",function(event){if(event.keyCode==13||event.keyCode==32){event.preventDefault();$("a.zoom-in").focus();}});$("#permalink-copy-box-toggle-checkbox-radio").change(function(event){$("textarea.permalink-copy-box__content").select();event.preventDefault();});$("label.button-icon").on("focus",function(event){$("div.simplebar-scroll-content").attr("tabindex","-1");});function toggleAnimation(){var tabsLeft=$('.ngvn-imagetools');var tabsRight=$('.ngvn-object-metadata');var labelLeft=$("#object-view__tools-panel-toggle");var labelRight=$("#object-view__metadata-panel-toggle");var classNameLeft="tools";var classNameRight="metadata";var checkboxL=$("#"+labelLeft.attr("for"));var checkboxR=$("#"+labelRight.attr("for"));var tabsVar;var classNameVar;function addRemoveHasAnimationClass(tabsVar,classNameVar){if(tabsVar.hasClass("object-view__"+classNameVar+"-panel-has-no-animation")){tabsVar.removeClass("object-view__"+classNameVar+"-panel-has-no-animation");tabsVar.addClass("object-view__"+classNameVar+"-panel-has-animation");}
tabsVar.removeClass("display-none");}
var pfx=["webkit","moz","MS","o",""];function prefixedEvent(element,type,animElement,checkboxElement){for(var p=0;p<pfx.length;p++){if(!pfx[p])type=type.toLowerCase();element.addEventListener(pfx[p]+type,function(){animationListener(animElement,checkboxElement);},false);}}
var animElementArr=[[tabsLeft,checkboxL],[tabsRight,checkboxR]];var i;var animElement;var checkboxElement;for(i=0;i<animElementArr.length;i++){animElement=animElementArr[i][0][0];checkboxElement=animElementArr[i][1][0];prefixedEvent(animElement,"AnimationEnd",animElement,checkboxElement);}
function animationListener(element,checkbox){if(checkbox.checked){$(element).addClass("display-none");}}
checkboxL.on(sEvent,function(){tabsVar=tabsLeft;classNameVar=classNameLeft;addRemoveHasAnimationClass(tabsVar,classNameVar);});checkboxR.on(sEvent,function(){tabsVar=tabsRight;classNameVar=classNameRight;addRemoveHasAnimationClass(tabsVar,classNameVar);});labelLeft.on(kEvent,function(e){if(e.keyCode===13||e.keyCode===32){e.preventDefault();checkboxL.prop('checked',!checkboxL.prop("checked"));tabsVar=tabsLeft;classNameVar=classNameLeft;addRemoveHasAnimationClass(tabsVar,classNameVar);}});labelRight.on(kEvent,function(e){if(e.keyCode===13||e.keyCode===32){e.preventDefault();checkboxR.prop('checked',!checkboxR.prop("checked"));tabsVar=tabsRight;classNameVar=classNameRight;addRemoveHasAnimationClass(tabsVar,classNameVar);}});}
var labelsContainer="#download-block";var labelElement="label";addEventHandlerToLabels(labelsContainer,labelElement);$(".bkt-mvc-viewAction").removeClass("is-favourite");$(".bkt-mvc-viewAction").attr("data-metadata",$(".ngvn-object-metadata").attr("data-metadata"));ngvn.favourites.highlightSelected(objectIdentifier);ngvn.viewControls();function toggleTooltip(element,languageResourceElementLabel){var languageResourceElement={coll:"ngvn",controller:"view"};var text=bkt.i18n.lookup(languageResourceElementLabel,languageResourceElement);element.title=text;element.setAttribute("aria-label",text);}
window["object-view__tools-panel__toggle-checkbox-radio"].addEventListener("change",function(event){var label=this.checked?"hide-zoom-menu-next-tooltip":"hide-zoom-menu-tooltip";toggleTooltip(window["object-view__tools-panel-toggle"],label);},false);window["object-view__metadata-panel__toggle-checkbox-radio"].addEventListener("change",function(event){var label=this.checked?"hide-menu-next-tooltip":"hide-menu-tooltip";toggleTooltip(window["object-view__metadata-panel-toggle"],label);},false);};
window.ngvn=window.ngvn||{};window.ngvn.filterboxAssets={};if(window.ngvn.filterbox){console.log("ERROR, filterbox namespace is already in use!");}
(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["filterbox.filtergroups.html"]=(function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{var parentTemplate=null;output+="<p class=\"filterbox__plain-text filterbox__plain-text--strong\">";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"labels")),"facetSetSectionTitle"),env.opts.autoescape);output+="</p>\n<ul class=\"filterbox__category-list\">\n\t";frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"categories");if(t_3){var t_1;if(runtime.isArray(t_3)){var t_2=t_3.length;for(t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1][0]
frame.set("categoryId",t_3[t_1][0]);var t_5=t_3[t_1][1]
frame.set("category",t_3[t_1][1]);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+="\n\t\t<li>\n\t\t\t";if(runtime.memberLookup((t_5),"available")){output+="\n\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t   id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   data-gvn-category-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t   class=\"js-filterbox-category toggle-checkbox-radio\"\n\t\t\t\t\t   tabindex=\"-1\"\n\t\t\t\t\t   ";if(runtime.memberLookup((t_5),"active")){output+="checked";;}
output+=" >\n\t\t\t\t<div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\"  class=\"filterbox__list__item__label filterbox__category-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_5),"label"),env.opts.autoescape);output+="</label></div>\n\t\t\t";;}
else{output+="\n\t\t\t\t<span class=\"filterbox__list__item__label filterbox__list__item__label--disabled\">";output+=runtime.suppressValue(runtime.memberLookup((t_5),"label"),env.opts.autoescape);output+="</span>\n\t\t\t";;}
output+="\n\t\t</li>\n\t";;}}else{t_1=-1;var t_2=runtime.keys(t_3).length;for(var t_6 in t_3){t_1++;var t_7=t_3[t_6];frame.set("categoryId",t_6);frame.set("category",t_7);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+="\n\t\t<li>\n\t\t\t";if(runtime.memberLookup((t_7),"available")){output+="\n\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t   id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   data-gvn-category-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t   class=\"js-filterbox-category toggle-checkbox-radio\"\n\t\t\t\t\t   tabindex=\"-1\"\n\t\t\t\t\t   ";if(runtime.memberLookup((t_7),"active")){output+="checked";;}
output+=" >\n\t\t\t\t<div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\"  class=\"filterbox__list__item__label filterbox__category-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_7),"label"),env.opts.autoescape);output+="</label></div>\n\t\t\t";;}
else{output+="\n\t\t\t\t<span class=\"filterbox__list__item__label filterbox__list__item__label--disabled\">";output+=runtime.suppressValue(runtime.memberLookup((t_7),"label"),env.opts.autoescape);output+="</span>\n\t\t\t";;}
output+="\n\t\t</li>\n\t";;}}}
frame=frame.pop();output+="\n</ul>\n \n";if(runtime.contextOrFrameLookup(context,frame,"filters")){output+="\n\t<p class=\"filterbox__plain-text filterbox__plain-text--strong\">";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"labels")),"facetsSectionTitle"),env.opts.autoescape);output+="</p>\n\t<ul class=\"filterbox__facet-list\">\n\t";frame=frame.push();var t_10=runtime.contextOrFrameLookup(context,frame,"filters");if(t_10){var t_8;if(runtime.isArray(t_10)){var t_9=t_10.length;for(t_8=0;t_8<t_10.length;t_8++){var t_11=t_10[t_8][0]
frame.set("filterGroupId",t_10[t_8][0]);var t_12=t_10[t_8][1]
frame.set("filterGroup",t_10[t_8][1]);frame.set("loop.index",t_8+1);frame.set("loop.index0",t_8);frame.set("loop.revindex",t_9-t_8);frame.set("loop.revindex0",t_9-t_8-1);frame.set("loop.first",t_8===0);frame.set("loop.last",t_8===t_9-1);frame.set("loop.length",t_9);output+="\n\t\t";if(runtime.memberLookup((t_12),"numFilters")>0){output+="\n\t\t\t<li class=\"filterbox__facet\">\n\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t   id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_12),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   class=\"toggle-checkbox-radio filterbox__facet-toggle-checkbox-radio\"\n\t\t\t\t\t   tabindex=\"-1\"\n\t\t\t\t\t   ";if(runtime.memberLookup((t_12),"showShortList")){output+="checked";;}
output+="\n\t\t\t\t\t   >\n\t\t\t\t";var t_13;t_13=runtime.memberLookup((runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"activeFilters")),runtime.memberLookup((t_12),"id"))),"length");frame.set("numActiveFilters",t_13,true);if(frame.topLevel){context.setVariable("numActiveFilters",t_13);}
if(frame.topLevel){context.addExport("numActiveFilters",t_13);}
output+="\t   \n\t\t\t\t";if(runtime.contextOrFrameLookup(context,frame,"numActiveFilters")>0){output+=" \n\t\t\t\t\t<span class=\"filterbox__facet-label__counter\" title=\"";output+=runtime.suppressValue(((runtime.contextOrFrameLookup(context,frame,"numActiveFilters")==1)?"1 actieve filter":(runtime.contextOrFrameLookup(context,frame,"numActiveFilters")+" actieve filters")),env.opts.autoescape);output+="\">";output+=runtime.suppressValue(runtime.memberLookup((runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"activeFilters")),runtime.memberLookup((t_12),"id"))),"length"),env.opts.autoescape);output+="</span>\n\t\t\t\t";;}
output+="\n\t\t\t\t<div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_12),"id"),env.opts.autoescape);output+="\"\n\t\t\t\t\t   data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_12),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   class=\"js-filterbox-toggle-filtergroup filterbox__facet-label\"\n\t\t\t\t\t aria-label=\"";output+=runtime.suppressValue(runtime.memberLookup((t_12),"id"),env.opts.autoescape);output+="\">\n\t\t\t\t\t<span>";output+=runtime.suppressValue(runtime.memberLookup((t_12),"label"),env.opts.autoescape);output+="</span>\n\t\t\t\t</label></div>\n\n\t\t\t\t<div class=\"filterbox__facet-content-list-wrapper filterbox__facet-content-list-thema-wrapper  ";if(runtime.memberLookup((t_12),"showShortList")!=true){output+="hidden";;}
output+="\" >\n\t\t\t\t\t<ul class=\"filterbox__facet-content-list\">\n\t\t\t\t\t\t";frame=frame.push();var t_16=runtime.memberLookup((t_12),"filters");if(t_16){var t_14;if(runtime.isArray(t_16)){var t_15=t_16.length;for(t_14=0;t_14<t_16.length;t_14++){var t_17=t_16[t_14][0]
frame.set("id",t_16[t_14][0]);var t_18=t_16[t_14][1]
frame.set("filter",t_16[t_14][1]);frame.set("loop.index",t_14+1);frame.set("loop.index0",t_14);frame.set("loop.revindex",t_15-t_14);frame.set("loop.revindex0",t_15-t_14-1);frame.set("loop.first",t_14===0);frame.set("loop.last",t_14===t_15-1);frame.set("loop.length",t_15);output+="\n\t\t\t\t\t\t\t";if(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"loop")),"index")<=10){output+="\n\t\t\t\t\t\t\t";var t_19;t_19=runtime.memberLookup((t_18),"id");frame.set("filterId",t_19,true);if(frame.topLevel){context.setVariable("filterId",t_19);}
if(frame.topLevel){context.addExport("filterId",t_19);}
output+="\n\t\t\t\t\t\t\t  <li>\n\t\t\t\t\t\t\t\t  <input type=\"checkbox\" \n\t\t\t\t\t\t\t\t\t\t id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_18),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_18),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_12),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_18),"id"),env.opts.autoescape);output+="\"   \n\t\t\t\t\t\t\t\t\t\t class=\"js-filterbox-filter toggle-checkbox-radio\"\n\t\t\t\t\t\t\t\t\t\t tabindex=\"-1\"\n\t\t\t\t\t\t\t\t\t\t ";if(runtime.memberLookup((t_18),"active")){output+="checked";;}
output+=" >\n\t\t\t\t\t\t\t\t  <div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_18),"id"),env.opts.autoescape);output+="\" class=\"filterbox__list__item__label filterbox__facet-content-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_18),"label"),env.opts.autoescape);output+=" <span class=\"filterbox__results-count\">(";output+=runtime.suppressValue(runtime.memberLookup((t_18),"count"),env.opts.autoescape);output+=")</span></label></div>\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t  </li> \n\t\t\t\t\t\t\t";;}
output+="\n\t\t\t\t\t\t";;}}else{t_14=-1;var t_15=runtime.keys(t_16).length;for(var t_20 in t_16){t_14++;var t_21=t_16[t_20];frame.set("id",t_20);frame.set("filter",t_21);frame.set("loop.index",t_14+1);frame.set("loop.index0",t_14);frame.set("loop.revindex",t_15-t_14);frame.set("loop.revindex0",t_15-t_14-1);frame.set("loop.first",t_14===0);frame.set("loop.last",t_14===t_15-1);frame.set("loop.length",t_15);output+="\n\t\t\t\t\t\t\t";if(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"loop")),"index")<=10){output+="\n\t\t\t\t\t\t\t";var t_22;t_22=runtime.memberLookup((t_21),"id");frame.set("filterId",t_22,true);if(frame.topLevel){context.setVariable("filterId",t_22);}
if(frame.topLevel){context.addExport("filterId",t_22);}
output+="\n\t\t\t\t\t\t\t  <li>\n\t\t\t\t\t\t\t\t  <input type=\"checkbox\" \n\t\t\t\t\t\t\t\t\t\t id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_21),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_21),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_12),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_21),"id"),env.opts.autoescape);output+="\"   \n\t\t\t\t\t\t\t\t\t\t class=\"js-filterbox-filter toggle-checkbox-radio\"\n\t\t\t\t\t\t\t\t\t\t tabindex=\"-1\"\n\t\t\t\t\t\t\t\t\t\t ";if(runtime.memberLookup((t_21),"active")){output+="checked";;}
output+=" >\n\t\t\t\t\t\t\t\t  <div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_21),"id"),env.opts.autoescape);output+="\" class=\"filterbox__list__item__label filterbox__facet-content-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_21),"label"),env.opts.autoescape);output+=" <span class=\"filterbox__results-count\">(";output+=runtime.suppressValue(runtime.memberLookup((t_21),"count"),env.opts.autoescape);output+=")</span></label></div>\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t  </li> \n\t\t\t\t\t\t\t";;}
output+="\n\t\t\t\t\t\t";;}}}
frame=frame.pop();output+="\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t";if(runtime.memberLookup((t_12),"numFilters")>10){output+="\n\t\t\t\t\t\t\t\t<button data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_12),"id"),env.opts.autoescape);output+="\" class=\"js-filterbox-open-modal filterbox__list__item__label filterbox__facet-content-list__item__label filterbox__facet-content-list__item__label--has-no-visual-checkbox\">";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"labels")),"showAllFiltersControlCaption"),env.opts.autoescape);output+="</button>\n\t\t\t\t\t\t\t";;}
output+="\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t";;}
output+="\n\t";;}}else{t_8=-1;var t_9=runtime.keys(t_10).length;for(var t_23 in t_10){t_8++;var t_24=t_10[t_23];frame.set("filterGroupId",t_23);frame.set("filterGroup",t_24);frame.set("loop.index",t_8+1);frame.set("loop.index0",t_8);frame.set("loop.revindex",t_9-t_8);frame.set("loop.revindex0",t_9-t_8-1);frame.set("loop.first",t_8===0);frame.set("loop.last",t_8===t_9-1);frame.set("loop.length",t_9);output+="\n\t\t";if(runtime.memberLookup((t_24),"numFilters")>0){output+="\n\t\t\t<li class=\"filterbox__facet\">\n\t\t\t\t<input type=\"checkbox\" \n\t\t\t\t\t   id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_24),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   class=\"toggle-checkbox-radio filterbox__facet-toggle-checkbox-radio\"\n\t\t\t\t\t   tabindex=\"-1\"\n\t\t\t\t\t   ";if(runtime.memberLookup((t_24),"showShortList")){output+="checked";;}
output+="\n\t\t\t\t\t   >\n\t\t\t\t";var t_25;t_25=runtime.memberLookup((runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"activeFilters")),runtime.memberLookup((t_24),"id"))),"length");frame.set("numActiveFilters",t_25,true);if(frame.topLevel){context.setVariable("numActiveFilters",t_25);}
if(frame.topLevel){context.addExport("numActiveFilters",t_25);}
output+="\t   \n\t\t\t\t";if(runtime.contextOrFrameLookup(context,frame,"numActiveFilters")>0){output+=" \n\t\t\t\t\t<span class=\"filterbox__facet-label__counter\" title=\"";output+=runtime.suppressValue(((runtime.contextOrFrameLookup(context,frame,"numActiveFilters")==1)?"1 actieve filter":(runtime.contextOrFrameLookup(context,frame,"numActiveFilters")+" actieve filters")),env.opts.autoescape);output+="\">";output+=runtime.suppressValue(runtime.memberLookup((runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"activeFilters")),runtime.memberLookup((t_24),"id"))),"length"),env.opts.autoescape);output+="</span>\n\t\t\t\t";;}
output+="\n\t\t\t\t<div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_24),"id"),env.opts.autoescape);output+="\"\n\t\t\t\t\t   data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_24),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t   class=\"js-filterbox-toggle-filtergroup filterbox__facet-label\"\n\t\t\t\t\t      aria-label=\"";output+=runtime.suppressValue(runtime.memberLookup((t_24),"id"),env.opts.autoescape);output+="\">\n\t\t\t\t\t<span>";output+=runtime.suppressValue(runtime.memberLookup((t_24),"label"),env.opts.autoescape);output+="</span>\n\t\t\t\t</label></div>\n\n\t\t\t\t<div class=\"filterbox__facet-content-list-wrapper filterbox__facet-content-list-thema-wrapper  ";if(runtime.memberLookup((t_24),"showShortList")!=true){output+="hidden";;}
output+="\" >\n\t\t\t\t\t<ul class=\"filterbox__facet-content-list\">\n\t\t\t\t\t\t";frame=frame.push();var t_28=runtime.memberLookup((t_24),"filters");if(t_28){var t_26;if(runtime.isArray(t_28)){var t_27=t_28.length;for(t_26=0;t_26<t_28.length;t_26++){var t_29=t_28[t_26][0]
frame.set("id",t_28[t_26][0]);var t_30=t_28[t_26][1]
frame.set("filter",t_28[t_26][1]);frame.set("loop.index",t_26+1);frame.set("loop.index0",t_26);frame.set("loop.revindex",t_27-t_26);frame.set("loop.revindex0",t_27-t_26-1);frame.set("loop.first",t_26===0);frame.set("loop.last",t_26===t_27-1);frame.set("loop.length",t_27);output+="\n\t\t\t\t\t\t\t";if(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"loop")),"index")<=10){output+="\n\t\t\t\t\t\t\t";var t_31;t_31=runtime.memberLookup((t_30),"id");frame.set("filterId",t_31,true);if(frame.topLevel){context.setVariable("filterId",t_31);}
if(frame.topLevel){context.addExport("filterId",t_31);}
output+="\n\t\t\t\t\t\t\t  <li>\n\t\t\t\t\t\t\t\t  <input type=\"checkbox\" \n\t\t\t\t\t\t\t\t\t\t id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_30),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_30),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_24),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_30),"id"),env.opts.autoescape);output+="\"   \n\t\t\t\t\t\t\t\t\t\t class=\"js-filterbox-filter toggle-checkbox-radio\"\n\t\t\t\t\t\t\t\t\t\t tabindex=\"-1\"\n\t\t\t\t\t\t\t\t\t\t ";if(runtime.memberLookup((t_30),"active")){output+="checked";;}
output+=" >\n\t\t\t\t\t\t\t\t  <div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_30),"id"),env.opts.autoescape);output+="\" class=\"filterbox__list__item__label filterbox__facet-content-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_30),"label"),env.opts.autoescape);output+=" <span class=\"filterbox__results-count\">(";output+=runtime.suppressValue(runtime.memberLookup((t_30),"count"),env.opts.autoescape);output+=")</span></label></div>\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t  </li> \n\t\t\t\t\t\t\t";;}
output+="\n\t\t\t\t\t\t";;}}else{t_26=-1;var t_27=runtime.keys(t_28).length;for(var t_32 in t_28){t_26++;var t_33=t_28[t_32];frame.set("id",t_32);frame.set("filter",t_33);frame.set("loop.index",t_26+1);frame.set("loop.index0",t_26);frame.set("loop.revindex",t_27-t_26);frame.set("loop.revindex0",t_27-t_26-1);frame.set("loop.first",t_26===0);frame.set("loop.last",t_26===t_27-1);frame.set("loop.length",t_27);output+="\n\t\t\t\t\t\t\t";if(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"loop")),"index")<=10){output+="\n\t\t\t\t\t\t\t";var t_34;t_34=runtime.memberLookup((t_33),"id");frame.set("filterId",t_34,true);if(frame.topLevel){context.setVariable("filterId",t_34);}
if(frame.topLevel){context.addExport("filterId",t_34);}
output+="\n\t\t\t\t\t\t\t  <li>\n\t\t\t\t\t\t\t\t  <input type=\"checkbox\" \n\t\t\t\t\t\t\t\t\t\t id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_33),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_33),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t\t\t\t\t\t data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_24),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t\t\t\t\t name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_33),"id"),env.opts.autoescape);output+="\"   \n\t\t\t\t\t\t\t\t\t\t class=\"js-filterbox-filter toggle-checkbox-radio\"\n\t\t\t\t\t\t\t\t\t\t tabindex=\"-1\"\n\t\t\t\t\t\t\t\t\t\t ";if(runtime.memberLookup((t_33),"active")){output+="checked";;}
output+=" >\n\t\t\t\t\t\t\t\t  <div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_33),"id"),env.opts.autoescape);output+="\" class=\"filterbox__list__item__label filterbox__facet-content-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_33),"label"),env.opts.autoescape);output+=" <span class=\"filterbox__results-count\">(";output+=runtime.suppressValue(runtime.memberLookup((t_33),"count"),env.opts.autoescape);output+=")</span></label></div>\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t  </li> \n\t\t\t\t\t\t\t";;}
output+="\n\t\t\t\t\t\t";;}}}
frame=frame.pop();output+="\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t";if(runtime.memberLookup((t_24),"numFilters")>10){output+="\n\t\t\t\t\t\t\t\t<button data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_24),"id"),env.opts.autoescape);output+="\" class=\"js-filterbox-open-modal filterbox__list__item__label filterbox__facet-content-list__item__label filterbox__facet-content-list__item__label--has-no-visual-checkbox\">";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"labels")),"showAllFiltersControlCaption"),env.opts.autoescape);output+="</button>\n\t\t\t\t\t\t\t";;}
output+="\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t";;}
output+="\n\t";;}}}
frame=frame.pop();output+="\n\t</ul>\n";;}
if(parentTemplate){parentTemplate.rootRenderFunc(env,context,frame,runtime,cb);}else{cb(null,output);};}catch(e){cb(runtime.handleError(e,lineno,colno));}}
return{root:root};})();})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["filterbox.modalcontent.html"]=(function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{var parentTemplate=null;output+="<p class=\"filterbox__plain-text filterbox__plain-text--facet-overlay\"></p>\n<label for=\"";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"id"),env.opts.autoescape);output+="\"\n\t   data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"id"),env.opts.autoescape);output+="\" \n\t   class=\"js-filterbox-toggle-filtergroup filterbox__facet-overlay__label-heading\"\n\t   aria-label=\"";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"label"),env.opts.autoescape);output+="\">\n\t<span>";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"label"),env.opts.autoescape);output+="</span>\n\t";if(runtime.memberLookup((runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"activeFilters")),runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"id"))),"length")>0){output+="\n\t\t- <span class=\"activeFilterCount\">\n\t\t";if(runtime.memberLookup((runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"activeFilters")),runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"id"))),"length")==1){output+=" \n\t\t\t(1 actief filter)\n\t\t";;}
else{output+="\n\t\t\t(";output+=runtime.suppressValue(runtime.memberLookup((runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"activeFilters")),runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"id"))),"length"),env.opts.autoescape);output+=" actieve filters)\n\t\t";;}
output+="\n\t\t</span>\n\t";;}
output+="\n</label><div class=\"sort-wrapper sort-wrapper--facet-overlay\"><p class=\"sort-selector-description sort-selector-description--facet-overlay\"></p> <div class=\"sort-selector\"><input type=\"radio\" name=\"sortfield\" id=\"sortfield\" class=\"sort-selector__radio\"><label for=\"sortfield\" class=\"sort-selector__link-current sort-selector__link-current--facet-overlay\"></label><ul id=\"sortfields\" class=\"sort-selector__list sort-selector__list--facet-overlay\"><li><input type=\"radio\" name=\"sortfield\" id=\"title-asc\" value=\"alphabet\" class=\"sort-selector__radio\"><label class=\"sort-selector__link\" for=\"title-asc\"></label></li><li><input type=\"radio\" name=\"sortfield\" id=\"default-asc\" value=\"count\" class=\"sort-selector__radio\"><label class=\"sort-selector__link\" for=\"default-asc\"></label></li></ul></div></div><button id=\"js-filterbox-close-modal\" \n\t   class=\"button-icon button-icon-close filterbox__facet-overlay__button-icon-close\"\n\t   aria-label=\"Close ";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"label"),env.opts.autoescape);output+="\"></button>\n\n<div class=\"filterbox__facet-content-list-wrapper--facet-overlay\" >\n\t<ul class=\"filterbox__facet-content-list filterbox__facet-content-list--facet-overlay\">\n\t\t";frame=frame.push();var t_3=runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"filters");if(t_3){var t_1;if(runtime.isArray(t_3)){var t_2=t_3.length;for(t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1][0]
frame.set("id",t_3[t_1][0]);var t_5=t_3[t_1][1]
frame.set("filter",t_3[t_1][1]);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+="\n\t\t\t  <li class=\"filterbox__facet-content-list__item--facet-overlay\">\n\t\t\t\t  <input type=\"checkbox\" \n\t\t\t\t\t\t id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t data-gvn-filter-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t\t class=\"js-filterbox-filter toggle-checkbox-radio\" \n\t\t\t\t\t\t tabindex=\"-1\"\n\t\t\t\t\t\t ";if(runtime.memberLookup((t_5),"active")){output+="checked";;}
output+=" >\n\t\t\t\t  <div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_5),"id"),env.opts.autoescape);output+="\" class=\"filterbox__list__item__label filterbox__facet-content-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_5),"label"),env.opts.autoescape);output+="<span class=\"filterbox__results-count\">(";output+=runtime.suppressValue(runtime.memberLookup((t_5),"count"),env.opts.autoescape);output+=")</span></label></div>\t\t\t\t\t\t\t\t \n\t\t\t  </li> \n\t\t";;}}else{t_1=-1;var t_2=runtime.keys(t_3).length;for(var t_6 in t_3){t_1++;var t_7=t_3[t_6];frame.set("id",t_6);frame.set("filter",t_7);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+="\n\t\t\t  <li class=\"filterbox__facet-content-list__item--facet-overlay\">\n\t\t\t\t  <input type=\"checkbox\" \n\t\t\t\t\t\t id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t data-gvn-filter-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t data-gvn-filter-group-id=\"";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"filterGroup")),"id"),env.opts.autoescape);output+="\" \n\t\t\t\t\t\t name=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\"  \n\t\t\t\t\t\t class=\"js-filterbox-filter toggle-checkbox-radio\" \n\t\t\t\t\t\t tabindex=\"-1\"\n\t\t\t\t\t\t ";if(runtime.memberLookup((t_7),"active")){output+="checked";;}
output+=" >\n\t\t\t\t  <div><label for=\"";output+=runtime.suppressValue(runtime.memberLookup((t_7),"id"),env.opts.autoescape);output+="\" class=\"filterbox__list__item__label filterbox__facet-content-list__item__label\">";output+=runtime.suppressValue(runtime.memberLookup((t_7),"label"),env.opts.autoescape);output+="<span class=\"filterbox__results-count\">(";output+=runtime.suppressValue(runtime.memberLookup((t_7),"count"),env.opts.autoescape);output+=")</span></label></div>\t\t\t\t\t\t\t\t \n\t\t\t  </li> \n\t\t";;}}}
frame=frame.pop();output+="\n\t</ul>\n</div>";if(parentTemplate){parentTemplate.rootRenderFunc(env,context,frame,runtime,cb);}else{cb(null,output);};}catch(e){cb(runtime.handleError(e,lineno,colno));}}
return{root:root};})();})();(function(){(window.nunjucksPrecompiled=window.nunjucksPrecompiled||{})["filterbox.selectedfilters.html"]=(function(){function root(env,context,frame,runtime,cb){var lineno=null;var colno=null;var output="";try{var parentTemplate=null;output+="<ul class=\"filterbox__feedback__list\">\n\t";frame=frame.push();var t_3=runtime.contextOrFrameLookup(context,frame,"activeFilterList");if(t_3){var t_2=t_3.length;for(var t_1=0;t_1<t_3.length;t_1++){var t_4=t_3[t_1];frame.set("filter",t_4);frame.set("loop.index",t_1+1);frame.set("loop.index0",t_1);frame.set("loop.revindex",t_2-t_1);frame.set("loop.revindex0",t_2-t_1-1);frame.set("loop.first",t_1===0);frame.set("loop.last",t_1===t_2-1);frame.set("loop.length",t_2);output+="\n\t<li class=\"filterbox__feedback__list__item\">\n\t\t<a  class=\"js-filterbox-reset-filter filterbox__feedback__list__item__button button-removable\"\n\t\t\ttabindex=\"0\"\n\t\t\tdata-gvn-filter-id=\"";output+=runtime.suppressValue(runtime.memberLookup((t_4),"filterId"),env.opts.autoescape);output+="\" \n\t\t\tdata-gvn-filter-groupid=\"";output+=runtime.suppressValue(runtime.memberLookup((t_4),"filterGroupId"),env.opts.autoescape);output+="\">";output+=runtime.suppressValue(runtime.memberLookup((t_4),"filterId"),env.opts.autoescape);output+="</a>\n\t</li>\n\t";;}}
frame=frame.pop();output+="\n</ul>\n";if(runtime.contextOrFrameLookup(context,frame,"showResetFiltersButton")){output+="<button id=\"js-filterbox-reset-all\" class=\"filterbox__text-link\">";output+=runtime.suppressValue(runtime.memberLookup((runtime.contextOrFrameLookup(context,frame,"labels")),"removeSelectedFiltersControlCaption"),env.opts.autoescape);output+="</button>";;}
if(parentTemplate){parentTemplate.rootRenderFunc(env,context,frame,runtime,cb);}else{cb(null,output);};}catch(e){cb(runtime.handleError(e,lineno,colno));}}
return{root:root};})();})();
window.ngvn.filterboxAssets.Model=(function(signals){var _events;var _filters;var _activeFilters;var _activeFilterList;var _categories;function _init(){_events={updatedFilters:new signals.Signal(),updatedFromAPI:new signals.Signal()};_filters={};_categories={};_activeFilters={};_activeFilterList=[];}
function _updateFilter(filterId,filterGroupId,isActive,dispatchEvent){var filter,filterGroup,index;filter=_getFilter(filterId,filterGroupId);if(filter){filter.active=isActive;}
if(isActive){if(_activeFilters[filterGroupId]===undefined){_activeFilters[filterGroupId]=[filterId];}else{_activeFilters[filterGroupId].push(filterId);}}else{filterGroup=_activeFilters[filterGroupId];if(filterGroup){index=filterGroup.indexOf(filterId);filterGroup.splice(index,1);if(filterGroup.length===0){delete _activeFilters[filterGroupId];}}}
if(isActive){_activeFilterList.push({filterId:filterId,filterGroupId:filterGroupId});}else{for(var i=0,l=_activeFilterList.length,filter;i<l;i++){filter=_activeFilterList[i];index=-1;if(filter.filterId===filterId){index=i;break;}}
_activeFilterList.splice(index,1);}
if(dispatchEvent){_dispatchFilterUpdate();}}
function _deactivateFilters(batch){for(var i=0,l=batch.length,filter;i<l;i++){filter=batch[i];_updateFilter(filter.filterId,filter.filterGroupId,false,false);}
_dispatchFilterUpdate();}
function _dispatchFilterUpdate(){_events.updatedFilters.dispatch();}
function _updateCategory(categoryId,isActive,dispatchEvent){_categories[categoryId].active=isActive;if(dispatchEvent){_dispatchFilterUpdate();}}
function _setShowShortList(filterGroupId,isVisible){_filters[filterGroupId].showShortList=isVisible;}
function _setFilters(filters,activeFilters){var activeFilterIds;_filters=filters;if(activeFilters){for(var filterGroupId in activeFilters){if(_filters[filterGroupId]===undefined){continue;}
activeFilterIds=activeFilters[filterGroupId];if(activeFilterIds&&activeFilterIds.length>0){for(var i=0,l=activeFilterIds.length,filterId;i<l;i++){filterId=activeFilterIds[i];_updateFilter(filterId,filterGroupId,true,false);}
_setShowShortList(filterGroupId,true);}}}
_events.updatedFromAPI.dispatch();}
function _setCategories(categories,activeCategoryIds){_categories=categories;if(activeCategoryIds&&activeCategoryIds.length>0){for(var categoryId in _categories){_categories[categoryId].active=(activeCategoryIds.indexOf(categoryId)>-1);}}}
function _updateCategories(categoriesNew){var category,categoryNew;for(var categoryId in categoriesNew){categoryNew=categoriesNew[categoryId];category=_categories[categoryId];category.available=categoryNew.available;}}
function _replaceFilters(filtersNew){var filterGroup,filterGroupNew,filter,filterNew;var activeFilterIds,filterId,obsoleteFilters;obsoleteFilters=[];for(var filterGroupId in _activeFilters){activeFilterIds=_activeFilters[filterGroupId];filterGroupNew=filtersNew[filterGroupId];if(filterGroupNew===undefined){continue;}
filterGroupNew.showShortList=true;for(var i=0,l=activeFilterIds.length;i<l;i++){filterId=activeFilterIds[i];filterNew=filterGroupNew.filters[filterId];if(filterNew){filterNew.active=true;}else{}}}
_filters=filtersNew;_events.updatedFromAPI.dispatch();}
function _activateFilter(filterId,filterGroupId){_updateFilter(filterId,filterGroupId,true,true);}
function _deactivateFilter(filterId,filterGroupId){_updateFilter(filterId,filterGroupId,false,true);}
function _deactivateAllFilters(){for(var categoryId in _categories){_categories[categoryId].active=false;}
for(var filterGroupId in _activeFilters){_setShowShortList(filterGroupId,false);}
_deactivateFilters(_activeFilterList.slice());}
function _activateCategory(categoryId){_updateCategory(categoryId,true,true);}
function _deactivateCategory(categoryId){_updateCategory(categoryId,false,true);}
function _getActiveFilters(){return _activeFilters;}
function _getActiveCategoryIds(){var activeCategoryIds=[];for(var categoryId in _categories){if(_categories[categoryId].active){activeCategoryIds.push(categoryId);}}
return activeCategoryIds;}
function _getModelEvents(){return _events;}
function _getFilters(){return _filters;}
function _getActiveFilterList(){return _activeFilterList;}
function _getFilter(filterId,filterGroupId){var filters,filter;if(filterGroupId){if(_filters[filterGroupId]){return _filters[filterGroupId].filters[filterId];}else{return null;}}else{for(var filterGroupId in _filters){filters=_filters[filterGroupId].filters;filter=filters[filterId];if(filter){return filter;}}}
return null;}
function _getCategories(){return _categories;}
return{init:_init,activateFilter:_activateFilter,activateCategory:_activateCategory,getEvents:_getModelEvents,getFilters:_getFilters,getActiveFilters:_getActiveFilters,getActiveFilterList:_getActiveFilterList,getActiveCategoryIds:_getActiveCategoryIds,getCategories:_getCategories,deactivateAllFilters:_deactivateAllFilters,deactivateCategory:_deactivateCategory,deactivateFilter:_deactivateFilter,setCategories:_setCategories,setFilters:_setFilters,setShowShortList:_setShowShortList,updateCategories:_updateCategories,replaceFilters:_replaceFilters,dispatchFilterUpdate:_dispatchFilterUpdate};})(window.signals);
window.ngvn.filterboxAssets.FeedbackView=(function(nunjucks){var _model;var _modelEvents;function _init(model){_model=model;_modelEvents=_model.getEvents();_modelEvents.updatedFilters.add(_render);_modelEvents.updatedFromAPI.add(_render);$(document).on("click",".js-filterbox-reset-filter",_onRemoveFilter).on("click","#js-filterbox-reset-all",_onRemoveAllFilters);}
function _render(){var activeFacetSets,showResetFiltersButton,content,activeFilterList;activeFilterList=_model.getActiveFilterList();activeFacetSets=_model.getActiveCategoryIds();showResetFiltersButton=(activeFacetSets.length>0||activeFilterList.length>0);content=nunjucks.render("filterbox.selectedfilters.html",{activeFilterList:activeFilterList,showResetFiltersButton:showResetFiltersButton,labels:{removeSelectedFiltersControlCaption:bkt.i18n.lookup("remove-all-filters",{coll:"ngvn",controller:"results"})}});var target=document.getElementById('js-filterbox-resultscount');var observer=new MutationObserver(function(mutations){mutations.forEach(function(){_setFilterboxPadding();});_disconnectObserver();});var config={attributes:true,childList:true,characterData:true};observer.observe(target,config);function _disconnectObserver(){observer.disconnect();}
function _updateContentFeedback(){$("#js-filterbox-feedback").empty().html(content);}
function _setFilterboxPadding(){var mql=window.matchMedia("(max-width: 669px)");mql.addListener(_injectFilterboxPadding);var paddingFalse=function(){$("#js-filterbox-feedback").removeAttr("style");$("#js-filterbox-filtergroups").removeAttr("style");};var paddingTrue=function(){$("#js-filterbox-feedback").css("padding-top",$(".filterbox__plain-text--results-keywords").outerHeight());$("#js-filterbox-filtergroups").css("padding-top",$("#js-filterbox-feedback").outerHeight());};function _injectFilterboxPadding(){mql.matches?paddingFalse():paddingTrue();}
_injectFilterboxPadding();var _debounceInjectFilterboxPadding=debounce(function(){_injectFilterboxPadding();},250);$(window).on("resize",_debounceInjectFilterboxPadding);}
function _setFeedbackStickiness(){var _switchFeedbackStickiness=function(){var windowHeight=$(window).innerHeight();var feedbackHeight=$("#js-filterbox-feedback").outerHeight();var headerHeight=$("#top-bar").outerHeight();var denominatorValue=2;if(window.matchMedia("(min-height: 800px)").matches){denominatorValue=1.75;}else if(window.matchMedia("(min-height: 600px)").matches){denominatorValue=1.85;}
if((feedbackHeight+headerHeight)>=windowHeight/denominatorValue){$(".filterbox__feedback-wrapper").addClass("filterbox__feedback-wrapper--is-not-sticky");}else{$(".filterbox__feedback-wrapper").removeClass("filterbox__feedback-wrapper--is-not-sticky");}};_switchFeedbackStickiness();var _debounceSwitchFeedbackStickiness=debounce(function(){_switchFeedbackStickiness();},250);$(window).on("resize",_debounceSwitchFeedbackStickiness);}
function _addKeyboardEventHandlers(){$("#js-filterbox-feedback li a, #js-filterbox-reset-all").on("keydown",function(event){if(event.keyCode==13||event.keyCode==32){event.preventDefault();$(this).click();$("#top-bar a.accessibility-skip-link").first().focus();}});}
_updateContentFeedback();_addKeyboardEventHandlers();_setFilterboxPadding();_setFeedbackStickiness();}
function _onRemoveFilter(e){var $this=$(e.target),filterGroupId=$this.attr("data-gvn-filter-groupid"),filterId=$this.attr("data-gvn-filter-id");_model.deactivateFilter(filterId,filterGroupId);}
function _onRemoveAllFilters(e){_model.deactivateAllFilters();}
return{init:_init};})(window.nunjucks);
window.ngvn.filterboxAssets.FilterGroupsView=(function(nunjucks){var _model;var _modelEvents;var _modalFilterGroupId;var _$filterBoxContainer;var focusableCategory;var focusableFilter;var focusableElement;function _init(model,$filterBoxContainer){_modalFilterGroupId=null;focusableCategory=null;focusableFilter=null;focusableElement="> div:not([class])";_model=model;_modelEvents=_model.getEvents();_modelEvents.updatedFilters.add(_render);_modelEvents.updatedFromAPI.add(_render);_$filterBoxContainer=$filterBoxContainer;$(document).on("change",".js-filterbox-filter",_onFilterChange).on("change",".js-filterbox-category",_onCategoryChange).on("click",".js-filterbox-open-modal",_onOpenModal);}
function _render(){var filters=_model.getFilters();var activeFilters=_model.getActiveFilters();var numTotalFilters=0;for(var filterGroupId in filters){numTotalFilters+=filters[filterGroupId].numFilters;}
if(numTotalFilters===0){filters=null;activeFilters=null;}
var content=nunjucks.render("filterbox.filtergroups.html",{filters:filters,activeFilters:activeFilters,categories:_model.getCategories(),labels:{facetSetSectionTitle:bkt.i18n.lookup("filterbox-facetset-section-title",{coll:"ngvn",controller:"results"}),facetsSectionTitle:bkt.i18n.lookup("filterbox-facets-section-title",{coll:"ngvn",controller:"results"}),showAllFiltersControlCaption:bkt.i18n.lookup("show-more",{coll:"ngvn"})}});_$filterBoxContainer.empty().html(content);_addKeyboardEventHandlers("#js-filterbox-filtergroups");if(_modalFilterGroupId===null&&!$("#top-bar a.accessibility-skip-link").is(":focus"))
{if(focusableFilter!==null)
{var filter=$("input[id='"+focusableFilter+"']");if(filter.length===0||typeof _model.getActiveFilters()[focusableFilterGroup]==="undefined")
{$("#"+focusableFilterGroup).parent().find("div.filterbox__list__item__label-wrapper").first().focus();}
else
{filter.parent().find("div.filterbox__list__item__label-wrapper").first().focus();}}
else if(focusableCategory!==null)
{$("#"+focusableCategory).parent().find("div.filterbox__list__item__label-wrapper").first().focus();}}}
function _addKeyboardEventHandlers(labelsContainer){$(labelsContainer+" li "+focusableElement).attr("tabindex","0").addClass("filterbox__list__item__label-wrapper");$(labelsContainer+" li div.filterbox__list__item__label-wrapper").on("keydown",function(event){if(event.keyCode==13||event.keyCode==32){event.preventDefault();$(this).parents("li").first().children("input").first().click();}});}
function _renderModal(){var content=nunjucks.render("filterbox.modalcontent.html",{filterGroup:_model.getFilters()[_modalFilterGroupId],activeFilters:_model.getActiveFilters(),timestamp:Date.now()});var $container=$("#js-filterbox-modal");$container.empty().html(content);_addKeyboardEventHandlers("#js-filterbox-modal");if(focusableFilter===null)
{$("#js-filterbox-modal ul li div.filterbox__list__item__label-wrapper").first().focus();}
else
{$("input[id='"+focusableFilter+"']").parent().find("div.filterbox__list__item__label-wrapper").last().focus();}
$("#js-filterbox-overlay ul li > div").last().on("keydown",function(event){if(!event.shiftKey&&event.keyCode==9){event.preventDefault();$("#js-filterbox-modal div.sort-wrapper label.sort-selector__link-current").focus();}});$("#js-filterbox-modal div.sort-wrapper div.sort-selector").on("keydown",function(event){if(event.shiftKey&&event.keyCode==9){event.preventDefault();$("#js-filterbox-overlay ul li div.filterbox__list__item__label-wrapper").last().focus();}else if(event.keyCode==13){$(this).find("input.selected").first().prop('checked',true);_model.dispatchFilterUpdate();}});$("#js-filterbox-modal div.sort-wrapper p.sort-selector-description").text(bkt.i18n.lookup("sort-by",{"coll":"ngvn","controller":"results"}));$("#js-filterbox-modal div.sort-wrapper label.sort-selector__link-current").first().text(bkt.i18n.lookup("alphabet",{"coll":"ngvn","controller":"results"}));$("#js-filterbox-modal div.sort-wrapper ul.sort-selector__list li label").first().text(bkt.i18n.lookup("alphabet",{"coll":"ngvn","controller":"results"}));$("#js-filterbox-modal div.sort-wrapper ul.sort-selector__list li label").eq(1).text(bkt.i18n.lookup("numberOfResults",{"coll":"ngvn","controller":"results"}));if(bkt.parseParams()["sortby"]==="count")
{$("#js-filterbox-modal div.sort-wrapper label.sort-selector__link-current").first().text(bkt.i18n.lookup("numberOfResults",{"coll":"ngvn","controller":"results"}));}
$("#js-filterbox-modal div.sort-wrapper ul.sort-selector__list li label").on("click",function(){$(this).prev().prop('checked',true);_model.dispatchFilterUpdate();});var label=$("div.sort-wrapper label.sort-selector__link-current").first();}
function _activateCategory(categoryId){_model.activateCategory(categoryId);focusableFilter=null;focusableCategory=categoryId;}
function _deactivateCategory(categoryId){_model.deactivateCategory(categoryId);focusableFilter=null;focusableCategory=categoryId;}
function _activateFilter(filterId,filterGroupId){_model.activateFilter(filterId,filterGroupId);focusableCategory=null;focusableFilter=filterId;focusableFilterGroup=filterGroupId;}
function _deactivateFilter(filterId,filterGroupId){_model.deactivateFilter(filterId,filterGroupId);focusableCategory=null;focusableFilter=filterId;focusableFilterGroup=filterGroupId;}
function _onFilterChange(e){var $this=$(this),filterId=$this.attr("data-gvn-filter-id"),filterGroupId=$this.attr("data-gvn-filter-group-id");this.checked?_activateFilter(filterId,filterGroupId):_deactivateFilter(filterId,filterGroupId);}
function _onCategoryChange(e){var $this=$(this),categoryId=$this.attr("data-gvn-category-id");this.checked?_activateCategory(categoryId):_deactivateCategory(categoryId);}
function _onOpenModal(e){var kEvent="keydown";var $this=$(this);_modalFilterGroupId=$this.attr("data-gvn-filter-group-id");focusableFilter=null;$("#js-filterbox-overlay").show();_renderModal();_modelEvents.updatedFilters.add(_renderModal);_modelEvents.updatedFromAPI.add(_renderModal);$(document).on("click","#js-filterbox-close-modal",_onCloseModal);$(document).on(kEvent,function(e){if(e.keyCode===27){e.preventDefault();_onCloseModal(e);}});}
function _onCloseModal(e){var kEvent="keydown";$("#js-filterbox-overlay").hide();$("#js-filterbox-modal").empty();_modelEvents.updatedFilters.remove(_renderModal);_modelEvents.updatedFromAPI.remove(_renderModal);$('#'+_modalFilterGroupId).parent().find("ul li button").focus();_modalFilterGroupId=null;$(document).off("click","#js-filterbox-close-modal",_onCloseModal);$(document).off(kEvent,function(e){if(e.keyCode===27){e.preventDefault();_onCloseModal(e);}});}
function _onToggleFilterGroup(e){}
return{init:_init};})(window.nunjucks);
window.ngvn.filterbox=(function($,window,document,assets,bkt,undefined){var _model;var _feedbackView;var _locationBarView;var _filterGroupsView;var _isInitialLoad;var _jqxhr;var _$resultsCountAction;var _$sortlinksAction;var _$paginateAction;var _$resultsAction;var _$modalOverlay;var _apiURL;function _init($filterBoxContainer){_isInitialLoad=true;_apiURL="/"+bkt.getLanguage()+"/pres/results/multi?";_model=assets.Model;_feedbackView=assets.FeedbackView;_filterGroupsView=assets.FilterGroupsView;_model.init();_feedbackView.init(_model);_filterGroupsView.init(_model,$filterBoxContainer);_model.getEvents().updatedFilters.add(_onFilterUpdate);_$resultsCountAction=$(".bkt-mvc-resultsCountAction");_$sortlinksAction=$(".bkt-mvc-sortlinksAction");_$paginateAction=$(".bkt-mvc-paginateAction");_$resultsAction=$(".bkt-mvc-resultsAction");_$modalOverlay=$("#pending-overlay");_getDataFromApi(bkt.parseParams());}
function _getDataFromApi(params){var actionParams,apiParams,jsonActionParams;delete params.action;delete params.json_actions;actionParams={actions:['nothing']};if(!_isInitialLoad){actionParams.actions=['paginate','results','resultsCount','breadcrumbs','sortlinks'];}
jsonActionParams={json_actions:['facets']};apiParams=$.extend({},params,actionParams,jsonActionParams);_$modalOverlay.fadeIn("slow");if(_jqxhr){_jqxhr.abort();}
_jqxhr=$.ajax({url:_apiURL+$.param(apiParams),dataType:"json"}).done(function(data){var filterData=data.facets;if(!data.facets){console.log("NO DATA INPUT, NO FILTERBOX!");return;}else{}
if(_isInitialLoad){_model.setCategories(filterData.facetsets,params.facetset);_model.setFilters(filterData.groups,params.facets);_isInitialLoad=false;}else{_model.updateCategories(filterData.facetsets);_model.replaceFilters(filterData.groups);_$resultsCountAction.empty().html(data.resultsCountAction);_$sortlinksAction.empty().html(data.sortlinksAction);_$paginateAction.empty().html(data.paginateAction);_$resultsAction.empty().html(data.resultsAction);_$modalOverlay.fadeOut("slow");}
$("#language-links a[href]").attr("href",filterData.translatedRequest);}).fail(function(){console.log("Filterbox API call failed");_$modalOverlay.fadeOut("slow");});}
function _onFilterUpdate(){var params,facetParams,newUrl,activeFilters,activeCategoryIds;params=bkt.parseParams();params.page=1;delete params.facets;delete params.facetset;activeFilters=$.extend(true,{},_model.getActiveFilters());activeCategoryIds=_model.getActiveCategoryIds().slice(0);facetParams={};if(!$.isEmptyObject(activeFilters)){facetParams.facets=activeFilters;}
if(activeCategoryIds.length>0){facetParams.facetset=activeCategoryIds;}
params=$.extend({},params,facetParams);if($("#sortfields").length>0)
{var sortBy=$("#sortfields input:checked").val();if(sortBy==="alphabet")
{delete params.sortby;}
else if(sortBy==="count")
{params.sortby="count";}}
newUrl=window.location.pathname+"?"+$.param(params);window.history.pushState({},"",newUrl);_getDataFromApi(params);$(window).scrollTop(0);}
function _reset(){_model.deactivateAllFilters();}
return{init:_init,reset:_reset};})(jQuery,window,document,window.ngvn.filterboxAssets,window.bkt);$(document).ready(function(){var $filterBoxContainer=$("#js-filterbox-filtergroups");if($filterBoxContainer.length>0){window.ngvn.filterbox.init($filterBoxContainer);}});
/*!
 * 
 *             SimpleBar.js - v2.2.1
 *             Scrollbars, simpler.
 *             https://grsmto.github.io/simplebar/
 *             
 *             Made by Adrien Grsmto from a fork by Jonathan Nicol
 *             Under MIT License
 *         
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SimpleBar=e():t.SimpleBar=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(32),o=r(i),s=n(29),c=r(s),a=n(30),u=r(a),l=n(33),f=r(l),h=n(34),d=r(h),p=n(72),v=r(p),b=n(70),y=r(b),m=n(71),g=r(m);n(69);var _=function(){function t(e,n){(0,f.default)(this,t),this.el=e,this.track,this.scrollbar,this.flashTimeout,this.contentEl,this.scrollContentEl,this.dragOffset={x:0,y:0},this.isVisible={x:!0,y:!0},this.scrollOffsetAttr={x:"scrollLeft",y:"scrollTop"},this.sizeAttr={x:"offsetWidth",y:"offsetHeight"},this.scrollSizeAttr={x:"scrollWidth",y:"scrollHeight"},this.offsetAttr={x:"left",y:"top"},this.observer,this.currentAxis,this.enabled,this.scrollbarWidth=(0,v.default)(),this.options=(0,u.default)({},t.defaultOptions,n),this.classNames=this.options.classNames,this.flashScrollbar=this.flashScrollbar.bind(this),this.startScroll=this.startScroll.bind(this),this.startDrag=this.startDrag.bind(this),this.drag=this.drag.bind(this),this.endDrag=this.endDrag.bind(this),this.recalculate=(0,y.default)(this.recalculate,100,{leading:!0,trailing:!1}),this.init()}return(0,d.default)(t,[{key:"init",value:function(){return this.el.SimpleBar=this,this.enabled=0!==this.scrollbarWidth&&!this.options.forceEnabled,this.enabled?(this.initDOM(),this.trackX=this.el.querySelector("."+this.classNames.track+".horizontal"),this.trackY=this.el.querySelector("."+this.classNames.track+".vertical"),this.scrollbarX=this.trackX.querySelector("."+this.classNames.scrollbar),this.scrollbarY=this.trackY.querySelector("."+this.classNames.scrollbar),this.recalculate(),this.options.autoHide||(this.showScrollbar("x"),this.showScrollbar("y")),void this.initListeners()):void(this.el.style.overflow="auto")}},{key:"initDOM",value:function(){if(this.options.wrapContent){for(this.scrollContentEl=document.createElement("div"),this.contentEl=document.createElement("div"),this.scrollContentEl.classList.add(this.classNames.scrollContent),this.contentEl.classList.add(this.classNames.content),this.scrollContentEl.style.padding="0 "+this.scrollbarWidth+"px "+this.scrollbarWidth+"px 0",this.scrollContentEl.style.margin="0 -"+this.scrollbarWidth+"px -"+this.scrollbarWidth+"px 0",this.contentEl.style.marginBottom="-"+this.scrollbarWidth+"px";this.el.firstChild;)this.contentEl.appendChild(this.el.firstChild);this.scrollContentEl.appendChild(this.contentEl),this.el.appendChild(this.scrollContentEl)}var t=document.createElement("div"),e=document.createElement("div");t.classList.add(this.classNames.track),e.classList.add(this.classNames.scrollbar),t.appendChild(e),this.trackX=t.cloneNode(!0),this.trackX.classList.add("horizontal"),this.trackY=t.cloneNode(!0),this.trackY.classList.add("vertical"),this.el.insertBefore(this.trackX,this.el.firstChild),this.el.insertBefore(this.trackY,this.el.firstChild)}},{key:"initListeners",value:function(){var t=this;this.options.autoHide&&this.el.addEventListener("mouseenter",this.flashScrollbar),this.scrollbarX.addEventListener("mousedown",function(e){return t.startDrag(e,"x")}),this.scrollbarY.addEventListener("mousedown",function(e){return t.startDrag(e,"y")}),this.scrollContentEl.addEventListener("scroll",this.startScroll),"undefined"!=typeof MutationObserver&&(this.mutationObserver=new MutationObserver(function(e){e.forEach(function(e){(t.isChildNode(e.target)||e.addedNodes.length)&&t.recalculate()})}),this.mutationObserver.observe(this.el,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this.resizeObserver=new g.default(this.recalculate.bind(this)),this.resizeObserver.observe(this.el)}},{key:"removeListeners",value:function(){var t=this;this.enabled&&(this.options.autoHide&&this.el.removeEventListener("mouseenter",this.flashScrollbar),this.scrollbarX.removeEventListener("mousedown",function(e){return t.startDrag(e,"x")}),this.scrollbarY.removeEventListener("mousedown",function(e){return t.startDrag(e,"y")}),this.scrollContentEl.removeEventListener("scroll",this.startScroll),this.observer&&this.observer.disconnect())}},{key:"startDrag",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"y";t.preventDefault();var n="y"===e?this.scrollbarY:this.scrollbarX,r="y"===e?t.pageY:t.pageX;this.dragOffset[e]=r-n.getBoundingClientRect()[this.offsetAttr[e]],this.currentAxis=e,document.addEventListener("mousemove",this.drag),document.addEventListener("mouseup",this.endDrag)}},{key:"drag",value:function(t){t.preventDefault();var e="y"===this.currentAxis?t.pageY:t.pageX,n="y"===this.currentAxis?this.trackY:this.trackX,r=e-n.getBoundingClientRect()[this.offsetAttr[this.currentAxis]]-this.dragOffset[this.currentAxis],i=r/n[this.sizeAttr[this.currentAxis]],o=i*this.contentEl[this.scrollSizeAttr[this.currentAxis]];this.scrollContentEl[this.scrollOffsetAttr[this.currentAxis]]=o}},{key:"endDrag",value:function(){document.removeEventListener("mousemove",this.drag),document.removeEventListener("mouseup",this.endDrag)}},{key:"resizeScrollbar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y",e=void 0,n=void 0;"x"===t?(e=this.trackX,n=this.scrollbarX):(e=this.trackY,n=this.scrollbarY);var r=this.contentEl[this.scrollSizeAttr[t]],i=this.scrollContentEl[this.scrollOffsetAttr[t]],o=e[this.sizeAttr[t]],s=o/r,c=i/(r-o),a=Math.max(Math.floor(s*(o-2))-2,this.options.scrollbarMinSize),u=(o-4-a)*c+2;this.isVisible[t]=o<r,this.isVisible[t]?(e.style.visibility="visible","x"===t?(n.style.left=u+"px",n.style.width=a+"px"):(n.style.top=u+"px",n.style.height=a+"px")):e.style.visibility="hidden"}},{key:"startScroll",value:function(){this.flashScrollbar()}},{key:"flashScrollbar",value:function(){this.resizeScrollbar("x"),this.resizeScrollbar("y"),this.showScrollbar("x"),this.showScrollbar("y")}},{key:"showScrollbar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y";this.isVisible[t]&&("x"===t?this.scrollbarX.classList.add("visible"):this.scrollbarY.classList.add("visible"),this.options.autoHide&&("number"==typeof this.flashTimeout&&window.clearTimeout(this.flashTimeout),this.flashTimeout=window.setTimeout(this.hideScrollbar.bind(this),1e3)))}},{key:"hideScrollbar",value:function(){this.scrollbarX.classList.remove("visible"),this.scrollbarY.classList.remove("visible"),"number"==typeof this.flashTimeout&&window.clearTimeout(this.flashTimeout)}},{key:"recalculate",value:function(){this.enabled&&(this.resizeScrollbar("x"),this.resizeScrollbar("y"))}},{key:"getScrollElement",value:function(){return this.scrollContentEl}},{key:"getContentElement",value:function(){return this.contentEl}},{key:"unMount",value:function(){this.removeListeners(),this.el.SimpleBar=null}},{key:"isChildNode",value:function(t){return null!==t&&(t===this.el||this.isChildNode(t.parentNode))}}],[{key:"initHtmlApi",value:function(){if("undefined"!=typeof MutationObserver){var e=new MutationObserver(function(e){e.forEach(function(e){(0,c.default)(e.addedNodes).forEach(function(e){if(1===e.nodeType){if(e.SimpleBar)return;e.hasAttribute("data-simplebar")?new t(e,t.getElOptions(e)):(0,c.default)(e.querySelectorAll("[data-simplebar]")).forEach(function(e){new t(e,t.getElOptions(e))})}}),(0,c.default)(e.removedNodes).forEach(function(t){1===t.nodeType&&(t.hasAttribute("data-simplebar")?t.SimpleBar&&t.SimpleBar.unMount():(0,c.default)(t.querySelectorAll("[data-simplebar]")).forEach(function(t){t.SimpleBar&&t.SimpleBar.unMount()}))})})});e.observe(document,{childList:!0,subtree:!0})}"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(this.initDOMLoadedElements.bind(this)):(document.addEventListener("DOMContentLoaded",this.initDOMLoadedElements.bind(this)),window.addEventListener("load",this.initDOMLoadedElements.bind(this)))}},{key:"getElOptions",value:function(e){var n=(0,o.default)(t.htmlAttributes).reduce(function(n,r){var i=t.htmlAttributes[r];return e.hasAttribute(i)&&(n[r]=JSON.parse(e.getAttribute(i))),n},{});return n}},{key:"removeObserver",value:function(){this.observer&&this.observer.disconnect()}},{key:"initDOMLoadedElements",value:function(){document.removeEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.removeEventListener("load",this.initDOMLoadedElements),(0,c.default)(document.querySelectorAll("[data-simplebar]")).forEach(function(e){e.SimpleBar||new t(e,t.getElOptions(e))})}},{key:"defaultOptions",get:function(){return{wrapContent:!0,autoHide:!0,forceEnabled:!1,classNames:{content:"simplebar-content",scrollContent:"simplebar-scroll-content",scrollbar:"simplebar-scrollbar",track:"simplebar-track"},scrollbarMinSize:10}}},{key:"htmlAttributes",get:function(){return{autoHide:"data-simplebar-autohide",forceEnabled:"data-simplebar-force-enabled",scrollbarMinSize:"data-simplebar-scrollbar-min-size"}}}]),t}();e.default=_,_.initHtmlApi(),t.exports=e.default},function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(25)("wks"),i=n(28),o=n(5).Symbol,s="function"==typeof o,c=t.exports=function(t){return r[t]||(r[t]=s&&o[t]||(s?o:i)("Symbol."+t))};c.store=r},function(t,e,n){t.exports=!n(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(5),i=n(1),o=n(20),s=n(10),c="prototype",a=function(t,e,n){var u,l,f,h=t&a.F,d=t&a.G,p=t&a.S,v=t&a.P,b=t&a.B,y=t&a.W,m=d?i:i[e]||(i[e]={}),g=m[c],_=d?r:p?r[e]:(r[e]||{})[c];d&&(n=e);for(u in n)l=!h&&_&&void 0!==_[u],l&&u in m||(f=l?_[u]:n[u],m[u]=d&&"function"!=typeof _[u]?n[u]:b&&l?o(f,r):y&&_[u]==f?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e[c]=t[c],e}(f):v&&"function"==typeof f?o(Function.call,f):f,v&&((m.virtual||(m.virtual={}))[u]=f,t&a.R&&g&&!g[u]&&s(g,u,f)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var r=n(7),i=n(44),o=n(62),s=Object.defineProperty;e.f=n(3)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return s(t,e,n)}catch(c){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(13);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(6),i=n(16);t.exports=n(3)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(12);t.exports=function(t){return Object(r(t))}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports={}},function(t,e,n){var r=n(56),i=n(22);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var r=n(25)("keys"),i=n(28);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var r=n(39);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e,n){var r=n(13),i=n(5).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(19);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e,n){var r=n(6).f,i=n(9),o=n(2)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(5),i="__core-js_shared__",o=r[i]||(r[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,n){var r=n(23),i=n(12);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(18),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){t.exports={"default":n(35),__esModule:!0}},function(t,e,n){t.exports={"default":n(36),__esModule:!0}},function(t,e,n){t.exports={"default":n(37),__esModule:!0}},function(t,e,n){t.exports={"default":n(38),__esModule:!0}},function(t,e){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=n(31),o=r(i);e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()},function(t,e,n){n(68),n(64),t.exports=n(1).Array.from},function(t,e,n){n(65),t.exports=n(1).Object.assign},function(t,e,n){n(66);var r=n(1).Object;t.exports=function(t,e,n){return r.defineProperty(t,e,n)}},function(t,e,n){n(67),t.exports=n(1).Object.keys},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(26),i=n(27),o=n(61);t.exports=function(t){return function(e,n,s){var c,a=r(e),u=i(a.length),l=o(s,u);if(t&&n!=n){for(;u>l;)if(c=a[l++],c!=c)return!0}else for(;u>l;l++)if((t||l in a)&&a[l]===n)return t||l||0;return!t&&-1}}},function(t,e,n){var r=n(19),i=n(2)("toStringTag"),o="Arguments"==r(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=s(e=Object(t),i))?n:o?r(e):"Object"==(c=r(e))&&"function"==typeof e.callee?"Arguments":c}},function(t,e,n){"use strict";var r=n(6),i=n(16);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){t.exports=n(5).document&&document.documentElement},function(t,e,n){t.exports=!n(3)&&!n(8)(function(){return 7!=Object.defineProperty(n(21)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(14),i=n(2)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){var r=n(7);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(o){var s=t.return;throw void 0!==s&&r(s.call(t)),o}}},function(t,e,n){"use strict";var r=n(52),i=n(16),o=n(24),s={};n(10)(s,n(2)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(s,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){"use strict";var r=n(50),i=n(4),o=n(59),s=n(10),c=n(9),a=n(14),u=n(47),l=n(24),f=n(55),h=n(2)("iterator"),d=!([].keys&&"next"in[].keys()),p="@@iterator",v="keys",b="values",y=function(){return this};t.exports=function(t,e,n,m,g,_,x){u(n,e,m);var w,E,O,S=function(t){if(!d&&t in j)return j[t];switch(t){case v:return function(){return new n(this,t)};case b:return function(){return new n(this,t)}}return function(){return new n(this,t)}},A=e+" Iterator",M=g==b,k=!1,j=t.prototype,C=j[h]||j[p]||g&&j[g],L=C||S(g),T=g?M?S("entries"):L:void 0,D="Array"==e?j.entries||C:C;if(D&&(O=f(D.call(new t)),O!==Object.prototype&&(l(O,A,!0),r||c(O,h)||s(O,h,y))),M&&C&&C.name!==b&&(k=!0,L=function(){return C.call(this)}),r&&!x||!d&&!k&&j[h]||s(j,h,L),a[e]=L,a[A]=y,g)if(w={values:M?L:S(b),keys:_?L:S(v),entries:T},x)for(E in w)E in j||o(j,E,w[E]);else i(i.P+i.F*(d||k),e,w);return w}},function(t,e,n){var r=n(2)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(s){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},t(o)}catch(c){}return n}},function(t,e){t.exports=!0},function(t,e,n){"use strict";var r=n(15),i=n(54),o=n(57),s=n(11),c=n(23),a=Object.assign;t.exports=!a||n(8)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=a({},t)[n]||Object.keys(a({},e)).join("")!=r})?function(t,e){for(var n=s(t),a=arguments.length,u=1,l=i.f,f=o.f;a>u;)for(var h,d=c(arguments[u++]),p=l?r(d).concat(l(d)):r(d),v=p.length,b=0;v>b;)f.call(d,h=p[b++])&&(n[h]=d[h]);return n}:a},function(t,e,n){var r=n(7),i=n(53),o=n(22),s=n(17)("IE_PROTO"),c=function(){},a="prototype",u=function(){var t,e=n(21)("iframe"),r=o.length,i="<",s=">";for(e.style.display="none",n(43).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+s+"document.F=Object"+i+"/script"+s),t.close(),u=t.F;r--;)delete u[a][o[r]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(c[a]=r(t),n=new c,c[a]=null,n[s]=t):n=u(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(6),i=n(7),o=n(15);t.exports=n(3)?Object.defineProperties:function(t,e){i(t);for(var n,s=o(e),c=s.length,a=0;c>a;)r.f(t,n=s[a++],e[n]);return t}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(9),i=n(11),o=n(17)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){var r=n(9),i=n(26),o=n(40)(!1),s=n(17)("IE_PROTO");t.exports=function(t,e){var n,c=i(t),a=0,u=[];for(n in c)n!=s&&r(c,n)&&u.push(n);for(;e.length>a;)r(c,n=e[a++])&&(~o(u,n)||u.push(n));return u}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var r=n(4),i=n(1),o=n(8);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],s={};s[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",s)}},function(t,e,n){t.exports=n(10)},function(t,e,n){var r=n(18),i=n(12);t.exports=function(t){return function(e,n){var o,s,c=String(i(e)),a=r(n),u=c.length;return a<0||a>=u?t?"":void 0:(o=c.charCodeAt(a),o<55296||o>56319||a+1===u||(s=c.charCodeAt(a+1))<56320||s>57343?t?c.charAt(a):o:t?c.slice(a,a+2):(o-55296<<10)+(s-56320)+65536)}}},function(t,e,n){var r=n(18),i=Math.max,o=Math.min;t.exports=function(t,e){return t=r(t),t<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(13);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var r=n(41),i=n(2)("iterator"),o=n(14);t.exports=n(1).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){"use strict";var r=n(20),i=n(4),o=n(11),s=n(46),c=n(45),a=n(27),u=n(42),l=n(63);i(i.S+i.F*!n(49)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,f,h=o(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,b=void 0!==v,y=0,m=l(h);if(b&&(v=r(v,p>2?arguments[2]:void 0,2)),void 0==m||d==Array&&c(m))for(e=a(h.length),n=new d(e);e>y;y++)u(n,y,b?v(h[y],y):h[y]);else for(f=m.call(h),n=new d;!(i=f.next()).done;y++)u(n,y,b?s(f,v,[i.value,y],!0):i.value);return n.length=y,n}})},function(t,e,n){var r=n(4);r(r.S+r.F,"Object",{assign:n(51)})},function(t,e,n){var r=n(4);r(r.S+r.F*!n(3),"Object",{defineProperty:n(6).f})},function(t,e,n){var r=n(11),i=n(15);n(58)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){"use strict";var r=n(60)(!0);n(48)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e){},function(t,e){(function(e){function n(t,e,n){function i(e){var n=v,r=b;return v=b=void 0,O=e,m=t.apply(r,n)}function o(t){return O=t,g=setTimeout(l,e),S?i(t):m}function a(t){var n=t-E,r=t-O,i=e-n;return A?x(i,y-r):i}function u(t){var n=t-E,r=t-O;return void 0===E||n>=e||n<0||A&&r>=y}function l(){var t=w();return u(t)?f(t):void(g=setTimeout(l,a(t)))}function f(t){return g=void 0,M&&v?i(t):(v=b=void 0,m)}function h(){void 0!==g&&clearTimeout(g),O=0,v=E=b=g=void 0}function d(){return void 0===g?m:f(w())}function p(){var t=w(),n=u(t);if(v=arguments,b=this,E=t,n){if(void 0===g)return o(E);if(A)return g=setTimeout(l,e),i(E)}return void 0===g&&(g=setTimeout(l,e)),m}var v,b,y,m,g,E,O=0,S=!1,A=!1,M=!0;if("function"!=typeof t)throw new TypeError(c);return e=s(e)||0,r(n)&&(S=!!n.leading,A="maxWait"in n,y=A?_(s(n.maxWait)||0,e):y,M="trailing"in n?!!n.trailing:M),p.cancel=h,p.flush=d,p}function r(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function i(t){return!!t&&"object"==typeof t}function o(t){return"symbol"==typeof t||i(t)&&g.call(t)==u}function s(t){if("number"==typeof t)return t;if(o(t))return a;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(l,"");var n=h.test(t);return n||d.test(t)?p(t.slice(2),n?2:8):f.test(t)?a:+t}var c="Expected a function",a=NaN,u="[object Symbol]",l=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,d=/^0o[0-7]+$/i,p=parseInt,v="object"==typeof e&&e&&e.Object===Object&&e,b="object"==typeof self&&self&&self.Object===Object&&self,y=v||b||Function("return this")(),m=Object.prototype,g=m.toString,_=Math.max,x=Math.min,w=function(){return y.Date.now()};t.exports=n}).call(e,function(){return this}())},function(t,e,n){(function(e){!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return parseFloat(t)||0}function n(e){var n=Array.prototype.slice.call(arguments,1);return n.reduce(function(n,r){var i=e["border-"+r+"-width"];return n+t(i)},0)}function r(e){for(var n=["top","right","bottom","left"],r={},i=0,o=n;i<o.length;i+=1){var s=o[i],c=e["padding-"+s];r[s]=t(c)}return r}function i(t){var e=t.getBBox();return u(0,0,e.width,e.height)}function o(e){var i=e.clientWidth,o=e.clientHeight;if(!i&&!o)return w;var c=getComputedStyle(e),a=r(c),l=a.left+a.right,f=a.top+a.bottom,h=t(c.width),d=t(c.height);if("border-box"===c.boxSizing&&(Math.round(h+l)!==i&&(h-=n(c,"left","right")+l),Math.round(d+f)!==o&&(d-=n(c,"top","bottom")+f)),!s(e)){var p=Math.round(h+l)-i,v=Math.round(d+f)-o;1!==Math.abs(p)&&(h-=p),1!==Math.abs(v)&&(d-=v)}return u(a.left,a.top,h,d)}function s(t){return t===document.documentElement}function c(t){return h?E(t)?i(t):o(t):w}function a(t){var e=t.x,n=t.y,r=t.width,i=t.height,o="function"==typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return x(s,{x:e,y:n,width:r,height:i,top:n,right:e+r,bottom:i+n,left:e}),s}function u(t,e,n,r){return{x:t,y:e,width:n,height:r}}var l=function(){return"undefined"!=typeof e&&e.Math===Math?e:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")()}(),f=function(){function t(t,e){var n=-1;return t.some(function(t,r){return t[0]===e&&(n=r,!0)}),n}return"function"==typeof l.Map?l.Map:function(){function e(){this.__entries__=[]}var n={size:{}};return n.size.get=function(){return this.__entries__.length},e.prototype.get=function(e){var n=t(this.__entries__,e),r=this.__entries__[n];return r&&r[1]},e.prototype.set=function(e,n){var r=t(this.__entries__,e);~r?this.__entries__[r][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,r=t(n,e);~r&&n.splice(r,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){var n=this;void 0===e&&(e=null);for(var r=0,i=n.__entries__;r<i.length;r+=1){var o=i[r];t.call(e,o[1],o[0])}},Object.defineProperties(e.prototype,n),e}()}(),h=l.window===l&&"undefined"!=typeof document,d=function(){return"function"==typeof requestAnimationFrame?requestAnimationFrame:function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),p=2,v=function(){var t=Date;return"object"==typeof performance&&"function"==typeof performance.now&&(t=performance),function(){return t.now()}}(),b=function(t,e,n){function r(){s=!1,t(),c&&o()}function i(){n?d(r):r()}function o(){var t=v();if(s){if(t-a<p)return;c=!0}else s=!0,c=!1,setTimeout(i,e);a=t}void 0===n&&(n=!1);var s=!1,c=!1,a=0;return o},y=20,m=80,g="function"==typeof MutationObserver&&"object"==typeof navigator&&!("Netscape"===navigator.appName&&navigator.userAgent.match(/Trident\/.*rv:11/)),_=function(){this.isCycleContinuous_=!g,this.listenersEnabled_=!1,this.mutationsObserver_=null,this.observers_=[],this.refresh=b(this.refresh.bind(this),y,!0),this.continuousUpdateHandler_=b(this.refresh,m)};_.prototype.connect=function(t){this.isConnected(t)||this.observers_.push(t),this.listenersEnabled_||this.addListeners_()},_.prototype.disconnect=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.listenersEnabled_&&this.removeListeners_()},_.prototype.isConnected=function(t){return!!~this.observers_.indexOf(t)},_.prototype.refresh=function(){var t=this.updateObservers_();t?this.refresh():this.isCycleContinuous_&&this.listenersEnabled_&&this.continuousUpdateHandler_()},_.prototype.updateObservers_=function(){var t=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return t.forEach(function(t){return t.broadcastActive()}),t.length>0},_.prototype.addListeners_=function(){h&&!this.listenersEnabled_&&(window.addEventListener("resize",this.refresh),document.addEventListener("transitionend",this.refresh),g&&(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this.listenersEnabled_=!0,this.isCycleContinuous_&&this.refresh())},_.prototype.removeListeners_=function(){h&&this.listenersEnabled_&&(window.removeEventListener("resize",this.refresh),document.removeEventListener("transitionend",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationsObserver_=null,this.listenersEnabled_=!1)};var x=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n+=1){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerbale:!1,writable:!1,configurable:!0})}return t},w=u(0,0,0,0),E=function(){return"function"==typeof SVGGraphicsElement?function(t){return t instanceof SVGGraphicsElement}:function(t){return t instanceof SVGElement&&"function"==typeof t.getBBox}}(),O=function(t){this.target=t,this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=u(0,0,0,0)};O.prototype.isActive=function(){var t=c(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},O.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t};var S=function(t,e){var n=a(e);x(this,{target:t,contentRect:n})},A=function(t,e,n){if("function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.activeTargets_=[],this.observationTargets_=new f,this.callback_=t,this.controller_=e,this.callbackCtx_=n};A.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("Element"in l&&Element instanceof Object){if(!(t instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observationTargets_;e.has(t)||(e.set(t,new O(t)),this.controller_.isConnected(this)||this.controller_.connect(this),this.controller_.refresh())}},A.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("Element"in l&&Element instanceof Object){if(!(t instanceof Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observationTargets_;e.has(t)&&(e.delete(t),e.size||this.controller_.disconnect(this))}},A.prototype.disconnect=function(){this.clearActive(),this.observationTargets_.clear(),this.controller_.disconnect(this)},A.prototype.gatherActive=function(){this.clearActive();var t=this.activeTargets_;this.observationTargets_.forEach(function(e){e.isActive()&&t.push(e)})},A.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeTargets_.map(function(t){return new S(t.target,t.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},A.prototype.clearActive=function(){this.activeTargets_.splice(0)},A.prototype.hasActive=function(){return this.activeTargets_.length>0};var M=new _,k="function"==typeof WeakMap?new WeakMap:new f,j=function(t){if(!(this instanceof j))throw new TypeError("Cannot call a class as a function");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var e=new A(t,M,this);k.set(this,e)};["observe","unobserve","disconnect"].forEach(function(t){j.prototype[t]=function(){var e;return(e=k.get(this))[t].apply(e,arguments)}});var C=function(){return"function"==typeof l.ResizeObserver?l.ResizeObserver:j}();return C})}).call(e,function(){return this}())},function(t,e,n){var r,i,o
/*! scrollbarWidth.js v0.1.0 | felixexter | MIT | https://github.com/felixexter/scrollbarWidth */
;!function(n,s){i=[],r=s,o="function"==typeof r?r.apply(e,i):r,!(void 0!==o&&(t.exports=o))}(this,function(){"use strict";function t(){var t,e=document.body,n=document.createElement("div"),r=n.style;return r.position="absolute",r.top=r.left="-9999px",r.width=r.height="100px",r.overflow="scroll",e.appendChild(n),t=n.offsetWidth-n.clientWidth,e.removeChild(n),t}return t})}])});